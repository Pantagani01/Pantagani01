/////////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright 2017 Finicity Corp. All rights reserved. 
//Unauthorized reproduction is a violation of applicable law
// INSTITUTION_ID = MANY
// INSTITUTION_NAME = MANY
// LOGIN_URL = MANY
// DEPENDENT_SCRIPT_NAME =  firstambank.scr
// ACCOUNT_TYPE_SUPPORTED = All Account Types Supported
/////////////////////////////////////////////////////////////////////////////////////////////////////////
//Modified: 06/03/2021 -  Sarfraj Ahmad - Removed old store and modified store macro for CCID:25651764 FIID:72 Case ID:DSS-70542
//Modified: 06/03/2021 - N Siricilla - Made changes in Single Session ACH layout. Case ID AP-4271, AP-4270.
//Modified: 06/03/2021 - L Powale - Added accounttype check in the aggregation section for FIID 3185 AP-4216 ,Verified by M Firoz.
//Modified: 06/03/2021 - R Pawar - Fixed Missing transaction Issue for FIID-7095 DSS-72797.
//Modified: 06/04/2021 - V Patil - Made changes to fix Error 130 for FIID: 11142 CaseID:DSS-72916 Verified by Abhay Jadhav
//Modified: 06/06/2021 - Rajesh CH - Made changes in Aggregation section for FI 5341 CC 1013102877 DSS-73038.
//Modified: 06/09/2021 - S Saxena - Made changes in statement section for FI 7112 PFREC-3557.
//Modified: 06/09/2021 - N shinde - Made changes to skip Error 108 for FI 15196.AP-4583
//Modified: 06/09/2021 - N shinde - Made changes for Available and current balance for FI 1066.AP-4588
//Modified: 06/10/2021 - L Powale - Added layout for current balance for FIID 3185, AP-4216 .Verified by M Firoz.
//Modified: 06/11/2021 - Saikrishna M - Added Script to scrap ACH details for FIID 5336, AP-4070.
//Modified: 06/12/2021 - A Chormule - Fixed parsing problem in aggregation section DSS-70542.
//Modified: 06/14/2021 - L Powale - Made changes for ACH in Aggregation and Single session for FI:7575,AP-4218 .Verified by M Firoz.
//Modified: 06/21/2021 - S Khan - Made changes in Login, Discovery and Aggregation section & Added statement layout for FI 10771 (DSS-73744).
//Modified: 06/23/2021 - S Ippakayala - Generated Error 102 for FI:7575 PFREC-3721
//Modified: 06/23/2021 - S Ippakayala - Made Changes in PDF Section for FI:14872 PFREC-3734
//Modified: 06/23/2021 - T Thakur -Generated Error 961 for FI:7726 
//Modified: 06/23/2021 - R Pawar - Made changes to fix missing txn issue FI 4987 DSS-74623
//Modified: 06/27/2021 - Rajesh CH - Made changes to fix missing transactions & Error417 for FI 7882 CC 13336723 DSS-74739.
//Modified: 06/27/2021 - Rajesh CH - Made changes to set acctype issue for FI 1066 CC 5000609089 DSS-74631.
//Modified: 06/27/2021 - S Babar - Made changes to fix missing txn issue FI 1066,4781 DSS-74519
//Modified: 06/30/2021 - S Khan - Made changes in aggregation section for FI 5341 (DSS-73756)
//Modified: 07/01/2021 - Swapnil KAdam - Made changes in aggregation section to fix 417 DSS-75023 DSS-74961 Also fixed statement issue as well.
//Modified: 07/01/2021 - S Monde - Made changes in ACH section to fix Routing number (AP-5170)
//Modified: 07/02/2021 - S Ippakayala - Made Changes in PDF Section for FI:15196 PFREC-3789
//Modified: 07/10/2021 - R Chenna - Made changes in statement Section for FI 7664 CC 5006578093 DSS-75651.
//Modified: 07/15/2021 - V Patil - Made changes in aggregation Section to fix missing transactions for FIID:100919 CaseID:DSS-75982 Verified by S Sawant
//Modified: 07/15/2021 - V Patil - Added statement layout for FIID:100919 CaseID:DSS-75982 Verified by Sufiyan Khan
//Modified: 07/17/2021 - S Sharma - Generated 961 in the statement section for FI ID: 7398 Case: DSS-75185
//Modified: 07/23/2021 - S Monde - Made changes in ACH section to fix ACH number for FI 13631 (AP-5371)
//Modified: 07/24/2021 - S Sharma  - Made changes to fix 417 for FI ID: 4741 Case DSS-76661
//Modified: 07/28/2021 - A Chavan  - Made changes to fix 914 for FI ID: 5420 Case: DSS-76887.
//Modified: 08/02/2021 - S Ippakayala - Generated 961 in the statement section for FI:11818 PFREC-3953
//Modified: 08/02/2021 - S Ippakayala - Made changes in statement Section for FI:5420 PFREC-3951
//Modified: 08/03/2021 - A Chavan  - Made changes to fix account type for FI ID: 5420 Case: DSS-76887.
//Modified: 08/06/2021 - S Sharma  - Made changes to fix Add account Issue for FI ID: 3185 Case: DSS-75834
//Modified: 08/06/2021 - S Sharma  - Made changes to fix Add account and 960 in statement Issue for FI ID: 3185 Case: DSS-75834
//Modified: 08/09/2021 - S Ippakayala - Generated 961 in the statement section for FI:100919 PFREC-4027
//Modified: 08/10/2021 - M Medhekar  - Generated error 103 to fix 908 for FI ID: 7175 Case: DSS-77697
//Modified: 08/10/2021 - V Patil - Made changes to fix Error 909 and incorrect account type for FIID: 5420 CaseID: DSS-77596 Verified by Swapnil Kadam
//Modified: 08/10/2021 - V Patil - Made changes to fix Error 145 in ACH section for FIID: 5420 CaseID: DSS-77596 Verified by Ibrahim Mir
//Modified: 08/11/2021 - S Ippakayala - Made changes to fix Error 116 in the statement section for FI:72 PFREC-3989
//Modified: 08/11/2021 - R Baddapuri - Made minor changes in Discovery section for FI ID: 7664 Case: DSS-77878
//Modified: 08/12/2021 - S Pawar - Made changes for Account Type Logic for -1 Account type IERR-2865 V By Ibrahim Mir.
//Modified: 08/12/2021 - S Sharma - Made changes to resolve incorrect account balance issue for FI ID: 5420 Case Id: DSS-77785
//Modified: 08/13/2021 - Saikrishna M - Modified ACH and Aggregation layout to scrap ACH details for FIID-11142 Case ID : AP-5935
//Modified: 08/13/2021 - S Pawar - Made changes for Account Type Logic for -1 Account type IERR-2865.
//Modified: 08/14/2021 - R Chenna - Made changes to fix Error908 for FIID:4231 DSS-78121.
//Modified: 08/17/2021 - S Ippakayala - Made changes to fix Error 116 in the statement section for FI:72 PFREC-3989
//Modified: 08/20/2021 - S Monde - Minor changes in ACH Single section for FI:5067 (AP-6579)
//Modified: 08/21/2021 - R Chenna - Applied IP Distribution to fix Error908 for FIID:5341 DSS-78477.
//Modified: 08/25/2021 - Amey Kadam - Applied store macro to capture pages for CC 5012161747 FIID 72 DSS-78679
//Modified: 08/25/2021 - Vinod Patil - Made changes to set correct account type for CCID: 81048 FIID: 7398 CaseID: DSS-78674 Verified by Swapnil Kadam
//Modified: 08/25/2021 - A Chavan - Made changes in MFA section for FI:2735 Case:DSS-78812.
//Modified: 08/26/2021 - S Babar - Made changes in MFA section to resolve Error 156 for FI:7398 Case:DSS-78274.
//Modified: 08/28/2021 - Dilip Kumar - Made changes to stop only Batch aggregation request for FIID 5341 (it's an ask of FI)   
//Modified: 08/28/2021 - S Ippakayala - Generated 914 Discovery section for FI:11142 PFREC-4100
//Modified: 08/28/2021 - Raees Mulla - Made changes in discovery section to fix error 908 for FI 1066 DSS-78827
//Modified: 08/30/2021 - Dilip Kumar - Removed the changes to stop Batch aggregation request for FIID 5341 as we have disable batch through Database
//Modified: 09/01/2021 - A Chavan - Made changes in Discovery section to handle Error 914 for FI:7175 Case:DSS-79202.
//Modified: 09/01/2021 - V Shelke - Made changes in login section to resolve error 103 for FI ID 12489 DSS-78522
//Modified: 09/02/2021 - M Medhekar - Made changes in login section, Add new discovery layout, Aggregation layout and Added Roll date logic to resolve error 908 for FI ID 5899 DSS-78901
//Modified: 09/02/2021 - M Medhekar - Made changes in Statement section to fixed statement download issue for FI ID 5899 DSS-78901
//Modified: 09/06/2021 - V Patil - Made changes in each section and added statement layout to fix Error 908 for FIID: 4399 CaseID: DSS-79430 Verified by Akash Shinde
//Modified: 09/06/2021 - V Patil - Generated Error 103 for FIID: 4399 CaseID: DSS-79430 Verified by Akash Shinde
//Modified: 09/06/2021 - V Patil - Made changes in OTP section for FIID: 14872 CaseID: DSS-79250 Verified by Akash Shinde
//Modified: 09/09/2021 - S Monde - Minor changes in ACH Single section for FI:100368 (AP-4205)
//Modified: 09/09/2021 - S Sharma - Made changes in MFA section to fix error 156 and applied store for CCID: 5013281673 FI ID: 7882 Case: DSS-79614
//Modified: 09/09/2021 - S Sharma - Fixed error 960 for FI ID: 7882 Case: DSS-79614
//Modified: 09/09/2021 - P Mhatre - Made Change in MFA Section  applied store for CCID:-5013368039 and set proper account type FI:-5420 Case:-DSS-79750.
//Modified: 09/10/2021 - S Monde - Made changes in ACH section to fix ACH number for FI 4399 (AP-6593)
//Modified: 09/10/2021 - S Ahmad - Removed old store & Applied store for CCID:-5013430252 FI:-4799 Case:-DSS-79878.
//Modified: 09/10/2021 - Raees Mulla - Made changes to fix missing transactions issue for FI 4399 DSS-79320
//Modified: 09/14/2021 - R Tripathi - Made changes in discovery section for FI 4399 DSS-79984
//Modified: 09/15/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3289
//Modified: 09/16/2021 - Amey Kadam - Made changes in discovery section to fix error 129 for FI 12590 Case DSS-80239
//Modified: 09/16/2021 - S Sharma   - Made changes in aggregation section to fix transactions Issue for FI 12489 Case DSS-78522
//Modified: 09/16/2021 - S Sharma   - Made changes in statement section to statement Issue for FI 12489 Case DSS-78522
//Modified: 09/18/2021 - Saikrishna M - Added InstitutionID check for Rolldate logic FIID-7414 Story : AP-6606
//Modified: 09/18/2021 - R Chenna - Made changes in Discovery for account type setting FI 4399 DSS-80442.
//Modified: 09/20/2021 - S Babar - Made changes in discovery section to fix error 129 for FI 11142 Case DSS-80503
//Modified: 09/21/2021 - A Chavan - Made changes in discovery section to fix error 129 for FI 4566 Case DSS-80552.
//Modified: 09/21/2021 - Raees Mulla - Made dynamic changes in discovery to fix error 129 and incorrect account scrapping issue for FI 3185 DSS-80537
//Modified: 09/22/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3441
//Modified: 09/23/2021 - Y Jadhav - Made changes in Discovery to set account type FIID:4399 Case:DSS-80684
//Modified: 09/24/2021 - A Chavan - Made dynamic changes in discovery section to fix error 129 for FI 7112 Case DSS-80872.
//Modified: 09/24/2021 - S Babar - Made changes in discovery section to fix error 129 for FI 7419 Case DSS-80834
//Modified: 09/25/2021 - Raees Mulla - Made changes in discovery section to fix error 908 for FI 10771 DSS-80864
//Modified: 09/27/2021 - P Singh - Added logger for capturing business account FI 4566 OBB-541
//Modified: 09/28/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3282
//Modified: 10/05/2021 - R Chenna - Generated Error103 & Error927 IP Blockage FI 5341 DSS-81545.
//Modified: 10/05/2021 - V Patil - Made changes in discovery section to fix Error 324 for FIID: 4399 CaseID: DSS-81628 Verified by Sachin Chavan
//Modified: 10/07/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3457
//Modified: 10/11/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3457
//Modified: 10/12/2021 - P Mhatre - Added Support made change in Login, Discovery section and added New Statement section for FI:-7495 Case:-DSS-82029.
//Modified: 10/12/2021 - S Salaskar - Modified Discovery layout JiraID-IERR-3457
//Modified: 10/14/2021 - R Tripathi - Made changes in MFA section and applied store macro for CCID: 14323076 FIID: 15146 Case: DSS-82183
//Modified: 10/16/2021 - R Tripathi - Modified MFA section and store macro for CCID: 14323076 FIID: 15146 Case: DSS-82183
//Modified: 10/19/2021 - R Chenna - Made in Aggregation section to fix transactions Issue for FI 12590 DSS-82467.
//Modified: 10/20/2021 - Yogesh Aiyer - Made changes for error code 908 and stored macros for FI 5343 Case DSS-82896 CC ID 1003215176
//Modified: 10/22/2021 - Yogesh Aiyer - Added stored macros for FI ID: 5343 Case DSS-82688 CC ID 1016238707 and 16931222.
//Modified: 10/22/2021 - Amey Kadam - Made changes in ACH layout for FI 7112 Case DSS-82304
//Modified: 10/22/2021 - I Mir    - Made changes in login section to fix error 156 IERR-3879.
//Modified: 10/22/2021 - R Pawar - Fixed Missing account issue for FIID-5420 DSS-82573
//Modified: 10/22/2021 - R Chenna - Made changes to fix 908 for FI 7175 Case ID: DSS-82916 DSS-83124.
//Modified: 10/24/2021 - S Sharma - Applied store for CCID: 184765 FI ID: 5343 Case Id: DSS-83163
//Modified: 10/25/2021 - I Mir    - Made changes in login, discovery and aggregation section to fix error 417 and 908 IERR-3879.
//Modified: 10/25/2021 - Yogesh Aiyer - Removed stored macros for FI ID: 5343 Case DSS-82688 CC ID 1016238707 and 16931222.
//Modified: 10/26/2021 - I Mir    - Made changes in login section to fix error 908 IERR-3879.
//Modified: 10/26/2021 - I Mir    - Made changes in login section to fix error 908 IERR-3879.
//Modified: 10/29/2021 - I Mir    - Made changes in login section to fix error 908 for FI 4399.
//Modified: 11/02/2021 - I Mir    - Made changes in login section to fix error 908 for FI 7664
//Modified: 11/09/2021 - V Patil  - Made changes to fix Error 185 for FIID: 2617 CaseID: DSS-84042 Verified by Akshaykumar Chormule
//Modified: 11/11/2021 - S Monde  - Added Routing number in local table (AP-6691)
//Modified: 11/12/2021 - A Chavan - Made changes to fix Error 106 for FI: 7419 Case: DSS-84528.
//Modified: 11/15/2021 - K Bakshi - Made changes to fix Error 404 for FI: 2735 Story ID: PFREC-4633.
//Modified: 11/16/2021 - R Chenna - Made changes in Discovery section for FI 9751 Case ID: DSS-84950.
//Modified: 11/17/2021 - V Patil - Made changes in Discovery section to fix Error 324 for FIID: 7095 Case ID: DSS-84987. Verified by Akshaykumar Chormule
//Modified: 11/19/2021 - Raees Mulla - Made changes in Discovery section to fix add account issue for FIID: 100394 DSS-85157
///////////////////////////////////////////////////////////////////////////////////////////////////////// 
CallThis,MinimumVersion,500,
,MaximumLoop,10000,
,ControlData,0,
,EnableShadowTransactions,"T",
 
,Assign,looping1|0,
,Assign,userName|"",
,Assign,BusinessSTmtF|"FALSE",
,Assign,PersonalSTmtF|"FALSE",
,Assign,MaskedAccNumber|"",
,Assign,aNumReal|"",
,Assign,MaskNumber_discovery|"F",
,AssignLocalTable,bank_ID|5341|255075576,


//Start @ Offshore
//********************************
//********************************
//End @ Offshore

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",   // FI ID: 4799
,If-TRUE-Goto,SkipblwProxy,

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",   // FI ID: 7175
,If-TRUE-Goto,SkipblwProxy,

,SetProxyAgg2,"ccliteproxy-nlb.prod.fini.city"|"8224",

SkipblwProxy,Assign,symbolInstitutionId|##TP_INSTITUTION_ID##|test,
,Assign,institutionId|"",
,AppendVars,institutionId|symbolInstitutionId,

,Assign,symbolCustomerId|##TP_CUSTOMER_ID##|test,
,Assign,customerId|"",
,AppendVars,customerId|symbolCustomerId,

,Assign,pid|##TP_PARTNER_ID##|test,
,Assign,partnerId|"",
,AppendVars,partnerId|pid,

,Assign,tempdate|"",
,Assign,script_Name|"firstambank.scr",

,Assign,instUserId|"",


,RollDate,##NOW##|tempdate|MONTH|-12|test,

,CompareDates,##STARTDATE##|tempdate|>,
,If-TRUE-Goto,SkipRollDate,

,Assign,##STARTDATE##|tempdate,

SkipRollDate,Assign,QFX_Account_Type_ID|"",

,Assign,temp_date|"",
,Assign,yearCounter|0,

,Assign,RoutingN|"",
,Assign,AccTypeID|"", 
,Assign,line|##LN##,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,
,Assign,account|0,
,Assign,tempAcctIndex|0,
,Assign,CountAccLayout|0,
,Assign,HISINDEX|0,
,Assign,achAccountNumber|"",
,Assign,fullNumFLAG|"FALSE",
,Assign,AccURL|"",
,Assign,availablebal|0,
,Assign,fullAccountNumber|"", 
,Assign,accRealNumber|"", 
,Assign,PDF_FLAG|"FALSE",
,Assign,Temp_Flag|"FALSE",
,Assign,ACHIndex|0,
,Assign,accountID|"",
,Assign,accountIDFlag|"FALSE",
,Assign,sURL1Flag|"FALSE",
,Assign,aBal|"",
,Assign,SingleSessionEnabledFlag|"FALSE",
,Assign,RoutingNumber|"",
,Assign,PageHit1stTime|"True",

,Assign,tlsv1_2|"TLSv1.2",
,SetSSLProtocols,tlsv1_2,

,Assign,loginURL|##TOWER_WEBSITE##|test,
,If-TRUE-Goto,SkipAssign,

,Assign,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,Assign,loginURL|##TOWER_WEBSITE##,

SkipAssign,NOP,

//===========================================================
//     Error 940 FIs/Developed on Puppetmaster
//===========================================================

,Compare,##TOWER_WEBSITE##|"https://online.kpcu.com/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://online.centerstatebank.com/OnlineBanking/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://www.rib.firstambank.com/OnlineBanking/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WorcesterCU/login.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/cityofbostoncu/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/AbingtonBank/signin.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FleetwoodBank/login.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FCBANKeBanking/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/bankatsmcu/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://www.adamscommunity.com",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/bankeasternct/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BristolCountySavingsBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/northshore-bank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/ProvidentBankOnline/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/HometownBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FreedomCU/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/pncu/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/bankatpeoples/login.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/thomastonsb/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/NWCommunityBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CornerstoneBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MyMechanics/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://xfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FlorenceBank/signin.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/PutnamBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/newtripolibank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Freedom1stcu/login.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EverettBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Salisburybank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/mywestfieldbank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/SBDOnline/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/descofcu/signin.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Ionmybanking/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/PeoplesCU6933/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/LibertyBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CHB/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FirstCountyBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/NorthCountrySavings/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/DimeBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FFCB/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/TorringtonSavings0776/signin.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/winchestersavings/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MyMutualBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FCBConnect247/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/northeastonsavingsbank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/SI3728/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/banknbsb5814/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/newportfederalbank/SignIn.aspx",
,If-TRUE-Goto,Error940,
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Village-Bank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Wallkill1913/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/windsorfederal6319/SignIn.aspx",	//FI ID: 5812
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/FBNJONLINE/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/SFCU/SignIn.aspx",      //FI ID: 101176
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/collinsvillebank/SignIn.aspx",      //FI ID: 13579
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/TheCooperativeBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/LedyardBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/drbank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/UniBank/SignIn.aspx",
,If-TRUE-Goto,Error940,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/ColonialFederal0750/SignIn.aspx",
,If-TRUE-Goto,Error940,

//===========================================================

,Compare,##TOWER_WEBSITE##|"jeffersonbank.ebanking-services.com",
,If-FALSE-Goto,SkipThisAssignment,

,Assign,CompanyID|##SYMBOL_vtbCompanyId##,
,Assign,##TOWER_WEBSITE##|"https://online.centerstatebank.com/OnlineBanking/SignIn.aspx",
,Assign,loginURL|##TOWER_WEBSITE##,

SkipThisAssignment,Assign,userid|##SYMBOL_M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName##|test,
,If-TRUE-Goto,skipBelowCheck,

//===========================================================

,Compare,institutionId|"7175",            // This is ask by the FI - service provider to use two IPs
,If-FALSE-Goto,lblSkipTrustedLIPLogic,

,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,skipTheBackUpIP,

,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8221",
,Assign,IPADetails|"Back UP IP",

,Goto,captureLogStatus,

skipTheBackUpIP,Assign,IPADetails|"AWS Primary IP",

captureLogStatus,NOP,
,Assign,epoch|##NOW##,

,Log,STATUS|"MidWestOne Bank"|##REQUEST##|" request start time "|epoch|" Requested IP "|IPADetails|" for Customer Id "|customerId|" and Partner Id "|partnerId,

lblSkipTrustedLIPLogic,NOP,

//===========================================================

,Assign,userid|##SYMBOL_UserNameTextBox##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_login_form:username##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_SignOnId##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_User ID##|test,
,If-TRUE-Goto,skipBelowCheck,


,Assign,userid|##SYMBOL_ctl01$Main1$UserIDTextbox##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_ctl00$ctl00$cphMain$cphMain$txtSignOn##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_userid##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_ID##|test,
,If-TRUE-Goto,skipBelowCheck,

,Assign,userid|##SYMBOL_userNumber##|test,
,If-FALSE-Goto,Error103,

skipBelowCheck,Compare,##TOWER_WEBSITE##|"https://onlinebanking.thecooperativebank.com/thecooperativebankonline/", 
,If-TRUE-Goto,Error900,

,Assign,password|##SYMBOL_M$layout$content$PCDZ$MF3KFEF$ctl00$webInputForm$txtPassword##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_Password##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_ctl01$Main1$PasswordTextbox##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_ctl00$ctl00$cphMain$cphMain$txtPassword##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_password##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_password##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_PIN##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_login_form:password##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_ctl00$CubusContentPH$ctl00$PasswordTextbox##|test,
,If-TRUE-Goto,Check_Tower,

,Assign,password|##SYMBOL_M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword##|test,
,If-FALSE-Goto,Error103,

Check_Tower,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,GtToSetSocksProxy,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",	//FI 5341
,If-TRUE-Goto,IPDistributionLogic, 

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",   // FI ID: 4799
,If-FALSE-Goto,SkipGtToSetSocksProxy,

////////////////////////////////////////////////////////////////////////////////////
//			IP DISTRIBUTION
////////////////////////////////////////////////////////////////////////////////////
IPDistributionLogic,NOP,,
,RandomNumber,RandomNum|,

//------------------------------------------------------------

,CompareNumbers,RandomNum|1000|<=,
,If-TRUE-Goto,SocksProxy_PoolB_22,

,CompareNumbers,RandomNum|2000|<=,
,If-TRUE-Goto,SocksProxy_PoolB_22,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",	//FI 5341
,If-TRUE-Goto,skip_8221_8224,

,CompareNumbers,RandomNum|3000|<=,
,If-TRUE-Goto,SocksProxy_PoolA_57,

,CompareNumbers,RandomNum|4000|<=,
,If-TRUE-Goto,SocksProxy_PoolA_39,

skip_8221_8224,CompareNumbers,RandomNum|5000|<=,
,If-TRUE-Goto,SocksProxy_PoolA_38,

,CompareNumbers,RandomNum|6000|<=,
,If-TRUE-Goto,SocksProxy_PoolA_37,

,CompareNumbers,RandomNum|7000|<=,      
,If-TRUE-Goto,SocksProxy_PoolA_40,

,CompareNumbers,RandomNum|8000|<=,
,If-TRUE-Goto,SocksProxy_PoolC_53,

,CompareNumbers,RandomNum|9000|>=,
,If-TRUE-Goto,SocksProxy_PoolZ_23,

//------------------------------------------------------------

//SocksProxy_PoolB_21,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8226",   //Pool B
//,Goto,SkipSetSocksProxy,

SocksProxy_PoolB_22,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8227",    //Pool B	 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolA_57,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8224",   //Pool A 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolA_38,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8220",    //Pool A	 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolA_39,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8221",    //Pool A	 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolA_37,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8219",    //Pool A	 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolA_40,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8222",    //Pool A	
,Goto,SkipSetSocksProxy,

SocksProxy_PoolC_53,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8223",    //Pool C	 
,Goto,SkipSetSocksProxy,

SocksProxy_PoolZ_23,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8228",    //Pool Z	  
,Goto,SkipSetSocksProxy,


////////////////////////////////////////////////////////////////////////////////////

SkipGtToSetSocksProxy,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipSetSocksProxy,
GtToSetSocksProxy,SetSocksProxy,"ccliteproxy-nlb.prod.fini.city"|"8221",

SkipSetSocksProxy,Compare,userid|"",
,If-TRUE-Goto,errorLogin,

,Compare,password|"",
,If-TRUE-Goto,errorLogin,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-FALSE-Goto,Next_tower1,

,GetURL,"https://nasb.com",

,FindString,"Routing number:"|test,

,MoveToTag,"a"|"REV",
,GetDataFromTag,|RoutinggN|,
,RemoveHTMLTags,RoutinggN,
,RemoveExtraWhitespaces,RoutinggN,

,ParseString,RoutingN|"Number[:] ##KEEP##"|RoutinggN,
,GetURL,"https://nasb.onlinebank.com/SignIn.aspx"|,

,Goto,NXT,


Next_tower1,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",   // FI ID: 4799
,If-FALSE-Goto,Next_tower2,

,GetURLv2,"https://langleyfcu.onlinebank.com/SignIn.aspx"||test,
,If-TRUE-Goto,NXT,

,Pause,10,

,GetURLv2,"https://langleyfcu.onlinebank.com/SignIn.aspx"||test,
,If-FALSE-Goto,error102,


,Goto,NXT,

Next_tower2,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,jumptoRoll,

,Goto,Next_tower3,

jumptoRoll,RollDate,##NOW##|tempDate|MONTH|-16|test,
,CompareDates,##STARTDATE##|tempDate|>,
,If-TRUE-Goto,SkipThisAssign1,
,Assign,##STARTDATE##|tempDate,

Next_tower3,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-FALSE-Goto,SkipThisAssign1,

,GetURLv2,"https://onlinebanking.apgfcu.com/SignIn.aspx"|,

,FindString,"Routing Number"|test,

,GetDataAfterString,RoutingN|":"|" "|test,
,RemoveExtraWhitespaces,RoutingN,
,RemoveHTMLTags,RoutingN,

,Goto,NXT,

SkipThisAssign1,NOP,


//************************| Routing Number Get in Login Page |************************

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,skpNo,
,GetURL,"https://www.nwfcu.org/",

,FindString,"Routing Number"|test,

,MoveToTag,"DIV",
,GetDataFromTag,|RoutingN|,
,RemoveHTMLTags,RoutingN,
,Goto,goRemoveNo,

//************************|

skpNo,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-FALSE-Goto,SkpthsNo,
,GetURL,"https://www.coreplus.org/",
,Goto,goRutingNo,

SkpthsNo,NOP,

goRutingNo,GetDataAfterString,RoutingN|"Routing Number:"|" "|test,
goRemoveNo,RemoveExtraWhitespaces,RoutingN,

//************************| Routing Number Get in Login Page |************************


skRutingNo,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-FALSE-Goto,NXTCheck,

,GetURLv2,"https://fultonsavings.com/about/routing/"||test,
,If-FALSE-Goto,NXTCheck,

,FindString,"routing number of Fulton Savings Bank is:"|test,
,If-FALSE-Goto,NXTCheck,

,MoveToTag,"SPAN"|test,
,GetDataFromTag,|RoutingN|,
,RemoveHTMLTags,RoutingN,
,RemoveExtraWhitespaces,RoutingN,

NXTCheck,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0"|"T",

,GetURL,loginURL|,
,If-FALSE-Goto,errorRetry,

NXT,FindSignature,"We are currently performing an essential system maintenance that will enhance your Internet banking experience.",
,If-TRUE-Goto,errorRetry,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Laurelroadbank/SignIn.aspx",
,If-FALSE-Goto,SKP_Error1o2,

,FindSignature,"Internet Banking - System Maintenance in Progress",
,If-TRUE-Goto,errorRetry,

SKP_Error1o2,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,newpost,
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",  // FI ID: 7882
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",  // FI ID: 4399
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  // FI ID: 7112
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.affinityplus.org/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,Check_newpost,

,ExtractFromRawPage,__EVENTTARGET|"__doPostBack[(][']##KEEP##[']"|test, //"
,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_content_ScriptManager_TSM=;;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba1d5018-bf9d-4762-82f6-06087a49b5f6:ea597d4b:b25378d2",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION
,SetPostURLData,"M$content$PCDZ$MEC27PJ$ctl00$ThirdPartyBB"|"0400CIfeAe15Cx8Nf94lis1ztrjQCvk297SBEwmdU5pwECE7pgYFcL+OmGTDHZ3xfF7reuJdvS+WgLWxH1ZPRIwM6iaikdE2N/iBS7gHh9oerxrosS1xgSAgNfLEMokGoGJxFIfAVsN/zYkLZvJf+ufB1Z5jUZy7hqneDPWCyXC02/owt6O60biHEkLivy4aXv1LKA75SqnFv74B84+POrI4MlDvgCJ6XflMpM5YbymrVY4S1YNroVW2O7yYh9ioMicWL9Jy7/47AzuYFkjtvjQOGXETVsuG085dfJ07P93t0yNwPpPV0ZSMv3LstdftRXYOpn61BFnoMEQIfXVCMVuCIc8WQUXX80r4YUMMilVObLmbhL/C9+XJNMQPcd6kSm4zm2UbrU22b3Pd6Wf1rrmlEMI/D/Ckcc2ho2Ji61Ck5rdiHsRUrA6QS4uoKmLN7sWcP2Mr+/EBlpYwZ8YN8wmMvXwu2RQ7YquaQNP2F0tALyQoKYL+18TP/bmZnC9N+MV7eiZ+2DQq5o4KMsVP/8+dCQWp6WuK4Z2mDX8icOWPZcz7cCunQS9MKzlVT8kOFdaE/w392jwM24dikZe0SQMUXYJSr5XCSAZ4AfOPjzqyODJQ74Aiel35TKTOWG8pq1WOFFQ7u5XiG2Lu9di8GVLrlNebRcG2+TZFbuzYF/wXLkULbh5nOj3u3DXqRCiKCUrsN3eiCpkjn9k5PQ75W2PMocgH1DGeSyhahZfNQgu+lmSl2pKAmu1wlgCNN05/tQFPaSyxlUFCiGEdsE8OdwolilJO1SuKjjw/yz4BSlIMVJIgqHxyPWh5ihlbIdRmRm/7fjFoet6GKtImbkkLjx3nLDTXFJ7y4ze/bnbPUJ21TrgnisaDS2yKtlsd8hceVGe+iWOLzKti1KiLnKh0fm9/iYZ7fKd6gKu8nikcXKcJmCbnVb7uHgXQGaoIyE60FXMq9mYB2rT+4sprRjLkmcdik+L2mUlKdOHXIWjGlQELBrwBZ7Dtc6bKgV8RxMrbb/bbZq12xBtEU8822MSfeX962GTmOqLA3SnRWpw7F97JvJNeCg717oPn0DYRrFt+r6N3oQAEIFe5Z287d7eMEu81OlagcmmUvg6u",//"
,SetPostURLData,"M$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1",

,PostURL,||,

,Goto,Check_These,

Check_newpost,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://creditunion1.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fairfieldfederal/signin.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://bossierfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,
,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newpost,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,gotoBelow,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkipUBTPosting,

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkipUBTPosting,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,gototyndallonline,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,sunflowerBank,
,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkipUBTPosting,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx", // FI ID: 4231
,If-TRUE-Goto,sunflowerBank,

,Compare,institutionId|"7495",   
,If-TRUE-Goto,sunflowerBank,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-FALSE-Goto,gotoCheckFalconbank,

sunflowerBank,ExtractFromRawPage,__EVENTTARGET|"__doPostBack[(][']##KEEP##[']"|test, //"
,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  

,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:92dc34f5-462f-43bd-99ec-66234f705cd1:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"M$layout$content$PCDZ$MY6Q7NM$ctl00$ThirdPartyBB"|"0400rFK0xCscs7eVebKatfMjIDncoMQNMpw7h6LdriQ0eZBN01HoRWHOg0iZTtuWpmZuRRlF10/H3V2hRXcJpSia9WTmOqLA3SnR7PiehzsLDa2bM0paliGaqlsaY6B/xOZjoL8CTsGzWBfLWo4CAktmNpOu2+OTOvwB8VWo4o1/6JS5pL6t0LPI+Uw8mhH63qwV+0DWC157mHMxkMHngNulqldlCNdiZx5Pfd+cfmbmKunCsgTY4iP+fP6a+9aA+etatsRgGm8FP4SDrm8G+dIVIe1uQ27F2pOGTn3ScfrBfYRhaviqfMxsE/+m7mDyYM3o6OF28o+krOXUg3MfWmiDnuf631VoZjpGSLd8hg15YP/vUSbJ+Ltz3R3+1lLYqHZEjyOnrWRIP4EIjmJ24pTn7sCex0eJx7mnb+O5jfppV28Y2Cl8eZtoDplQl4tVyU643d9kPn4BqDHKArKrtmX2cIzx9IIjIEgsjF1TisdEDtQxBA5WKFKgYDyP5j9JFC1xIYEDW5i4Xb7TfIZ7FC//m6xGO26p1Drrr/0mIN4jHWtr/ucarS2tvUyfqSZi/PYFif/82O7dEqFxamk15XrHmq7AK/cCJmVwo/wUhOD/E3WibQ9v39WyWwXojk4bF91PoEsMRGvq6lgP+iVmAXYTHclsg4T4n9OcZMMdnfF8Xut64l29L5aAtTrTeacbV3eUHhW4AhAJUpSZ47nYJC0gMxLXrw6h637KjNXsgMEghG3ToyQshPQL86tWOlIv+2+1qcesP69MTO+CuJoygDKlC7I+vS3zO1UWKyNRXh0mw7Kb1x4cMpEKIt59OmHWqK78pXjqvRKtNIku7P4czcXXKf0uE/n/nVnc8t+wMdfN4fRGASpJ6ETmLY3bU6MyqFjGWLcI2zXm0Q0Mgog1WtCs0kntMwDARHuVVMNIug7nnjWmp6esfKIOHVYLhnQo+ZYXlRe3TZTOdJ857RHFZltZDO2gCoobq7/qkp62yUjciLFgfUflhWun3fVwbkrxMASQwkGouP5PPyvQ78T0AGn/16+Vx63F6egNaNXNAg1ymQY8k/8Qtwly0ZIEFaG7TsuZF23lTgKl7Ajou5GL7lS1H+wL2sPa4fJqGMf7iC8VyB7J5KZOY+8O2Z5lbKwbkY1WLiLEJ4zNTnkrrpMGUxFkaAFe2gWIqQOulcABhHdx+C/edkQFDysAs54roTaAzhhL9dGxFoZVjnY6x7o612Lmxo1znntcmg8XJBn5BBNVlloI1JkXIB6wRvlh66uHx2zqxtdo+yudjOcPaDqCpWVzIJm3FMhhyjZkTB0k8rFmFIcgEwpARWsn9hIy5OJcuFh7ACDNZcscw/8V4eM9oP7wmZc0Jwb15wUeYjVVSeaPxnwM0CdK0MRNH73+P+AhEwXMYYjeZZ3qdNP/FfHPmIcnYXCdgeGCfTTjkxjx/rdTI/lZWiiL0b6tlnxBQe5qIDWrHSEoqGuWOLeT5m3DjFP0z13MaxSzSZuOsxz+GXZaQWqg4mz/4yXQ3o6H2W0dl9AiCA+hWOqdNHoULoDhcfK1nnng/jEWgBDfSUpGCTU5RhAl/JRoayWfBpgvo0xxZrl9+TPnaUWu46yU/mq0zsM78QM6fBjHT6jh4EYIMcTbziv3tvYzvgykbo3+5OTa00K/kLVSObSM03FFGnzQQhl04gyU/v8DVbZ1QHbLehnsCCe3TA70opGbv/nVwl4+GYSv1CTO3H15bVBYZoNaqABaBaD66vM5l82KlxhXdawy+44yQ5vfRsMxLaQ5lI+s9EjGlniwCTJl1bGDchu+2lGv9V543P8ciZCxtdgH5rKvPh/Qp1tjJyTVqwilAnn4peq8IMmkqi7pUuAZWPRZb8swcFpS5AL2AIcuDNxKxT1skpqlG2vwqfw1ehYm56UypZLWGLsuaouiTNxGe4P5kG6Xpemwo9i9Puwx50xmPl+zzeYgMYjXz1e0l87mjLVAf4d6hl8nQ9tU2gjLmWo+5jqtqubfcym7pUbiD7NSVzGqXzEcjyck6vkO3bNSz+CYHay1+eMFKTBmtLJ04hiAcL/dBgQsLD4xQlj155sIgPMzEM3RuvkFo8KfUTRa3zoxoDC43T0I7uSmqz1eCgnBAOVKNLm346SwwkXKKFCG0FxnUKqouBIKbDFIma5d1oa9+/BaPYsZaXmV0DUsQQaeu9R1rWooZpkxypD6hoplQSZ9E1OZuG5id98CMI08xg6wuNhg7SxEmtFwZpaqo/HUPixzfe5pDd/xfT3m19002loYSI4v+bwdopj8Bx7FmM+c2SasYhbWND0o4AMzJHwVUpAL3j98v6U0yIhQo3c0ZdmmvEiM/P8l/YckxMMhS0HX2mzXhs6ZTqAeTOAusXGpErjvH417o6YqHTWZxNB9K3DeKF4dugtxq2Ny635GIl1SKEAikk7WgNHRTlQtCSR0wQ6/4Ssv89hQcgT60FED+OJV8JtF4vNdcHvn8fhpPFx0ilyWkveH1/z+uG9edqr8TBchAGIvKibaIIO4IObZyM8J8Yg5YLykXRIViTHmS0GQvOE+hGNYGXzTluvUASQQOXR4MGM47KaB4djD3sEGG3iPshu1YH4WcLr1heH2AHd1WIUGQAaNYUhMraNnNx/uQMvYH8BgRx30N1T6+54bRZcHSbOy2ptpn42Ca3l/eHEW3xXrnlEe/xwpqgsS1ZdUgTb1Og==",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,PostURL,||,
,Goto,findnextString,


gotoCheckFalconbank,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,goForBankFund,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MKZM13S$ctl00$DevicePrint"|"version=2&pm_fpua=mozilla/5.0 (windows nt 10.0; win64; x64; rv:77.0) gecko/20100101 firefox/77.0##PIPE##5.0 (Windows)##PIPE##Win32&pm_fpsc=24##PIPE##1280##PIPE##720##PIPE##680&pm_fpsw=&pm_fptz=5.5&pm_fpln=lang=en-US##PIPE##syslang=##PIPE##userlang=&pm_fpjv=0&pm_fpco=1&pm_fpasw=&pm_fpan=Netscape&pm_fpacn=Mozilla&pm_fpol=true&pm_fposp=&pm_fpup=&pm_fpsaw=1280&pm_fpspd=24&pm_fpsbd=&pm_fpsdx=&pm_fpsdy=&pm_fpslx=&pm_fpsly=&pm_fpsfse=&pm_fpsui=",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:92dc34f5-462f-43bd-99ec-66234f705cd1:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"M$layout$content$PCDZ$MY6Q7NM$ctl00$ThirdPartyBB"|"0400JapG4txqVP4Nf94lis1zttIfQWBPMg05KAKeO26l3UXe+kxV2CxWKej7z9sE1LeCfY3EGQq4/xwm0z9IRvkJUO7YwkJKLXY0MOcVkGcC7wStwFTSfW0mlgyCiDVa0KzS3EXoW3wRrlco8IG1qk9lADZl0PYm2l/BDXMzdeKt5csId7H9j3oUV849hFWxuN4a8cFCb3XpK0LXm0XBtvk2RW2s0fO33l4+Bez6hBBzrS2usa2jjh0Vn4k6g7bK73nzHOZYgLcaa3JiEata0vFdmyV3wTWnDe3+LWbsBJsBwxoK7ZWd2T2HOoc4ZQeWrYTAoEfcEV5dj+rvTE7vbTHBJ7d9iGfaHTjgCkEM8e/iMYnF7BBqduSkC0IdvEt+MbJEO8xzyZZyces4cd3X0jzFPvVNpcwLDjDrv9eOvsyvTBVVGK66EXEuaD0YLXuOWeFzq3oL2aXGiTDvUSbJ+Ltz3R3+1lLYqHZEBN0/akV6b59vAQBZ/Ks6YZOQHT8m9bjrKULPxBs5mS/BOpFV73vREH1CS+yG8MyR5GNPK0XLOSO5AUf1ExG2N7VNM6E+MU6gT+HoQVdeZcT9MGh9udTySUcOjS9hgMLfJMLraAXmI9htrNHzt95ePgXs+oQQc60trrGto44dFZ8zqbwpmWa8IyMAAWnl4iPM+F9+VNHlcz0waZWk5d3ocrOgSQ0Fzflca1WxiZ1a0z33/rTYqQrmLD1SgAMgvGuiISKiq4yvoHcgBVMDdOYV885IvsRSnt/S1YYITyzRwv8PXXpOa/Fh/Q7T6v45cktLrI9wc9lbzgfXd9laqdREDOshaHYP8Oq6k+cVXJiV2yKAmeNHH6+w6smuV2dvtSXe3qoKEABErJR3pIpfKdzS69erj3a0zo33JWZdIpsvRZaWNVn+1ZIH9PsVwWO8HYvt3ZEXJ7Lu3fQcgsBTfrdTaNMDc2VmnBkfAbp69GdgrnB2KKkVRLfrryi92D5HvdyUuh1PwBdAsM0=",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,PostURL,||,
,Goto,findnextString,



goForBankFund,Compare,##TOWER_WEBSITE##|"https://fsb.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,GoNewTowerWeb,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTTARGET|"__doPostBack[(][']##KEEP##[']"|test, //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:388bfbd4-0ace-4097-bb89-303d009ab8b7:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2020.3.915.45##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:b87b3d5b-f055-4852-bdaf-fef1991116e3:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MY6Q7NM$ctl00$ThirdPartyBB"|"0400bpNfiPCR/AUNf94lis1zthsEKnBjBXXQm2VC4/IJTQyv21xzpIPXfaRbfusO9xp6i+J28+Cj69V2KT4EIhFconQ+rlIMTewV8wZ4Emlv1NY/yoVIBnjain3l6hbzqbSTkMYQoOpZPIkSrCrExFd1rgW/+UDvrzoqYDvethm0ixXKgDzSlcJpdr6Tc+lyrFem0LVQmADUFBlDgm50c6V/UpKetslI3IixYH1H5YVrp927mIZGZKEKh2z5AQZVTGq8P+g9ErKzWVLfHYTi14x8cCRQ3fV20ZNSb+WUXaUFNn7T7W+bd9sPislxTT4Bc9gklgVjlQT1iC96vRtGcfE2ywP5j3jXhmpzamv2jL/DueTxOavmojbG3vPfBp8j9ZgcSxMKzZMpFJQHzrT9i0BebEiiVUxIaolgpiIn/4g7jAnC1AevYOBPe8UvRkxkPz1xCLE4AkdHOFnAqvQx/6iBZjoPcOyOxFI2fgKWKwZbIkcEec7RTWPQG9T16TeM5diEHf7WUtiodkQIb7Y/3/de5l6z4xUH2luBSe0zAMBEe5VUw0i6DueeNaanp6x8og4dVguGdCj5lheIrev4NR6TBzntEcVmW1kM7aAKihurv+qSnrbJSNyIsWB9R+WFa6fd9XBuSvEwBJDou5GL7lS1H+wL2sPa4fJqGMf7iC8VyB7J5KZOY+8O2Z5lbKwbkY1WLiLEJ4zNTnkrrpMGUxFkaAFe2gWIqQOulcABhHdx+C/edkQFDysAs54roTaAzhhLNYBu/nSSujAF/ImMsuY70u6HOYdWG7Eoyc+w5tzTEUefHUJkTVP7EMSmRZOWcyLmDiaZgrFVtGu7a2/KwSSeilJadUmBjBR9fRKZqgbgW5rvbZaXTVK9lrWXyfE1y31nBhOaUvOrATC9DRFSlYpHB7zaphfgmatxAp3m5l4KvZkctc66/IpWB3pUgef0EiRuDJWyOgp3dOlcHdOdnbJ1fRaIhhiNsS9cJdVNvb3I131VJUiLP0GDKrdGBlemHwmJBqILQzBMiPgaP6SlEgzxu3T993wZ6fMuARUvDdu7Khm1oQJw5UvYzL+4llO0lC/oAZW9+Z0dAYuA6aV6el2xlqSGdaHbDMafcD6T1dGUjL8ETq5fTQBhQgLEnq4BLZPvFfkGh32CVqMR6wLirbiybcTK5aXwowJSNl7aN430hrDjK9GFecOQi18DaQDJNHgaUV0cnOdIm+Z/2ltq/R+OGRj1jIcbuezcjYCXTx63BUUTCi2eaMatng==",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1",

GoNewTowerWeb,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-FALSE-Goto,CheckNextTower,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTTARGET|"__doPostBack[(][']##KEEP##[']"|test, //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:388bfbd4-0ace-4097-bb89-303d009ab8b7:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2020.3.915.45##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:b87b3d5b-f055-4852-bdaf-fef1991116e3:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MY6Q7NM$ctl00$ThirdPartyBB"|"0400bpNfiPCR/AUNf94lis1ztl2f0eBwPuTXEwmdU5pwECEzhwTUmtn+QrIfBGFPEQaWJtM/SEb5CVDu2MJCSi12NDDnFZBnAu8ErcBU0n1tJpYMgog1WtCs0txF6Ft8Ea5XTcK+UKx8VU0FvwNpyX2JYbkIlXncLYuIm2m7iwQyd/xVah0xS2NUk4zz7OS71fh8ex1TLARybUr4X35U0eVzPZXAAYR3cfgv3nZEBQ8rALMK+Gmlok3t4RenLqoLuw3zAgvBZwn30pqwFi2E19zadl5irGUVw3NL1LRwn1gAuSZrRjLkmcdik8i2nhAQGk8JCEazjLPPBiEUJ/pd8vBDRG98n6NKJqSzCaearIU9lIF3QPxq+/mKGXfEF80+AcQH38pSyICgJR0md2Sb2hs+sitIZYhQ9ADpB2GDXcjpghm9klVFOw7EoYzV7IDBIIRt06MkLIT0C/MJB/s4Mwp5bnomftg0KuaOw5llneNpe8uAJkjnn2P1p2IPArjDreTCT43R5j+o8w6viH+y3gcSTdgbXnfI1FM6SzKz6zFbyZYGBryzOyuYvPhGzlv/uiG4qlr028/3Pq9Lz4bL3EXbyUBHbtl2L6+OAV7aBYipA66VwAGEd3H4L952RAUPKwCzniuhNoDOGEsJdmNWP4mnLySIEmkyozD9JUF4rMCu74lhfIUcFuybLLNvS9LBZED55Ix5aAKTQzyBTn6l/Soa3QZSDp9xOWCHXOp4yYEIf+L1yYqstDFzEDsS3ZqHpyqjkgQVobtOy5kXbeVOAqXsCI9qpLt2ZL855eceSbAGSzD9oLrVw9w/lY1znntcmg8XIiroNPn6uMT9rxZ7qeEFWUA5x9vd1ILAZXAokj1sZ065XXfOJpp/kjJWOZNOQseCDXnf71cwGUUHWMsTMKode+P8xnORJ9SnzC5s+LfE4dssPiZXdNCqfKAbzwOrtOItTHA2labaL22J1D3KVsetdIreWx3EToQinulMwKMSZViOIOCvQiUagZrdaPkNZ700Ygp23z9+qM3MoEYfej5aHA3jbv89sqjaEoeeuwzPj/CnNa/LVwui/ZVPfVKB9sZJgmxzEILhC3ttLd7RSWd35D5dYp+7sYojm4FHvg006ocTY2oFjV8Ut2CYQHWC+F7oIi7SoUevORpjJg4omQb0rCEcdu28U5AxrkHhFSEI8W9yS7r1dOFXrQN/QEOomuYoMpCjF6dsqC4=",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1",

,PostURL,||,
,Goto,findnextString,

CheckNextTower,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skip_AmericanNationalBankpost,
,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MKZM13S$ctl00$DevicePrint"|"version=2&pm_fpua=mozilla/5.0 (windows nt 10.0; win64; x64; rv:77.0) gecko/20100101 firefox/77.0##PIPE##5.0 (Windows)##PIPE##Win32&pm_fpsc=24##PIPE##1280##PIPE##720##PIPE##680&pm_fpsw=&pm_fptz=5.5&pm_fpln=lang=en-US##PIPE##syslang=##PIPE##userlang=&pm_fpjv=0&pm_fpco=1&pm_fpasw=&pm_fpan=Netscape&pm_fpacn=Mozilla&pm_fpol=true&pm_fposp=&pm_fpup=&pm_fpsaw=1280&pm_fpspd=24&pm_fpsbd=&pm_fpsdx=&pm_fpsdy=&pm_fpslx=&pm_fpsly=&pm_fpsfse=&pm_fpsui=",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:92dc34f5-462f-43bd-99ec-66234f705cd1:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"M$layout$content$PCDZ$MO8RW3V$ctl00$ThirdPartyBB"|"0400JapG4txqVP4Nf94lis1ztn8oLF24je6XihDfhoqPuQQaP6SlEgzxuyxIG+JvBGpXxNfI2aA674EVagjjVH8S7n2XlrQjJCqtak955pGAV2t1SymuXlKryeXc4KIy3xRrSMJ5Y4HQNTYupMhxmMVHRtNwb+11uk0NzkgVLTKsHoQY4cHSCe2dG9AIgZSiy2vDGFGXn4FesX9ltmjcBjCHCr6Tc+lyrFem0LVQmADUFBlDgm50c6V/UpKetslI3IixYH1H5YVrp927mIZGZKEKhwT5r2XHQSW/P+g9ErKzWVLfHYTi14x8cCRQ3fV20ZNSo+VpeopKIAnT7W+bd9sPih8SskOX5D+0i56k7bRzGdq2G4N+mvWOEPHGxvkHRmrrwFIJ0XW63ngb6WWvJeGhffPfBp8j9ZgcSxMKzZMpFJQHzrT9i0BebEiiVUxIaolgpiIn/4g7jAnC1AevYOBPe8UvRkxkPz1xCLE4AkdHOFnAqvQx/6iBZulzR3iofwxfb5i3t5pwBk6IbqNkf0qrWdT16TeM5diEHf7WUtiodkQxk54yN8s4LywSl6v9nGWBxKmKi0E5mbJUw0i6DueeNaanp6x8og4dVguGdCj5lhd6KpDlQ3U+LDntEcVmW1kM7aAKihurv+qSnrbJSNyIsWB9R+WFa6fd9XBuSvEwBJDou5GL7lS1H+wL2sPa4fJqGMf7iC8VyB7J5KZOY+8O2Z5lbKwbkY1WLiLEJ4zNTnkrrpMGUxFkaAFe2gWIqQOulcABhHdx+C/edkQFDysAs54roTaAzhhLNYBu/nSSujAF/ImMsuY70u6HOYdWG7EoJYvgIxUXe1Eu588Qv//qEMSmRZOWcyLmDiaZgrFVtGtJSkYJNTlGEF3GN1atmsnavCetqNun752OAWdNbsTwiyXmAp2trvAG+/nBrAXUhh2mN7kN4fJnEnB7Yzj3KY8iqnDM1QITyBLYGBORHgo75LEJK3MQykNtJ6RMOziUgRk=",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,


,PostURL,||,
,Goto,findnextString,


Skip_AmericanNationalBankpost,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skip_firstcommandbankpost,

/////*******************************************

,FindString,"Routing Number"|test,
,If-FALSE-Goto,Skip_firstcommandbankpost,

,MoveToTag,"DIV",
,GetDataFromTag,|RoutingN|,
,RemoveHTMLTags,RoutingN,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:4feca508-514b-48c0-a162-7fa9c360d783:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MXJVX87$ctl00$ThirdPartyBB"|"0400bpNfiPCR/AUNf94lis1ztmB7mkLqqCwiXxmxJxZtl1hyDUsoyocgUg/6JWYBdhMdyWyDhPif05xkwx2d8Xxe63riXb0vloC1sR9WT0SMDOomopHRNjf4gUu4B4faHq8a6LEtcYEgIDXyxDKJBqBicTfmDTdP81XwE3BlW3dd2K1gO962GbSLFcqAPNKVwml2vpNz6XKsV6bQtVCYANQUGUOCbnRzpX9Skp62yUjciLFgfUflhWun3buYhkZkoQqHNPBFAzkBG0c/6D0SsrNZUt8dhOLXjHxwJFDd9XbRk1Lp3qXmXmdqMdPtb5t32w+KogGkhrdbJtPNu+pPjSw/izD0GYYb4GLzflrL1Pj2eOp4Vi8gXY3THa/0zNj/ebH0898GnyP1mBxLEwrNkykUlAfOtP2LQF5sSKJVTEhqiWCmIif/iDuMCcLUB69g4E97xS9GTGQ/PXEIsTgCR0c4WcCq9DH/qIFm6XNHeKh/DF9ekm1UX3XsjnTRabMCFndp1PXpN4zl2IQd/tZS2Kh2RATGMgtzEHaKsLgy6jIZp50O0+r+OXJLS1TDSLoO5541pqenrHyiDh1WC4Z0KPmWF64QhX3qAdTUOe0RxWZbWQztoAqKG6u/6pKetslI3IixYH1H5YVrp931cG5K8TAEkOi7kYvuVLUf7Avaw9rh8moYx/uILxXIHsnkpk5j7w7ZnmVsrBuRjVYuIsQnjM1OeSuukwZTEWRoAV7aBYipA66VwAGEd3H4L952RAUPKwCzniuhNoDOGEs1gG7+dJK6MAX8iYyy5jvS7oc5h1YbsSjJz7Dm3NMRR7nkWuO/t1BRxKZFk5ZzIuYOJpmCsVW0a0lKRgk1OUYQKjq94vaofNAhGAahsns4R5b61EcXmOnZuyrupGGeI3Q99Zl1pEYLqBh5K0CnqhSUW6ka7SeNv/2xEiyT9KL4j4WpFuh7gk2VkxM0AaMw4FDeUe6BJ+E0LonUPcpWx610Pt7pVEjfrBio6YtxHYPgOu0/JJdjextNMrf2ScwvTTTp25hCrc28A1sgixHLZ5tBJmb3mLTSVHLmx2vNwg2QeoqdQvw641fUglzQtRLCDpJ/QVAZtX/QHn6q0F9Qre4nPm4Mc7eSugEP78vfZFzQ2oL5kL+6EqUe3WSiFx72DBozc6oLdB+sDf+PyYk3hqxCI2Ge/h1n+rIWoxn+Dri6am9V4Z8dPGq3Zhr1Oy9G5pM=",
,SetPostURLData,"M$layout$content$PCDZ$MDSUI6N$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MDSUI6N$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MDSUI6N$ctl00$webInputForm$cmdContinue"|"1",

,PostURL,||,

,Goto,skipremindme,

//////////*********************************New Login Posting for FI ID 5343 *******************************
,FindString,"Routing Number"|test,
,If-FALSE-Goto,Skip_firstcommandbankpost,

gotoBelow,MoveToTag,"DIV",
,GetDataFromTag,|RoutingN|,
,RemoveHTMLTags,RoutingN,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:b7585254-495e-4311-9545-1f910247aca5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MKZM13S$ctl00$DevicePrint"|"version=2&pm_fpua=mozilla/5.0 (windows nt+10.0; win64; x64; rv:65.0) gecko/20100101 firefox/65.0##PIPE##5.0+(Windows)##PIPE##Win32&pm_fpsc=24##PIPE##1600##PIPE##900##PIPE##819&pm_fpsw=&pm_fptz=5.5&pm_fpln=lang=en-US##PIPE##syslang=##PIPE##userlang=&pm_fpjv=0&pm_fpco=1&pm_fpasw=&pm_fpan=Netscape&pm_fpacn=Mozilla&pm_fpol=true&pm_fposp=&pm_fpup=&pm_fpsaw=1600&pm_fpspd=24&pm_fpsbd=&pm_fpsdx=&pm_fpsdy=&pm_fpslx=&pm_fpsly=&pm_fpsfse=&pm_fpsui=",

gototyndallonline,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-FALSE-Goto,nextcheck,

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MKZM13S$ctl00$DevicePrint"|"version=2&pm_fpua=mozilla/5.0 (windows nt 10.0; win64; x64; rv:77.0) gecko/20100101 firefox/77.0##PIPE##5.0 (Windows)##PIPE##Win32&pm_fpsc=24##PIPE##1280##PIPE##720##PIPE##680&pm_fpsw=&pm_fptz=5.5&pm_fpln=lang=en-US##PIPE##syslang=##PIPE##userlang=&pm_fpjv=0&pm_fpco=1&pm_fpasw=&pm_fpan=Netscape&pm_fpacn=Mozilla&pm_fpol=true&pm_fposp=&pm_fpup=&pm_fpsaw=1280&pm_fpspd=24&pm_fpsbd=&pm_fpsdx=&pm_fpsdy=&pm_fpslx=&pm_fpsly=&pm_fpsfse=&pm_fpsui=",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:92dc34f5-462f-43bd-99ec-66234f705cd1:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"M$layout$content$PCDZ$MY6Q7NM$ctl00$ThirdPartyBB"|"0400JapG4txqVP4Nf94lis1zttIfQWBPMg05KAKeO26l3UXe+kxV2CxWKej7z9sE1LeCfY3EGQq4/xwm0z9IRvkJUO7YwkJKLXY0MOcVkGcC7wStwFTSfW0mlgyCiDVa0KzS3EXoW3wRrlco8IG1qk9lADZl0PYm2l/BDXMzdeKt5csId7H9j3oUV849hFWxuN4a8cFCb3XpK0LXm0XBtvk2RW2s0fO33l4+Bez6hBBzrS2usa2jjh0Vn4k6g7bK73nzHOZYgLcaa3JiEata0vFdmyV3wTWnDe3+LWbsBJsBwxoK7ZWd2T2HOoc4ZQeWrYTAoEfcEV5dj+rvTE7vbTHBJ7d9iGfaHTjgCkEM8e/iMYnF7BBqduSkC0IdvEt+MbJEO8xzyZZyces4cd3X0jzFPvVNpcwLDjDrv9eOvsyvTBVVGK66EXEuaD0YLXuOWeFzq3oL2aXGiTDvUSbJ+Ltz3R3+1lLYqHZEBN0/akV6b59vAQBZ/Ks6YZOQHT8m9bjrKULPxBs5mS/BOpFV73vREH1CS+yG8MyR5GNPK0XLOSO5AUf1ExG2N7VNM6E+MU6gT+HoQVdeZcT9MGh9udTySUcOjS9hgMLfJMLraAXmI9htrNHzt95ePgXs+oQQc60trrGto44dFZ8zqbwpmWa8IyMAAWnl4iPM+F9+VNHlcz0waZWk5d3ocrOgSQ0Fzflca1WxiZ1a0z33/rTYqQrmLD1SgAMgvGuiISKiq4yvoHcgBVMDdOYV885IvsRSnt/S1YYITyzRwv8PXXpOa/Fh/Q7T6v45cktLrI9wc9lbzgfXd9laqdREDOshaHYP8Oq6k+cVXJiV2yKAmeNHH6+w6smuV2dvtSXe3qoKEABErJR3pIpfKdzS69erj3a0zo33JWZdIpsvRZaWNVn+1ZIH9PsVwWO8HYvt3ZEXJ7Lu3fQcgsBTfrdTaNMDc2VmnBkfAbp69GdgrnB2KKkVRLfrryi92D5HvdyUuh1PwBdAsM0=",
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,PostURL,||,
,Goto,findnextString,

nextcheck,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipBelowParams,

,SetPostURLData,"UsePrinterFriendlyVersion"|"Off",
,SetPostURLData,"M$L$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$L$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,Goto,postLogin,

skipBelowParams,SetPostURLData,"M$layout$content$PCDZ$MDSUI6N$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MDSUI6N$ctl00$webInputForm$cmdContinue"|"1"|,

postLogin,PostURL,||,

,FindSignature,"Enter your password",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:b7585254-495e-4311-9545-1f910247aca5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$fldCaptureFingerprint"|"",
,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$fldPublicKeyCustom"|"",
,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$fldDeviceIdCustom"|"",

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,myoccuPosting,

,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$cmdContinue"|"1"|,

,PostURL,"https://firstcommandbank.onlinebank.com/AOP/Password.aspx"||,

,Goto,skipremindme,

myoccuPosting,SetPostURLData,"M$L$content$PCDZ$MF3KFEF$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$L$content$PCDZ$MF3KFEF$ctl00$webInputForm$cmdContinue"|"1"|,

,PostURL,"https://myoccu.onlinebank.com/AOP/Password.aspx"||,

,Goto,skipremindme,

//////////********************************* END -Login Posting for FI ID 5343 *******************************

Skip_firstcommandbankpost,FindSignature,">Internet Banking - System Maintenance in Progress<",

,If-TRUE-Goto,errorRetry,

,AddCookie,"OGOCW"|"esQR/l1SJmokp/yVwz8kHOGSHV02rX3wU3Opgka7zmFPNeFSNZxRWMJpWw+eVLx25MQTBU3rgjCZ"|"www.coastal24.com"|"/",
@NOCOOKIE, NOP,

,FindString,""LoginName""|test,
,If-FALSE-Goto,skipnewpost,

,MoveToTag,"form"|"REV",

,GetDataFromTag,postURL||"action",

,Compare,postURL|"/",
,If-FALSE-Goto,skipExtract,

,ExtractFromRawPage,postURL|"form action[=]["]##KEEP##["]"|test,   //"

skipExtract,SetPostURLData,"LoginName"|userid,

,PostURL,postURL||,

,Goto,continuepawd,

skipnewpost,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,

,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-FALSE-Goto,PostwithOutPass,

,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password|,

PostwithOutPass,PostURL,||,

findnextString,FindSignature,">Remember Device<",
,If-TRUE-Goto,remembermePosting,
                                                                                                  
,FindSignature,"I accept the terms of this agreement",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Email Address Required",
,If-TRUE-Goto,Useraction_108,
                                                                                                  
,FindSignature,"We were unable to validate your information",
,If-TRUE-Goto,Error103,

,FindSignature,"We're sorry##COMMA## we are unable to process your log in for Internet Banking",
,If-TRUE-Goto,Error103, 
                                                                                  
,FindSignature,"Online and mobile banking are currently unavailable.",
,If-TRUE-Goto,error102,

,FindSignature,"You have entered an incorrect password too many times.",
,If-TRUE-Goto,Error103,

,FindSignature,">Remember this device<",
,If-TRUE-Goto,remembermePosting,  

,FindSignature,"For security reasons##COMMA## we were unable to log you in",
,If-TRUE-Goto,Error103,
     
,FindSignature,"We do not recognize your username and/or password",
,If-TRUE-Goto,Error103,

,FindSignature,"You have entered an invalid User ID and/or Password",
,If-TRUE-Goto,Error103, 

,FindSignature,"User Verification",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"To help us verify your identity##COMMA## please answer the following questions.",
,If-TRUE-Goto,Useraction_108,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipcheck1,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipcheck1,
                                                                                                  
,FindSignature,"No accounts to be displayed.",
,If-TRUE-Goto,error914,
                                                                                                  
skipcheck1,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipTower,

,FindString,">Password"|test,
,If-TRUE-Goto,moveToInput,

,FindString,"aop_password_fields"|test,
,If-TRUE-Goto,moveToInput,

,Goto,GO_centerstatebank_passpost1,

skipTower,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",
,If-FALSE-Goto,nexttower,

,FindString,"aop_password_fields"|test,
,If-FALSE-Goto,GO_centerstatebank_passpost1,

moveToInput,MoveToTag,"input",
,GetDataFromTag,passwordpost||"name",

,MoveToTag,"input",
,GetDataFromTag,commandpost||"name",

//,FindReplace,"_"|"$"|passwordpost|test,

,Compare,passwordpost|"M$layout$content$PCDZ$MF3KFEF$ctl00$webInputForm$txtPassword",
,If-TRUE-Goto,GO_centerstatebank_passpost,

,Compare,passwordpost|"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword",
,If-TRUE-Goto,GO_centerstatebank_passpost,

nexttower,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-FALSE-Goto,skipConvertUsr,

,FindSignature,"ConvertedUserVerification",
,If-FALSE-Goto,SKIPSAVEOPTION,   
,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc",
,SetPostURLData,"M$layout$content$PCDZ$MXGL1GA$ctl00$validationControl$ctl04"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MXGL1GA$ctl00$validationControl$cmdSubmit"|"1",
,PostURL,"https://weokie.e-creditunion.org/ConvertedUserVerification.aspx"||,

,Goto,SKIPSAVEOPTION,


skipConvertUsr,Goto,continuepawd,

newpost,NOP,
,FindString,"Routing Number:"|test,
,If-FALSE-Goto,GotoNormalflow,
,MoveToTag,"div"|"REV"|test,
,If-FALSE-Goto,GotoNormalflow,
,GetDataAfterString,RoutingNum|":"|" "|test,
,RemoveHTMLTags,RoutingNum,
,RemoveExtraWhitespaces,RoutingNum,

GotoNormalflow,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"M_layout_content_ScriptManager_TSM["] value=["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"

,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SKIP_centerstatebank_newpost,

GOTO_centerstatebank_newpost,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"en-US"|"en"|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,PostURL,||,

,Goto,continuepawd,


SKIP_centerstatebank_newpost,Compare,M_layout_content_ScriptManager_TSM|"",
,If-FALSE-Goto,ContinuePost,

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"

ContinuePost,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,

,SetPostURLData,"__LASTFOCUS"|"",

,SetPostURLData,"__EVENTTARGET"|"",

,SetPostURLData,"__EVENTARGUMENT"|"",

,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,

,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,

,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

SkipUBTPosting,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtLoginName"|userid,
         
,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword"|password,

,SetPostURLData,"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$cmdContinue"|"1"|,

GetUBTPosting,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded; charset=UTF-8",

,PostURL,||,

Check_These,FindSignature,"Youve entered an invalid User ID and Password combination or your account access is locked",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Account access is unavailable at this time",
,If-TRUE-Goto,errorLogon2,
,FindSignature,">Your access has been locked out or disabled",
,If-TRUE-Goto,errorLogon2,
,FindSignature,">Incorrect username or password entered.",
,If-TRUE-Goto,errorLogon1,
,FindSignature,"You have entered an invalid User ID or Password",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Your Account is currently Locked Out",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"entered an invalid User ID/Password or your account access is restricted",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"your account access is locked",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Youve entered an invalid User ID/Password",
,If-TRUE-Goto,errorLogon,
,FindSignature,"You have entered an incorrect User ID or Password.",
,If-TRUE-Goto,errorLogon,
,FindSignature,"You've entered an invalid User Id/Password.",
,If-TRUE-Goto,errorLogon,
,FindSignature,"Your Account is Locked",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"We are unable to retrieve your account information at this time.",
,If-TRUE-Goto,errorLogon,
,FindSignature,"Your Account requires attention to establish access",
,If-TRUE-Goto,errorLogon,
,FindSignature,"You have exceeded the number of password attempts.",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"has banned you temporarily from accessing this website",
,If-TRUE-Goto,Error927,

,FindSignature,"We're sorry##COMMA## we are unable to process your log in for Online Account Access",
,If-TRUE-Goto,errorLogon,
,FindSignature,"We're sorry##COMMA## we are unable to process your log in for Online Banking",
,If-TRUE-Goto,errorLogon,                                                                                                  

,FindSignature,"2020 Tax Statements Are Available",
,If-TRUE-Goto,UseractionPosting,

,FindSignature,"recently made a couple changes to improve your experience.<",
,If-FALSE-Goto,skipThisNotNowPosting,

UseractionPosting,SetPostURLData,"M$layout$content$PCDZ$M92YCNQ$ctl00$ctl00$btnYes"|"1"|,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"T",  

,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"T",

,PostURL,"./Interstitial.aspx"||,


skipThisNotNowPosting,FindSignature,"Take me to my accounts",
,If-FALSE-Goto,skipTakeMeAccountsPosting,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"
                                                                                                  
,MoveToTopOfPage,,
,MoveToTag,"form"|test,
,GetDataFromTag,btnURL||"action",

,FindString,"Take me to my accounts"|test,
,MoveToTag,"input"|"REV"|test,
,GetDataFromTag,__EVENTTARGET||"name",

,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__VIEWSTATE"|"",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,__EVENTTARGET|"1",
,PostURL,btnURL||,

skipTakeMeAccountsPosting,FindSignature,">Go Mobile!<",
,If-TRUE-Goto,Useraction_108,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,GoForAskLater,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-FALSE-Goto,SkpGoForMFALayout,   

GoForAskLater,FindSignature,"Ask me my security questions",
,If-FALSE-Goto,SkpGoForMFALayout,

,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"
,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,

,MoveToTag,"option",
,GetDataFromTag,OptionValue111||"value",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:669ca791-a838-4419-82bc-9fa647338708:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl2$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|OptionValue111,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|OptionValue111,
,PostURL,||0,


,Goto,skipMFA,

SkpGoForMFALayout,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,remembermePosting,

,FindSignature,"unrecognized device or browser",
,If-FALSE-Goto,SKIPSAVEOPTION,   

,SetPostURLData,"M$layout$content$PCDZ$M4HNZU6$ctl00$webInputForm$btnCancel"|"1",
,Goto,JUMPPOST,


SKIPSAVEOPTION,FindSignature,"dashboard.aspx",
,If-TRUE-Goto,remembermePosting,

,FindSignature,"Send me a text message",
,If-TRUE-Goto,FINDSTRNG,
,FindSignature,"We will send you a text message with a confirmation code",
,If-TRUE-Goto,FINDSTRNG12,
,FindSignature,"Youve entered an invalid User ID/Password or your account access is restricted",
,If-TRUE-Goto,errorLogon2, 
,FindSignature,"You have entered an invalid User ID and/or Password",
,If-TRUE-Goto,errorLogon1,
,FindSignature,"You have entered an incorrect UserID/Password.",
,If-TRUE-Goto,errorLogon2,                                                                                                
,FindSignature,"For security reasons##COMMA## we were unable to log you in.",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Were sorry##COMMA## we are unable to log you in. Please try again",
,If-TRUE-Goto,errorLogon,
,FindSignature,"Select your Security Questions and enter your Secret Answers",
,If-TRUE-Goto,askMeLaterPosting1,
,FindSignature,"New Security Features",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Reset your Security Profile",
,If-FALSE-Goto,SkipAskmeAgain,

askMeLaterPosting1,FindSignature,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,If-FALSE-Goto,Useraction_108,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"1",
,ClickBodyButton,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"Ask me again later",
,PostURL,||,

SkipAskmeAgain,NOP,,


remembermePosting,FindSignature,">Remember this device<",
,If-TRUE-Goto,SkipSignature,
                                                                                                  
,FindSignature,">Remember Device<",
,If-FALSE-Goto,SkpThisOption,

SkipSignature,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc",
,SetPostURLData,"M$layout$content$PCDZ$M4HNZU6$ctl00$webInputForm$btnSave"|"1",

JUMPPOST,PostURL,||,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkpThsMFA,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkpThsMFA,                                                                                                  

,GetURL,"/PostLogin.aspx"|,
,GetURL,"/Interstitial.aspx"|,
,GetURL,"/Default.aspx"|,


,PostURL,||0,

SkpThisOption,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthlayout,  

,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-TRUE-Goto,allsouthlayout,                                                                                                  
,Goto,check,


continuepawd,FindSignature,"Digital Banking will be unavailable for the  duration",

,If-TRUE-Goto,errorRetry,

,FindSignature,"Please be aware that we are currently experiencing system issues",
,If-TRUE-Goto,errorRetry,

,FindSignature,"Select your Security Questions and enter your Secret Answers",
,If-TRUE-Goto,askMeLaterPosting,
                                                                                                  
,FindSignature,"Setup your Security Profile",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Reset your Security Profile",
,If-FALSE-Goto,SkipLaterPost, 

askMeLaterPosting,FindSignature,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,If-FALSE-Goto,Useraction_108,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"1",

,ClickBodyButton,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"Ask me again later",
,PostURL,||,
                                                                                                  
,FindSignature,">Access Denied<",
,If-TRUE-Goto,errorLogon2,

SkipLaterPost,FindSignature,">Remember Device<",
,If-TRUE-Goto,remembermePosting,

,FindSignature,"Go to Accounts",
,If-FALSE-Goto,skipGoToAccounts,

,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|0,
,SetPostURLData,"M$layout$content$PCDZ$M92YCNQ$ctl00$ctl00$btnYes"|"1"|0,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|0,
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|0,
,PostURLr,||0|##URL##,

skipGoToAccounts,FindSignature,"Youve entered an invalid User ID and Password combination or your account access is locked",
,If-TRUE-Goto,errorLogon2,                                                                                                 
,FindSignature,"Your Account is currently Locked Out",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"You have entered an invalid User ID and/or Password.",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Your account is currently locked",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"The User ID/Password youve entered is invalid",
,If-TRUE-Goto,errorLogon2,
                                                                                                  
,FindSignature,"You have entered an incorrect UserID/Password.",
,If-TRUE-Goto,errorLogon2,
                                 
,FindSignature,"Your account is locked",
,If-TRUE-Goto,errorLogon2,
                                                                                                  
,FindSignature,"Your profile has been locked",
,If-TRUE-Goto,errorLogon2,                                                                                                                                                                                                                                        
,FindSignature,"Access Declined",
,If-TRUE-Goto,Error927,

,FindSignature,"is this still your correct contact information?",
,If-TRUE-Goto,Useraction_108,    

,FindSignature,"User Verification",
,If-TRUE-Goto,Useraction_108,  
                                                                  
,FindSignature,"Your Account requires attention to establish access",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Youve entered an invalid User ID and Password combination or your account access is locked.",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"We are unable to begin your session",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"entered an invalid User ID/Password or your account access is restricted",
,If-TRUE-Goto,errorLogon2,                                                                         

,FindSignature,"For your security##COMMA## your account has been locked due to multiple failed login attempts",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"The username and password you've entered is not valid",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Send me a text message",
,If-TRUE-Goto,FINDSTRNG, 

,FindSignature,"we need to verify your identity before you can proceed",
,If-TRUE-Goto,FINDSTRNG,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,firstcommbankposting,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,NOrmal_Posting1,

,Assign,posturl|"https://myoccu.onlinebank.com",
,AppendVars,posturl|"/AOP/Password.aspx",

,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,
,SetPostURLData,"M$L$content$PCDZ$MF3KFEF$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc",
,SetPostURLData,"M$L$content$PCDZ$MF3KFEF$ctl00$webInputForm$cmdContinue"|"1",
,PostURL,||,
,Goto,check,

NOrmal_Posting1,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-FALSE-Goto,SkpThsPst,

,Assign,posturl|"https://secure.mapscu.com/AOP/Password.aspx",

,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,
,SetPostURLData,"M$layout$content$PCDZ$MZ7HMSJ$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc",
,SetPostURLData,"M$layout$content$PCDZ$MZ7HMSJ$ctl00$webInputForm$cmdContinue"|"1",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MZ7HMSJ$ctl00$webInputForm$cmdContinue",

,PostURL,||,
,Goto,check,

firstcommbankposting,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$M61KM83$ctl00$webInputForm$cmdContinue"|"1",
,PostURL,||,
,Goto,check,
                                                                         
SkpThsPst,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GO_centerstatebank_passpost,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-FALSE-Goto,SKIP_centerstatebank_passpost,

GO_centerstatebank_passpost1,Assign,passwordpost|"M$layout$content$PCDZ$MMCA7G7$ctl00$webInputForm$txtPassword",

GO_centerstatebank_passpost,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"en-US"|"en"|M_layout_content_ScriptManager_TSM|test,

,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,

,SetPostURLData,passwordpost|password,
,SetPostURLData,commandpost|"1",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,PostURL,||,
,ExtractFromRawPage,userName|"instUserId = '##KEEP##'"|test,
,Goto,goforward_centerstatebank,


SKIP_centerstatebank_passpost,ExtractFromRawPage,viewstateid|"["]__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,eventvalidation|"["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:d28568d3-e53e-4706-928f-3765912b66ca:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|viewstateid,
,SetPostURLData,"__EVENTVALIDATION"|eventvalidation,

,SetPostURLData,"M$layout$content$PCDZ$MF3KFEF$ctl00$webInputForm$txtPassword"|password,
,SetPostURLData,"M$layout$content$PCDZ$MF3KFEF$ctl00$webInputForm$cmdContinue"|"1",
,SetPostURLData,"__EVENTTARGET"|"",
,PostURL,||,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipcheck2,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipcheck2,
                                                                                                  
,FindSignature,"No accounts to be displayed.",
,If-TRUE-Goto,error914,
                                                                                                  
skipcheck2,FindSignature,"entered an invalid User ID/Password or your account access is restricted",
,If-TRUE-Goto,errorLogon2, 

,FindSignature,"We're sorry##COMMA## we are unable to process your log in for Internet Banking.",
,If-TRUE-Goto,errorLogon, 

,FindSignature,"Please Change Your Password",
,If-TRUE-Goto,Error109, 

,FindSignature,"Setup your Security Profile",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Please update your email address.",
,If-TRUE-Goto,Useraction_108, 
,FindSignature,"Access Declined",
,If-TRUE-Goto,errorLogon2, 
,FindSignature,"SunState Spring Auto",
,If-FALSE-Goto,CheckNXT1,

,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|0,
,SetPostURLData,"M$layout$content$PCDZ$M92YCNQ$ctl00$ctl00$btnYes"|"1"|0,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|0,
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|0,
,PostURLr,||0|##URL##,

CheckNXT1,FindSignature,"Reset your Security Profile - CFCU",
,If-FALSE-Goto,CheckNXT,

goforward_centerstatebank,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",
,If-FALSE-Goto,SkipRememberDevice,

,FindSignature,">Remember Device<",
,If-FALSE-Goto,SkipRememberDevice,

,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts,
,SetPostURLData,"M$layout$content$PCDZ$M4HNZU6$ctl00$webInputForm$btnSave"|"1",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,

,PostURL,"https://ib.sdccu.com/SDCCU/RememberDevice.aspx"||,

SkipRememberDevice,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-FALSE-Goto,check,
                                                                         
,FindSignature,"Reset your Security Profile - CFCU",
,If-FALSE-Goto,CheckNXT,

,ClickBodyButton,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"Ask me again later",
,PostURL,||,                                                                        
                                                                         
CheckNXT,Compare,##TOWER_WEBSITE##|"https://oceanbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,check,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,check,

//*********************************************************************
,Compare,institutionId|"10771",
,If-FALSE-Goto,skip_FR_FCU,

,FindSignature,">remember this device<",
,If-FALSE-Goto,skip_FR_FCU,

,FindString,"Device Name<"|test,
,If-FALSE-Goto,skip_FR_FCU,
 
,MoveToTag,"input",
,GetDataFromTag,deviceName||"value",


,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,CreateForm,"Form1"|"https://secure.myvirtualbranch.com/FinancialResourcesFCU/DeviceManagement.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|"Form1",
,SetPostURLData,"__EVENTTARGET"|""|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MHB47I1$ctl00$webInputForm$txtNickname"|deviceName|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MHB47I1$ctl00$webInputForm$btnCommit"|"Remember This Device"|"Form1",

,PostURL,||"Form1",


skip_FR_FCU,NOP,,
//*********************************************************************

,FindSignature,"Account Summary",
,If-TRUE-Goto,check,

,FindSignature,"Accounts Summary",
,If-TRUE-Goto,check,

,FindSignature,"Accounts/AccountSummary", 
,If-TRUE-Goto,check,
                                                                       
,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,check,                                                                                                  

,FindSignature,"Send me a text message",
,If-TRUE-Goto,FINDSTRNG,                                                                                                                                                                                                       

,GetURLv2,"/Home.aspx"|,

check,FindSignature,"Your account access is locked.",
,If-TRUE-Goto,errorLogon2,
                                                                                                  
,FindSignature,"Your account has been locked.",
,If-TRUE-Goto,errorLogon2,
                                                                                              
,FindSignature,">Your online banking access is now locked",
,If-TRUE-Goto,errorLogon2,

,FindSignature,">You've entered an invalid Username or Password",
,If-TRUE-Goto,errorLogon1,                                                                                                  
                                                                                                  
,FindSignature,"Youve entered an invalid UserID or Password##COMMA## or your account is restricted",
,If-TRUE-Goto,errorLogon2,                                                                                                  
                                                                                                  
                                                                                                                                                                                                   
,FindSignature,"Take Me to Virtual Tours",
,If-FALSE-Goto,skipremindme, 

,ClickBodyButton,"M_M_layout_C_PCDZ_M92YCNQ_ctl00_ctl00_btnRemindMeLater"|"",
,PostURL,||,

skipremindme,FindSignature,"and for your safety your account has been locked.",
,If-TRUE-Goto,errorLogon2, 
                                                                                                                                               
,FindSignature,"Invalid username or password.",
,If-TRUE-Goto,errorLogon1, 
                                                                         
,FindSignature,"Your account is restricted. Please contact member service.",
,If-TRUE-Goto,errorLogon2,                                                                         
,FindSignature,"Youve entered an invalid User ID and Password combination or your account access is locked",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"Your account access has been restricted.",
,If-TRUE-Goto,errorLogon2,                                                                                                                                           

,FindSignature,"Youve entered an invalid User Id/Password and your account is locked",
,If-TRUE-Goto,errorLogon2,       
                                                                                                  
,FindSignature,"Your account is locked. Please contact member service.",
,If-TRUE-Goto,errorLogon2,                                                                            

,FindSignature,">We do not recognize your User ID and/or Password",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Your account has been locked for your security.",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Due to too many invalid password attempts##COMMA## your online access has been locked",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Your account is locked.",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"GV Electronic Delivery",
,If-FALSE-Goto,skipContinue,
,FindString,"value="Skip"",

,MoveToTag,"input"|"REV",
,GetDataFromTag,eventTarget||"name",

,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,CreateForm,"Form1"|##URL##,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|"Form1",
,SetPostURLData,"__EVENTTARGET"|eventTarget|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MMCWIHT$ctl00$ctl00$webInputForm$grpIndividualEnroll$dgAccounts$ctl02$ddlPrefs"|"Print"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MMCWIHT$ctl00$ctl00$webInputForm$grpIndividualEnroll$dgAccounts$ctl03$ddlPrefs"|"Online"|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form1",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form1",
,PostURL,||"Form1",

skipContinue,FindSignature,"we are unable to process your log in for Internet Banking",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"we are unable to process your login for Online Banking",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"For security reasons##COMMA## we were unable to log you in",
,If-TRUE-Goto,errorLogon2,
,FindSignature,"To help us verify your identity##COMMA## please answer the following questions.",
,If-FALSE-Goto,SkpThsuserStr,

,FindSignature,""accounts":",
,If-TRUE-Goto,SkpThsStr,
,Goto,Useraction_108,

SkpThsuserStr,FindSignature,">Contact Info Disclosure<",
,If-TRUE-Goto,Useraction_108,
,FindSignature,"entered an invalid User ID/Password.",
,If-TRUE-Goto,errorLogon,
,FindSignature,"Youve entered an invalid User ID/Password",
,If-TRUE-Goto,errorLogon,
,FindSignature,"Either that User ID or password doesn't match our records. Please try again.",
,If-TRUE-Goto,errorLogon,
 ,FindSignature,"Youve entered an invalid User ID and Password combination or your account access is locked",
,If-TRUE-Goto,errorLogon2,                                                                        
,FindSignature,"Youve entered an invalid user ID or password.",
,If-TRUE-Goto,errorLogon,                                                                         

,FindSignature,"Password Change Required",
,If-TRUE-Goto,Error109,

,FindSignature,"PLEASE READ THIS AGREEMENT CAREFULLY",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Online Access for your credit card will be unavailable",
,If-TRUE-Goto,Useraction_108,                                                                                                  

,FindSignature,"ONLINE AND MOBILE BANKING AGREEMENT AND DISCLOSURE",
,If-TRUE-Goto,Useraction_108,                                                                                                  
,FindSignature,"Please enter your User ID##COMMA## Last 4 Digits of your Social Security Number",
,If-TRUE-Goto,Useraction_108,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/mycommunitysavings/signin.aspx", 
,If-TRUE-Goto,Error900,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/AbingtonBank/SignIn.aspx", 
,If-TRUE-Goto,Error900,

,Compare,##TOWER_WEBSITE##|"https://creditunion1.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipUserDetails,

,FindSignature,"User ID##COMMA## Email##COMMA## Address##COMMA##ZIP Code##COMMA##and Social Security Number",
,If-FALSE-Goto,skipUserDetails,

,FindString,"User ID##COMMA## Email##COMMA## Address##COMMA##ZIP Code##COMMA##and Social Security Number"|test,

,FindString,">User Name<",
,If-FALSE-Goto,skipUserName,

,AddQuestion,answer1|"User Name",
,WaitForAnswers,

skipUserName,FindString,">Last Name<",
,If-FALSE-Goto,skipLastName,

,AddQuestion,answer2|"Last Name",
,WaitForAnswers,

skipLastName,FindString,">Email Address<",
,If-FALSE-Goto,skipEmailAdd,

,AddQuestion,answer3|"Email Address",
,WaitForAnswers,

skipEmailAdd,FindString,">ZIP Code<",
,If-FALSE-Goto,skipZIPCode,

,AddQuestion,answer4|"ZIP Code",
,WaitForAnswers,

skipZIPCode,FindString,">Social Security Number<",
,If-FALSE-Goto,skipUserDetails,

,AddQuestion,answer5|"Social Security Number",
,WaitForAnswers,

,ExtractFromRawPage,ScriptManager_TSM|"M_layout_content_ScriptManager_TSM["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|ScriptManager_TSM,
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__VIEWSTATE"|"",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$ctl04"|answer1,
,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$ctl09"|answer2,
,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$fldEmail"|answer3,
,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$ctl15"|answer4,
,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$fldSSN"|answer5,
,SetPostURLData,"M$layout$content$PCDZ$M5223YO$ctl00$validationControl$cmdSubmit"|"1",

,PostURL,"https://creditunion1.onlinebank.com/UserVerification.aspx"||,

,FindSignature,">We were unable to validate your information. Ensure the information you have entered is accurate.<",
,If-TRUE-Goto,errorMFA,

skipUserDetails,NOP,,

,FindSignature,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,If-FALSE-Goto,SkipThisAskLater,

,ClickBodyButton,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"Ask me again later",
,PostURL,||,

,FindSignature,"You have attempted to access a page for which you do not have the appropriate credentials.",
,If-TRUE-Goto,errorLogon,

SkipThisAskLater,FindSignature,">Click Save if you dont want to receive an alert when you log in from this device again.<",
,If-FALSE-Goto,SkipDeviceRegister 

,ClickBodyButton,"M$layout$content$PCDZ$M4HNZU6$ctl00$webInputForm$btnSave"|"Save"
,PostURL,||,

SkipDeviceRegister,FindSignature,">User Verification<",
,If-TRUE-Goto,Useraction_108  

,FindSignature,">ELECTRONIC BANKING ACCESS AGREEMENT<",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Access Declined",
,If-TRUE-Goto,errorLogon,

,FindSignature,"You entered an invalid Userid/Password or your account is restricted.",
,If-TRUE-Goto,errorLogon,

,FindSignature,">Youve entered an invalid user Id/Password.",
,If-TRUE-Goto,errorLogon,

,FindSignature,">You've entered an invalid User ID and/or password",
,If-TRUE-Goto,errorLogon,

,FindSignature,">You've entered an invalid Username or Password",
,If-TRUE-Goto,errorLogon1,

,FindSignature,"The information you entered does not match our records.",
,If-TRUE-Goto,errorLogon,

,FindSignature,"You've entered an invalid User ID or Password. Please try again.",
,If-TRUE-Goto,errorLogon1,

,FindSignature,"Your account access is restricted",
,If-TRUE-Goto,errorLogon,

,FindSignature,"Secret Answers to the following Security Questions",
,If-TRUE-Goto,FINDSTRNG1,

,FindSignature,"we need to verify your identity before you can proceed",
,If-TRUE-Goto,FINDSTRNG,

,FindSignature,"Accounts Summary",
,If-TRUE-Goto,skipMFA,

,FindSignature,"Account Summary",
,If-TRUE-Goto,skipMFA,

,FindSignature,"entered an invalid Login ID/Password",
,If-TRUE-Goto,errorLogon,

,FindSignature,"The User ID and/or Password does not match our records",
,If-TRUE-Goto,errorLogon,

,FindSignature,"You've entered an invalid User ID/Password",
,If-TRUE-Goto,errorLogon,

,FindSignature,"entered an invalid User ID/Password or your account access is restricted.",
,If-TRUE-Goto,errorLogon,

,FindSignature,"Setup Profile",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"Reset your Security Profile",
,If-FALSE-Goto,SKPUserActionPost,

,FindSignature,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater",
,If-FALSE-Goto,SKPUserActionPost,

,ClickBodyButton,"M$layout$content$PCDZ$MGVNJRK$ctl00$ctl02$cmdAskLater"|"1",

SKPUserActionPost,FindSignature,"Reset your Security Profile",
,If-TRUE-Goto,Useraction_108,
                                                                                                                                                 
,FindSignature,"Email Address Required",
,If-TRUE-Goto,Useraction_108,

,FindSignature,"g-recaptcha",
,If-TRUE-Goto,Error924,
//*************************

//    MFA Section

//*************************


,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,skipMFA11,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,FINDSTRNG,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,FINDSTRNG,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,FINDSTRNG,

,FindString,"Additional Authentication Required"|test,
,If-FALSE-Goto,skipMFA11,

FINDSTRNG,FindSignature,"./Home.aspx",
,If-TRUE-Goto,skipMFA,

,FindSignature,"./Default.aspx",
,If-TRUE-Goto,skipMFA,

,FindSignature,"Send me a text message",
,If-TRUE-Goto,FINDSTRNG12,

,FindSignature,"we need to verify your identity before you can proceed",
,If-FALSE-Goto,FINDSTRNG1,
,Goto,NewEmailSection,

FINDSTRNG12,Assign,setcount|0,
,Assign,getcount|0,

,Assign,OTPchoice|"How would you like to receive confirmation code",

,AddAttendedQuestion,Answer|OTPchoice,

,AddAnswerChoice,"Text"|"We will send you a text message with a confirmation code"|,
,AddAnswerChoice,"Call"|"We will call you and provide a confirmation code"|,

,FindSignature,"Email Verification",
,If-FALSE-Goto,skipEmail,

,AddAnswerChoice,"Email"|"We will send you a file with a confirmation code"|,

skipEmail,WaitForAnswers,,

,SetReturnData,Answer|Answer|1,

,Compare,Answer|"Email",
,If-TRUE-Goto,NewEmailSection,

,Compare,Answer|"Text",
,If-TRUE-Goto,getstring,

,Compare,Answer|"Call",
,If-FALSE-Goto,errorMFA,
,Goto,getstring2,

//***********************************
getstring,FindString,"We will call you"|test,
,Assign,setcount|0,
//***********************************

,Assign, Ph-No-choice|"Select where would you like to receive confirmation code"|
,AddAttendedQuestion,Answer1|Ph-No-choice,

getOTPvalBACK,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,GetAns,

,GetDataFromTag,OTPoption|Ph-No|"value",
,AddAnswerChoice,OTPoption|Ph-No|,
,Add,setcount|1,

,SetReturnData,OTPoption|OTPoption|setcount,
,Goto,getOTPvalBACK,

//***********************************
getstring2,FindString,"We will call you",
,Assign,setcount|0,
//***********************************
,Assign, Ph-No-choice|"Select where would you like to receive confirmation code"|
,AddAttendedQuestion,Answer1|Ph-No-choice,

getOTPval,MoveToTag,"option"|test,
,If-FALSE-Goto,GetAns,

,GetDataFromTag,OTPoption|Ph-No|"value",
,AddAnswerChoice,OTPoption|Ph-No|,
,Add,setcount|1,

,SetReturnData,OTPoption|OTPoption|setcount,
,Goto,getOTPval,
//***********************************
GetAns,WaitForAnswers,,

nextVAl,Compare,setcount|getcount,
,If-TRUE-Goto,errorMFA,

,Add,getcount|1,

,GetReturnData,OTPoption|OTPoption|getcount,

,Compare,Answer1|"",
,If-TRUE-Goto,errorMFA,

,Compare,Answer1|OTPoption,
,If-FALSE-Goto,nextVAl,
//*********************************** OTP Postings ***********************************

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,//"

,GetReturnData,Answer|Answer|1,

,Compare,Answer|"Text",
,If-TRUE-Goto,textPosting,

,Compare,Answer|"Call",
,If-TRUE-Goto,CallPosting,

//********************* SMS Text Layout **********************
textPosting,NOP,

SKP_Layout,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-FALSE-Goto,SkpThsLayoutlfcu,

,SetPostURLData,"M$layout$content$PCDZ$MCY8ACL$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MCY8ACL$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MCY8ACL$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$MCY8ACL$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MCY8ACL$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||0,
,Goto,SKP_Layout1,

SkpThsLayoutlfcu,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fairfieldfederal/signin.aspx",
,If-FALSE-Goto,SkpFairfield,

,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||0,
,Goto,SKP_Layout1,

SkpFairfield,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkpFirstCommandBank,

,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||0,
,Goto,SKP_Layout1,

SkpFirstCommandBank,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-FALSE-Goto,SkpThsLayoutSouthwest,

,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||0,
,Goto,SKP_Layout1,
                                                                         
SkpThsLayoutSouthwest,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-FALSE-Goto,SkpThsLayout2269,

,SetPostURLData,"M$layout$content$PCDZ$MXBHDXT$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MXBHDXT$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MXBHDXT$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$MXBHDXT$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MXBHDXT$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||0,
,Goto,SKP_Layout1,

SkpThsLayout2269,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",         // FI ID: 100368
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",         // FI ID: 4231
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",         // FI ID: 11142
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",         // FI ID: 7112
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx", // FI ID: 4231
,If-TRUE-Goto,Taketheseposting,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkpThsLayout,

Taketheseposting,NOP,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||,


,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||,
,Goto,SKP_Layout1,


SkpThsLayout,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-FALSE-Goto,SKP_mapscu,

,SetPostURLData,"M$layout$content$PCDZ$MU7CD3S$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MU7CD3S$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MU7CD3S$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,"https://secure.mapscu.com/AOP/Password.aspx"||,

SKP_mapscu,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-FALSE-Goto,SKP_cpfcu,

,SetPostURLData,"M$layout$content$PCDZ$MGJ8GU2$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MGJ8GU2$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MGJ8GU2$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-FALSE-Goto,SKP_cpfcu1234,

,SetPostURLData,"M$layout$content$PCDZ$MGJ8GU2$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MGJ8GU2$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||,

,Goto,SKP_Layout1,

SKP_cpfcu1234,SetPostURLData,"M$layout$content$PCDZ$MU7CD3S$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MU7CD3S$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2,

,PostURL,||,
,Goto,SKP_Layout1,


SKP_cpfcu,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,


,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,
,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,
,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,
,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,                                                                                                                                                                                          

,Compare,##TOWER_WEBSITE##|"https://creditunion1.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,
,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,  

,Compare,##TOWER_WEBSITE##|"https://bossierfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,DNT_SKP_gatecity, 

,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_weokie, 

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity, 

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,institutionId|"7398",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,institutionId|"5420",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,institutionId|"5343",
,If-TRUE-Goto,DNT_SKP_gatecity,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GotofalconbankOTPPosting, 

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-FALSE-Goto,SKP_gatecity,

DNT_SKP_gatecity,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1|0,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1|0,
,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|0,

,Goto,JUMPFORPOST,

DNT_SKP_weokie,SetPostURLData,"M$layout$content$PCDZ$M93YPN8$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$M93YPN8$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1|0,
,SetPostURLData,"M$layout$content$PCDZ$M93YPN8$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1|0,
,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$M93YPN8$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$M93YPN8$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|0,

,Goto,JUMPFORPOST,

//*****************************************************

GotofalconbankOTPPosting,SetBodySelectParameter,"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_lstPhoneNumbers"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"1",				      
,SetBodySelectParameter,"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_lstPhoneNumbers"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetBodySelectParameter,"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl1_lstPhoneNumbers"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,
,ClickBodyButton,"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_btnSelectMethod"|"aspnetForm",


,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetParameter,"input"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpSms_btnSubmitSm",
,SetParameter,"input"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|"M_layout_content_PCDZ_M24R5FN_ctl00_ctl00_webInputForm_grpSms_txtSecurityCode",

,ClickBodyButton,"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|0,

,Goto,SKP_Layout1,

//*****************************************************

NewDNT_SKP_gatecity,SetPostURLData,"M$layout$content$PCDZ$M1D7WMQ$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$M1D7WMQ$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1|0,
,SetPostURLData,"M$layout$content$PCDZ$M1D7WMQ$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1|0,
,PostURL,||0,

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetPostURLData,"M$layout$content$PCDZ$M1D7WMQ$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|0,
,SetPostURLData,"M$layout$content$PCDZ$M1D7WMQ$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|0,

JUMPFORPOST,PostURL,||0,

,Compare,customerId|"5012161747",      // 25 Aug 2021  FIID 72 DSS-78679
,If-FALSE-Goto,skipStorePage, 

,StoredHTTPResponse,,


skipStorePage,Goto,SKP_Layout1,
//M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms	1
//M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode	4455554
                                                                                                  
 SKP_gatecity,NOP,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,anbtx_SKP_weokie, 

,SetBodySelectParameter,"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"1",
,SetBodySelectParameter,"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetBodySelectParameter,"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,ClickBodyButton,"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"aspnetForm",

,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,

,SetParameter,"input"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms",
,SetParameter,"input"|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode",

,ClickBodyButton,"M$layout$content$PCDZ$ME6XVE6$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|0,

,Goto,SKP_Layout1,                                                                                         

anbtx_SKP_weokie,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|"1",				      
,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl1_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,
,ClickBodyButton,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_btnSelectMethod"|"aspnetForm",


,Assign,QuestionOTP|"We are sending a text message to the mobile number you selected. Please enter the code contained in the text message.",

,AddAttendedQuestion,Answer2|QuestionOTP,
,WaitForAnswers,,


,SetParameter,"input"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|"1"|"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpSms_btnSubmitSm",
,SetParameter,"input"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpSms$txtSecurityCode"|Answer2|"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpSms_txtSecurityCode",

,ClickBodyButton,"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpSms$btnSubmitSms"|0,


SKP_Layout1,FindSignature,"The code you entered is incorrect",
,If-TRUE-Goto,errorMFA,

,FindSignature,"we were unable to verify your identity using the option you selected",
,If-TRUE-Goto,errorMFA,

,Compare,Answer2|"",
,If-TRUE-Goto,errorMFA,

//*************

,Compare,customerId|"184765",      // 24 Oct 2021  FIID 5343 DSS-83163   
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"5013430252",      // 11 Sept 2021  FIID 4799 DSS-79878   
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"1003215176",      // 20 Oct 2021  FIID 5343 DSS-82896   
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"14323076",      	// 14 Oct 2021  FIID 15146 DSS-82183  
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"5013281673",      // 09 Sept 2021  FIID 7882 DSS-79614   
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"5013368039",      // 09 Sept 2021  FIID 5420 DSS-79750   
,If-TRUE-Goto,CapturePG,

,Compare,customerId|"5012161747",      // 25 Aug 2021  FIID 72 DSS-78679
,If-FALSE-Goto,skipstored, 

CapturePG,StoredHTTPResponse,,

,Assign,time|##NOW##,
,ExtractFromRawPage,Var|"##KEEP##"|test
,RunJava,CurrentPage|"FinicityUtils"|"base64Encode"|Var,
,Log,ALERT|"ANBT: Account Summary Page 1st"|customerId|" Page : "|CurrentPage,  
,Log,ALERT|"ANBT: 1st Attempt time"|customerId|" time : "|time, 
                                                                                                                                                                                                     
skipstored,Goto,skipMFA,

//*********************************** CALL Layout **********************
CallPosting,Compare,##TOWER_WEBSITE##|"https://creditunion1.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,creditUnionLayout,

,Compare,institutionId|"7882",
,If-TRUE-Goto,creditUnionLayout,

,Compare,institutionId|"5420",
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",         // FI ID: 7112
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,creditUnionLayout,

,Compare,institutionId|"7398",
,If-TRUE-Goto,creditUnionLayout,

,Compare,institutionId|"5343",
,If-TRUE-Goto,GoToFirstCommandBank,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",         // FI ID: 2619
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",         // FI ID: 4799
,If-TRUE-Goto,creditUnionLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fairfieldfederal/signin.aspx",         // FI ID: 14872
,If-TRUE-Goto,FairfieldLayout,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-FALSE-Goto,SKP_Call_LayoutGesa,
,MoveToTopOfPage,,

,MoveToTag,"form",
,GetDataFromTag,LoginRSA_URL_1||"action",

,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|"",

,PostURL,LoginRSA_URL_1||,
,Goto,SKP_Call_Layout1,


GoToFirstCommandBank,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||0,
,Goto,SKP_Call_Layout1,


FairfieldLayout,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MNP1S8W$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,

,PostURL,||0,

,Goto,SKP_Call_Layout1,

creditUnionLayout,NOP,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$btnSelectMethod",
,SetPostURLData,"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$btnSelectMethod"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,

,PostURL,||0,
,Goto,SKP_Call_Layout1,

SKP_Call_LayoutGesa,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl1_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|"1",
,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl0_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl0$lstPhoneNumbers"|Answer1,
,SetBodySelectParameter,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl1_lstPhoneNumbers"|"M$layout$content$PCDZ$MODAQN0$ctl00$ctl00$webInputForm$grpMethods$lvMethods$ctrl1$lstPhoneNumbers"|Answer1,
,ClickBodyButton,"M_layout_content_PCDZ_MODAQN0_ctl00_ctl00_webInputForm_grpMethods_lvMethods_ctrl1_btnSelectMethod"|"aspnetForm",

SKP_Call_Layout1,Compare,##TOWER_WEBSITE##|"https://creditunion1.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",  //FI 4231
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,findOTPSignature,

,Compare,institutionId|"7398",
,If-TRUE-Goto,findOTPSignature,

,Compare,institutionId|"7882",
,If-TRUE-Goto,findOTPSignature,

,Compare,institutionId|"5420",
,If-TRUE-Goto,findOTPSignature,

,Compare,institutionId|"5343",
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",  //FI 11142
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",         // FI ID: 4799
,If-TRUE-Goto,findOTPSignature,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-FALSE-Goto,SKP_OTP_LayoutGesa,

findOTPSignature,FindString,"Please enter the code that you hear in the automated message"|test,
,If-FALSE-Goto,SKP_OTP_LayoutGesa,
,MoveToTopOfPage,,

,MoveToTag,"form",
,GetDataFromTag,LoginRSA_URL_1||"action",

,Assign,Question|"Enter Confirmation Code",

,AddQuestion,OTPAnswer|Question,

,WaitForAnswers,


,Compare,OTPAnswer|"",
,If-TRUE-Goto,errorMFA,

,ExtractFromRawPage,VIEWSTATEID|"id="__VIEWSTATEID" value="##KEEP##""|test,
,ExtractFromRawPage,EVENTVALIDATION|"id="__EVENTVALIDATION" value="##KEEP##""|test,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0"|"T", 
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8"|"T",  

,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,

,Compare,institutionId|"5343",
,If-FALSE-Goto,SkipFirstCommandBankCall,

,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpPhoneCall$btnSubmitPhoneCall"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MDL5OE4$ctl00$ctl00$webInputForm$grpPhoneCall$txtPhoneCallCode"|OTPAnswer,

SkipFirstCommandBankCall,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M24R5FN$ctl00$ctl00$webInputForm$grpPhoneCall$btnSubmitPhoneCall",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpPhoneCall$btnSubmitPhoneCall"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpPhoneCall$txtPhoneCallCode"|OTPAnswer,

,PostURL,LoginRSA_URL_1||,

,Goto,FINDSTRNG1,

//M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpPhoneCall$btnSubmitPhoneCall	1
//M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpPhoneCall$txtPhoneCallCode	5061



SKP_OTP_LayoutGesa,FindString,"enter this confirmation code"|test,
,If-FALSE-Goto,FINDSTRNG1,

,MoveToTag,"b",
,GetDataFromTag,|OTPCode|,

,Assign,PCC|"Phone call completed",
,Assign,OTPcodeQstn|"Please enter this confirmation code and click "Next"",
,AddAttendedQuestion,confirmation|OTPcodeQstn,

,AddAnswerChoice,PCC|OTPCode,
,WaitForAnswers,,
//,Pause,5,

//,StoredHTTPResponse,,


,Goto,skipMFA,
//**********************************************************************

FINDSTRNG1,FindString,"please provide your Secret Answers to the following Security Questions"|test,
,If-TRUE-Goto,GetMFA,

,FindString,"please provide your answer to the following question."|test,
,If-TRUE-Goto,GetMFA,

,FindSignature,"we were unable to verify your identity using the option you selected",
,If-TRUE-Goto,errorMFA,

,Compare,customerId|"184765",      // 24 Oct 2021  FIID 5343 DSS-83163   
,If-TRUE-Goto,Store_Page,

,Compare,customerId|"5013281673",       // Case ID DSS-79614 Date:09/Sept/2021 FIID 7882
,If-TRUE-Goto,Store_Page, 

,Compare,customerId|"5013368039",      // 09 Sept 2021  FIID 5420 DSS-79750   
,If-TRUE-Goto,Store_Page,

,Compare,customerId|"14323076",      	// 14 Oct 2021  FIID 15146 DSS-82183  
,If-TRUE-Goto,Store_Page,

,Compare,customerId|"1003215176",      // 20 Oct 2021  FIID 5343 DSS-82896   
,If-TRUE-Goto,Store_Page,

,Compare,customerId|"5013430252",      // 10 Sept 2021  FIID 4799 DSS-79878 
,If-FALSE-Goto,skipThisStore, 

Store_Page,StoredHTTPResponse,,

skipThisStore,FindString,"please provide your answers to the following questions"|test,
,If-FALSE-Goto,skipMFA,


GetMFA,MoveToTag,"span",

,GetDataFromTag,|question|,

,RemoveHTMLTags,question,

,AddQuestion,answer|question,


,MoveToTag,"span",

,MoveToTag,"span",

,GetDataFromTag,|question1|,

,RemoveHTMLTags,question1,

,AddQuestion,answer1|question1,

,WaitForAnswers,

,Compare,answer|"",
,If-TRUE-Goto,errorMFA,

,SetPostURLData,"M$cmdRefresh"|"Submit Query",

,SetPostURLData,"M$layout$content$PCDZ$M3WO5TB$ctl00$rptAnswerQuestions$ctl00$txtAnswer"|answer,

,SetPostURLData,"M$layout$content$PCDZ$M3WO5TB$ctl00$rptAnswerQuestions$ctl01$txtAnswer"|answer1,

,SetPostURLData,"M$layout$content$PCDZ$M3WO5TB$ctl00$cmdSubmit"|"1",

,PostURLr,|||##URL##, 
                                                                                                  
//--------------------------

skipMFA,FindString,"To help us verify your identity##COMMA## please provide your secret answers to the following questions."|test,
,If-FALSE-Goto,SkpThsMFA,

,MoveToTag,"p",
,GetDataFromTag,|Question|,
,RemoveHTMLTags,Question,

,AddQuestion,Answer|Question,

,WaitForAnswers,


,Compare,Answer|"",
,If-TRUE-Goto,errorMFA,

,ExtractFromRawPage,VIEWSTATEID|"id="__VIEWSTATEID" value="##KEEP##""|test,
,ExtractFromRawPage,EVENTVALIDATION|"id="__EVENTVALIDATION" value="##KEEP##""|test,

,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-FALSE-Goto,SKP_bfsfcu,

,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSecurityQuestions$btnSubmitSecurityQuestions"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MFUZWNF$ctl00$ctl00$webInputForm$grpSecurityQuestions$lvSecurityQuestions$ctrl0$txtSecurityQuestionAnswer"|Answer,
,Goto,Post_bfsfcu,

SKP_bfsfcu,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpSecurityQuestions$btnSubmitSecurityQuestions"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M1O403V$ctl00$ctl00$webInputForm$grpSecurityQuestions$lvSecurit"|Answer,

Post_bfsfcu,PostURL,||,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-FALSE-Goto,SkpThscheckforSouthwest,

,FindSignature,"We're sorry##COMMA## but we were unable to verify your identity using the option you selected.",
,If-FALSE-Goto,SkpThscheckforSouthwest,

,FindSignature,"Send me a text message",
,If-FALSE-Goto,errorMFA,


,Goto,FINDSTRNG,
                                                                         
SkpThscheckforSouthwest,FindSignature,"We're sorry##COMMA## but we were unable to verify your identity using the option you selected.",
,If-TRUE-Goto,errorMFA,

,Compare,customerId|"19286306",
,If-TRUE-Goto,Error906,

SkpThsMFA,FindSignature,"PERSONAL ONLINE BANKING E-SIGN CONSENT AND DISCLOSURE",
,If-TRUE-Goto,error_userAction,

,FindSignature,"We are unable to begin your session. Please call member service for assistance",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"For security reasons##COMMA## we were unable to log you in.",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Youve entered an invalid User Id/Password and your account is locked.",
,If-TRUE-Goto,errorLogon2,
                                                                                         
,FindSignature,"account's been locked for your security",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"account access is restricted",
,If-TRUE-Goto,errorLogon2,
                                                                                                                                            
,FindSignature,"Access Declined",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Youve entered an invalid User ID/Password or your account access is restricted",
,If-TRUE-Goto,errorLogon2,

,FindSignature,"Please update your email address.",
,If-TRUE-Goto,Error108,

,FindSignature,"We're sorry##COMMA## but we were unable to verify your identity using the option you selected",
,If-TRUE-Goto,errorMFA,

//*************
,Compare,customerId|"5013281673",      // Case ID DSS-79614 Date:09/Sept/2021 FIID 7882
,If-TRUE-Goto,getthatmacro,

,Compare,customerId|"184765",      // 24 Oct 2021  FIID 5343 DSS-83163   
,If-TRUE-Goto,getthatmacro,

,Compare,customerId|"14323076",      	// 16 Oct 2021  FIID 15146 DSS-82183  
,If-TRUE-Goto,getthatmacro,

,Compare,customerId|"5013368039",      // 09 Sept 2021  FIID 5420 DSS-79750   
,If-TRUE-Goto,getthatmacro,

,Compare,customerId|"1003215176",      // 20 Oct 2021  FIID 5343 DSS-82896   
,If-TRUE-Goto,getthatmacro,

,Compare,customerId|"5013430252",      // 10 Sept 2021  FIID 4799 DSS-79878
,If-FALSE-Goto,SkpThsStr,

getthatmacro,StoredHTTPResponse,,
,Assign,time|##NOW##,                                                                                                 
,ExtractFromRawPage,Var|"##KEEP##"|test
,RunJava,CurrentPage|"FinicityUtils"|"base64Encode"|Var,
,Log,ALERT|"ANBT: Account Summary Page 2nd"|customerId|" Page : "|CurrentPage,  
,Log,ALERT|"ANBT: 2nd Attempt time"|customerId|" time : "|time, 
                                                                                                  
//*************************
//    AutoLogout Section
//*************************

SkpThsStr,FindString,"Log Out<"|test,
,If-TRUE-Goto,movetaga,

,FindString,">Logout<"|test,
,If-TRUE-Goto,movetaga,

,FindString,"Logout<"|test,
,If-TRUE-Goto,movetaga,

,FindString,">Sign Out<"|test,

movetaga,MoveToTag,"a"|"REV"|test,
skipMFA11,GetDataFromTag,logoutURL||"href",
,AutoLogout,logoutURL,


//*****************************************************************************
//                      SINGLE SESSION LAYOUT STARTED
//*****************************************************************************

,Compare,##SINGLE_SESSION_STATE##|"SINGLE_SESSION_LOGIN",
,If-FALSE-Goto,lblaccountDiscovery,

,AddSingleSession,,
,Assign,SingleSessionEnabledFlag|"TRUE",



lblaccountDiscovery,NOP,,

//*****************************************************************************

//*************************
//    Discovery Section
//*************************  
,FindString,">Accounts<"|test,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,AccURL||"href",

,FindSignature,"I accept the terms of this agreement.",
,If-TRUE-Goto,Error108,

,FindSignature,"One or more of the answers you have provided are incorrect",
,If-TRUE-Goto,errorMFA,

,FindSignature,""accountID"",
,If-TRUE-Goto,JSONLayout,

,FindSignature,""ofxAccountId"",
,If-TRUE-Goto,JSONLayout2,

,Compare,institutionId|"15146",
,If-TRUE-Goto,allsouthlayout,

,Compare,institutionId|"7419",
,If-TRUE-Goto,skipbelowcheck,
                                                                                                  
,FindSignature,""accounts":",
,If-TRUE-Goto,JSONLayout3,

,Compare,institutionId|"7095",
,If-TRUE-Goto,sGetSummPage,
                                                                                                  
,Compare,institutionId|"5899",
,If-TRUE-Goto,sGetSummPage,                                                                                                  

,FindSignature,"Disclosure Viewer",
,If-FALSE-Goto,skipAccSumm,
                                                                                                  
sGetSummPage,GetURLv2,"/Accounts/AccountSummary.aspx"|, 

,Compare,customerId|"12736645",      // 30 March 2021 FIID:4231 Case ID:DSS-67807
,If-FALSE-Goto,skipAccSumm,

,StoredHTTPResponse,,
                                                                                                  
//*************************

skipAccSumm,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,allsouthlayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",  // FI ID: 5899
,If-TRUE-Goto,JSONLayout4,                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",  // FI ID: 1010
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",  // FI ID: 755
,If-TRUE-Goto,allsouthlayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",  // FI ID: 7398
,If-TRUE-Goto,skipbelowcheck,  

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",  // FI ID: 5336 
,If-TRUE-Goto,skipbelowcheck, 

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",  // FI ID: 4987 
,If-TRUE-Goto,skipbelowcheck, 
,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",  // FI ID: 4987 
,If-TRUE-Goto,skipbelowcheck,                                                                                     
,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",  // FI ID: 2617 
,If-TRUE-Goto,skipbelowcheck,
                                                                                                  
,FindSignature,">Available Balance<", 
,If-TRUE-Goto,SkipACHURL,  

skipbelowcheck,NOP,,
//*************************

,FindSignature,"Accounts/AccountSummary", 
,If-TRUE-Goto,SkipHomeURL,
                                                                                         
,GetURLv2,"/Home.aspx"|,

SkipHomeURL,FindSignature,"You have no accounts.",
,If-TRUE-Goto,error914,

,FindSignature,"It looks like you have no accounts.",
,If-TRUE-Goto,error914,
                                                                                                  
,FindSignature,">By clicking the checkbox##COMMA## I accept the terms of this agreement.<",
,If-TRUE-Goto,error_userAction,

//*************************************************** 
,Compare,customerId|"5013281673",      // Case ID DSS-79614 Date:09/Sept/2021 FIID 7882
,If-TRUE-Goto,CaptureHome,

,Compare,customerId|"5013368039",      // 09 Sept 2021  FIID 5420 DSS-79750   
,If-TRUE-Goto,CaptureHome,

,Compare,customerId|"24794163",      // 14 Mar 2021  FIID 7112 DSS-65368
,If-TRUE-Goto,CaptureHome,

,Compare,customerId|"14323076",      	// 16 Oct 2021  FIID 15146 DSS-82183  
,If-TRUE-Goto,CaptureHome,


,Compare,customerId|"1000387239",      // 09 Mar 2021  FIID 2619 DSS-65368
,If-TRUE-Goto,CaptureHome,

,Compare,customerId|"6720074",      // 9th March 2021 FIID:4566 Case ID:DSS-62556
,If-FALSE-Goto,skipHomeCapture,

CaptureHome,StoredHTTPResponse,,
,Assign,time|##NOW##,                                                                                                 
,ExtractFromRawPage,Var|"##KEEP##"|test
,RunJava,CurrentPage|"FinicityUtils"|"base64Encode"|Var,
,Log,ALERT|"ANBT: Account Summary Page 2nd"|customerId|" Page : "|CurrentPage,  

skipHomeCapture,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx", 
,If-TRUE-Goto,allsouthlayout, 

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-TRUE-Goto,allsouthlayout,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.affinityplus.org/SignIn.aspx",
,If-TRUE-Goto,JSONLayout,

,Compare,institutionId|"7495",   
,If-TRUE-Goto,JSONLayout4,

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,getnwmyswacu1,

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,JSONLayout2,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,JSONLayout,                                                                         

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,getnwmyswacu1,                                                                         

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,getnwfcu,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,getnwmyswacu,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnwmyswacu1,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnwmyswacu1,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-TRUE-Goto,northwestbanknew,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,getnwmyswacu1,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SKP_collinsccu,

getnwmyswacu1,GetURLv2,"/Accounts/AccountSummary.aspx"|,
                                                                                              
,Goto,skipthisget,

getnwmyswacu,GetURL,"https://www.myswacu.org/Accounts/AccountSummary.aspx"|,                                                                         

SKP_collinsccu,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368
,If-FALSE-Goto,skipsdccuget,

,GetURL,"https://ib.sdccu.com/SDCCU/Accounts/AccountSummary.aspx"|,

skipsdccuget,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipthisget,

,GetURL,"https://agfed.onlinebank.com/Accounts/AccountSummary.aspx"|,
,Goto,skipthisget,

getnwfcu,GetURL,"https://ebanking.nwfcu.org/2126/Accounts/AccountSummary.aspx"|,

skipthisget,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,Next_Tower_Chk,

,GetURL,"https://ebanking.realtorsfcu.org/2126/Accounts/AccountSummary.aspx"|,

Next_Tower_Chk,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-FALSE-Goto,ChkThsTwr,

,GetURL,"Accounts/AccountSummary.aspx"|,

,Goto,Check_othersRouting,

ChkThsTwr,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skipmembersccu,

,GetURL,"https://membersccu.onlinebank.com/Accounts/AccountSummary.aspx"|,
,Goto,normalflow,

Skipmembersccu,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-FALSE-Goto,northwestbanknew,

,GetURL,"https://cpfcu.onlinebank.com/Accounts/AccountSummary.aspx"|,

northwestbanknew,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-FALSE-Goto,normalflow,

,GetURL,"https://onlinebanking.northwest.bank/Accounts/AccountSummary.aspx"|,
                                                   
normalflow,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipACHURL,

,FindString,"Find your Account Number"|test,
,If-FALSE-Goto,SkipACHURL,

,MoveToTag,"a"|"REV",
,GetDataFromTag,achURL||"href",
,RemoveHTMLTags,achURL,

SkipACHURL,FindString,"Deposits"|test,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,Check_othersRouting,

,FindReplace,"Availaible"|"Available"|##VPAGE##|test,
,ReloadVPage,,                                                                          
,Goto,findrouting,
                                                                       
Check_othersRouting,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,findrouting,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,findrouting,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,newdisclayout,
                                                                      
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/e-fnb/SignIn.aspx",
,If-FALSE-Goto,skipMoveTop,

,MoveToTopOfPage,,

skipMoveTop,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,skippbelow,

findrouting,FindString,"Routing"|test,

,GetDataAfterString,Routing_number|" Number:"|" :",
,RemoveExtraWhitespaces,Routing_number,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,newlayout,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-FALSE-Goto,skipThis1,

,FindString,">Available Balance*<"|test,
,If-TRUE-Goto,Go2Addcount,

,MoveToTopOfPage,,

,FindString,"Available Balance"|test,                                                                         
,If-FALSE-Goto,Error908,

,Goto,Go2Addcount,
                                                                         
skipThis1,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,newlayout,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,newlayout,

,FindString,">Balance<"|test,
,Goto,nxtAccount,

skippbelow,FindString,">Available Balance*<"|test,
,If-TRUE-Goto,Go2Addcount,

,FindString,"Account Nickname"|test,
,If-TRUE-Goto,Go2Addcount,

,FindString,">Available Balance *<"|test,
,If-TRUE-Goto,Go2Addcount,
                                                                                                  
,FindString,"Available Balance"|test,
,If-FALSE-Goto,Error908,

,Goto,Go2Addcount,

,FindString,">Current Balance<"|test,

Go2Addcount,Add,CountAccLayout|1,
nxtAccount,Assign,aNumReal|"",


,MoveToTag,"tr"|test,
,If-FALSE-Goto,history,

,MoveToTag,"td"|test,
,If-FALSE-Goto,history,
,GetDataFromTag,|TempValue|,
,RemoveHTMLTags,TempValue,

,Compare,TempValue|"No accounts to be displayed.",
,If-FALSE-Goto,SkipError914,

,Compare,TempValue|"No Card added.",
,If-FALSE-Goto,SkipError914,
                                                                                                  
,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|914|account,

SkipError914,Compare,TempValue|"Total",
,If-TRUE-Goto,nxtAccount,

,Compare,TempValue|"Totals",
,If-TRUE-Goto,nxtAccount,

,Compare,TempValue|"",
,If-TRUE-Goto,nxtAccount,
                                                                                                  
,ParseString,srore|"[a-z]##KEEP##"|TempValue,
,If-TRUE-Goto,skipbelowAccParse,                                                                                                  

,ParseString,srore|"[0-9]##KEEP##"|TempValue,
,If-FALSE-Goto,nxtAccount,

skipbelowAccParse,Compare,institutionId|"4399",
,If-FALSE-Goto,skipCreditCardLayout,

,ParseString,srore|"card##KEEP##"|TempValue,
,If-FALSE-Goto,skipCreditCardLayout,

,Assign,aname|TempValue,

,Assign,Acctype|TempValue,

,MoveToTag,"td",
,GetDataFromTag,|anum|,

,MoveToTag,"a"|test,
,If-FALSE-Goto,history,

,GetDataFromTag,sURL||"href",

,GetURLv2,sURL|,

,ExtractFromRawPage,newSURL|"window.open[(][']##KEEP##[']##COMMA##"|test,

,GetURLv2,newSURL|,

,GetURLv2,"https://onlinebanking.firstdata.com/ecs/northwest-bank"|,

,SetHeader,"appId"|"northwest-bank",

,GetURLv2,"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/accounts/v1/accountsummary"|,

next_account,GetDataAfterString,abal|""currentBalanceAmount":"|"*."|test, //"
,If-FALSE-Goto,history,

,AppendVars,abal|"-",
,ConvertToValidDollar,abal,

,ReturnToPreviousPage,3,

,Goto,dontassign,

skipCreditCardLayout,Compare,account|0,
,If-FALSE-Goto,NextA,   
                                                                     
NextA,MoveToTag,"a"|test,
,If-FALSE-Goto,history,

,GetDataFromTag,sURL|aname|"href",

,Compare,institutionId|"5420",            //Added this fix missing account issue
,If-TRUE-Goto,SkpContentParse,

,ParseString,sore|"M[$]layout[$]content##KEEP##"|sURL,
,If-FALSE-Goto,nxtAccount,

SkpContentParse,ParseString,srore|"javascript##KEEP##ct"|sURL,
,If-FALSE-Goto,GONXT,

,Assign,Module_ID|srore,

GONXT,Compare,institutionId|"5420",
,If-FALSE-Goto,skipURLAssign,

,ParseString,srore|"Accounts/AccountActivity.aspx##KEEP##"|sURL|test,
,If-TRUE-Goto,skipURLAssign,

,Assign,sURLnew|sURL,

skipURLAssign,RemoveHTMLTags,aname,
,RemoveExtraWhitespaces,aname,
,FindReplace,"&#39;"|"'"|aname,

,Compare,institutionId|"5420",
,If-FALSE-Goto,Skipsection,                                                                                                  
,MoveToTag,"td"|test,
,GetDataFromTag,|aname1|,
,RemoveHTMLTags,aname1,
                                                                                                  
,Assign,Acctype|aname1,                                                                                                  
                                                                                                  
Skipsection,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-FALSE-Goto,Skipdiv,
Takediv,MoveToTag,"div",
,GetDataFromTag,|garbage|,

,ParseString,anum|"[##PIPE##]##KEEP##"|garbage,
,RemoveExtraWhitespaces,anum,
                                                                                                  
Skipdiv,Compare,aname|"",
,If-TRUE-Goto,NextA,

,Compare,aname|"Cancel",
,If-TRUE-Goto,history,

,Compare,aname|"Account Nickname",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Previous Balance",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Principal Balance",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Date",
,If-TRUE-Goto,history,

,Compare,aname|"Send On",
,If-TRUE-Goto,history,

,Compare,aname|"Amount",
,If-TRUE-Goto,history,

,Compare,aname|"Privacy",
,If-TRUE-Goto,history,

,Compare,aname|"help",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Privacy Notice",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Current Balance",
,If-FALSE-Goto,skipbelowpart3,

,MoveToTag,"tr",
,MoveToTag,"td",
,GetDataFromTag,|check914|,

,Compare,check914|"No accounts to be displayed.",                                                                                                  
,If-TRUE-Goto,nxtAccount,

,Compare,check914|"No Card added.",                                                                                                  
,If-TRUE-Goto,nxtAccount,
                                                                                                  
skipbelowpart3,Compare,aname|"Available Balance",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Account #",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Open a New Account",
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Account Nickname##KEEP##"|aname,
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Print",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Available Credit",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Manage",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Manage Accounts",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Balance",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"Account Name",
,If-TRUE-Goto,nxtAccount,
                                                                                                  
,FindReplace,"&#39;"|"'"|sURL|test,

,Compare,institutionId|"5420",
,If-FALSE-Goto,skipURLCheck1,

,ParseString,srore|"Accounts/AccountActivity.aspx##KEEP##"|sURL|test,
,If-TRUE-Goto,skipURLCheck,

,ParseString,sURL1|"LinkButtonClick[(][']##KEEP##[']"|sURL|test,
,If-FALSE-Goto,skipDontAssign,

,Assign,sURL|sURL1,

,Goto,dontassign,
             
skipDontAssign,ParseString,srore|"Accounts/AccountActivity.aspx##KEEP##"|sURLnew|test,
,If-FALSE-Goto,skipURLCheck1,

skipURLCheck,Assign,sURL1|sURLnew,

,Goto,dontassign,

skipURLCheck1,ParseString,sURL1|"LinkButtonClick[(][']##KEEP##[']"|sURL|test,
,If-TRUE-Goto,dontassign,

,Assign,sURL1|sURL,

,Goto,dontassign,

//**************************************************
JSONLayout,MoveToTopOfPage,,

,Assign,account|0,

,FindSignature,""accountID"",
,If-FALSE-Goto,Error908,

FndnxtAccount,GetDataAfterString,accountID|""accountID":"|"_ -"|test,
,If-FALSE-Goto,Newhistory,

contName,GetDataAfterString,aname|"left"|" -&'"|test,
,If-FALSE-Goto,nxtAccount,

,Assign,chkType|aname,
 
,GetDataAfterString,anum|"left["]:["][(]"|" -&'"|test,
,If-TRUE-Goto,SkipAC_Num,

,GetDataAfterString,anum|""left":"|" -&'"|test,
                                                                         
SkipAC_Num,ParseString,srore|"X##KEEP##"|anum,
,If-TRUE-Goto,skipThisAssg,
,Assign,anum|aname,

skipThisAssg,GetDataAfterString,sURL1|"url":""|":/."|test,
,If-FALSE-Goto,FndnxtAccount,

,GetDataAfterString,availablebal|""availableBalance":"|"."|test,
,If-FALSE-Goto,FndnxtAccount,

,GetDataAfterString,abal|""currentBalance":"|"."|test,
,If-FALSE-Goto,FndnxtAccount,

,GetDataAfterString,isAsset|""isAsset":"|""|test,
,If-FALSE-Goto,FndnxtAccount,
   
,GetDataAfterString,isLiability|""isLiability":"|""|test,
,If-FALSE-Goto,FndnxtAccount,
   
SkipAsgn_Num,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-FALSE-Goto,Skip106Logic,

,CheckAccounts,anum||||aname,
,If-TRUE-Goto,Check_Type,
                                                                         
,FindReplace,"x"|"*"|anum|test,  
,Right$,anum|anum|8,
,CheckAccounts,anum||||aname,
,If-TRUE-Goto,Check_Type,
                                                               
,Goto,FndnxtAccount,                                                                         

Skip106Logic,CheckAccounts,anum||||aname,
,If-FALSE-Goto,FndnxtAccount,

//////////////////////////////////
//////////////////
//  CHECKING & Savings
//////////////////
Check_Type,Assign,Acctype|chkType,

,Compare,isAsset|"true",
,If-FALSE-Goto,skipAsset,

,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,SET100,

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,SET101,

,ParseString,type|"Saver##KEEP##"|Acctype,
,If-TRUE-Goto,SET101,

,Goto,SET100,

//////////////////
//  CREDIT CARD
//////////////////

skipAsset,Compare,isLiability|"true",
,If-FALSE-Goto,skipLiability,

,ParseString,type|"Credit Card##KEEP##"|aname,
,If-TRUE-Goto,SET200,

,ParseString,type|"Visa##KEEP##"|aname,
,If-TRUE-Goto,SET200,

,ParseString,type|"MasterCard##KEEP##"|aname,
,If-TRUE-Goto,SET200,
                                                                                                  
,ParseString,type|"x147[-]L2##KEEP##"|anum,
,If-TRUE-Goto,SET200,
                                                                                                  
,ParseString,type|"TRAILERS CAMPERS##KEEP##"|aname,
,If-TRUE-Goto,SET200,

,ParseString,type|"##KEEP##MAZDA MAZDA3"|aname,
,If-TRUE-Goto,SET200,

,ParseString,type|"##KEEP##ES Sedan 4D"|aname,
,If-TRUE-Goto,SET200,

,ParseString,type|"##KEEP##Card"|aname,
,If-TRUE-Goto,SET200,

//////////////////
//  LOC
//////////////////

,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,SET201,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,SET201,

//////////////////
//  Mortgage //
//////////////////
,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,SET400,

,ParseString,type|"Loan##KEEP##"|Acctype,
,If-TRUE-Goto,SET401,

,ParseString,type|"FastCash##KEEP##"|Acctype,
,If-TRUE-Goto,SET401,

,Goto,SET401,
                                                                                    
//////////////////////////////////////////////
skipLiability,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,set100,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 1st Account Type for firstambank.scr"|AccTypeID,
,Goto,skipNeg, 

SET100,Assign,AccTypeID|"100",
,Goto,skipNeg,

SET101,Assign,AccTypeID|"101",
,Goto,skipNeg,

SET102,Assign,AccTypeID|"102",
,Goto,skipNeg,

SET103,Assign,AccTypeID|"103",
,Goto,skipNeg,

SET200,Assign,AccTypeID|"200",
,Goto,setNeg,

SET201,Assign,AccTypeID|"201",
,Goto,setNeg,

SET400,Assign,AccTypeID|"400",
,Goto,setNeg,

SET401,Assign,AccTypeID|"401",

setNeg,AppendVars,abal|"-",
skipNeg,ConvertToValidDollar,abal|test,
,Assign,accountIDFlag|"TRUE",


,Compare,accountID|"",
,If-TRUE-Goto,SkipMaskNumb,

,ParseString,AfterCol|"[-]##PIPE##[:]##PIPE##[A-Z]##KEEP##"|accountID,
,If-FALSE-Goto,Alter4new,

,GetLength,AfterCol|AfterCol|test,

,Compare,AfterCol|1,
,If-FALSE-Goto,Checklen2new,

,Right$,MaskedAccNumber|accountID|6,
,Goto,SkipAlterNumbnew


Checklen2new,Compare,AfterCol|2,
,If-FALSE-Goto,Checklen3new,

,Right$,MaskedAccNumber|accountID|7,

,Goto,SkipAlterNumbnew

Checklen3new,Compare,AfterCol|3,
,If-FALSE-Goto,Checklen4new,

,Right$,MaskedAccNumber|accountID|8,
,Goto,SkipAlterNumbnew

Checklen4new,Right$,MaskedAccNumber|accountID|9,
,Goto,SkipAlterNumbnew

Alter4new,Right$,MaskedAccNumber|accountID|4,

SkipAlterNumbnew,NOP,,

//////////////////////////////////
SkipMaskNumb,Add,account|1,
,SetReturnData,sURL1|sURL1|account,
,SetReturnData,AccURL|AccURL|account,
,SetReturnData,accountID|accountID|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,
,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,MaskedAccNumber|"",
,If-TRUE-Goto,skipAssignMaskNum_new,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|account,

skipAssignMaskNum_new,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,SkipAvailableBal,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  

SkipAvailableBal,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,FndnxtAccount,

,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,
,Goto,FndnxtAccount,

//*****************************FIID 4220********************

JSONLayout2,MoveToTopOfPage,,

,Assign,account|0,
,Assign,tempAcctIndex|0,
,Assign,fullNumFLAG|"TRUE",

,FindSignature,""accountNumber"",
,If-FALSE-Goto,Error908,

//########################## -- FIID 9751 -- ##########################

NextAccnts,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",	  // FI 9751
,If-FALSE-Goto,FndnxtAccount2,

,GetDataAfterString,ofxAccountId|"ofxAccountId":""|"-_"|test,
,If-FALSE-Goto,Newhistory22,

,GetDataAfterString,ofxAccountType|"ofxAccountType":""|""|test,

,GetDataAfterString,aname|"nickname":""|" -'?&()+."|test,
,FindReplace,"\?"|""|aname|test, 
,RemoveExtraWhitespaces,aname,
,RemoveHTMLTags,aname,

,Compare,aname|".",
,If-FALSE-Goto,skipDesc,

,GetDataAfterString,aname|""description":""|"/- # &*. '"|test,  //"
skipDesc,NOP,,

,GetDataAfterString,accountNumber|""accountNumber":""|"-"|test,		//"
,If-FALSE-Goto,Newhistory22,

,Assign,fullAccountNum|accountNumber,
,Assign,anum|accountNumber,

,ParseString,oldNumber|"##KEEP##-"|accountNumber,
,If-FALSE-Goto,skipThis2,
,Assign,anum|oldNumber,

skipThis2,NOP,,

,GetDataAfterString,routingNumber|"routingNumber":""|""|test,  //"

,GetDataAfterString,chkType|""type":"|" "|test,

,CheckAccounts,accountNumber||||aname,
,If-FALSE-Goto,NextAccnts,

,GetDataAfterString,abal|"ledgerBalance":"|".##COMMA##-"|test,  "//

,ParseString,srore|"##KEEP##Loan"|chkType,
,If-FALSE-Goto,GoToAvailable,

,GetDataAfterString,availableCreditBalance|""availableCreditBalance":"|"."|test,
,Goto,GoToURL,

//#######################################
FndnxtAccount2,NOP,
                                                                                                  
,GetDataAfterString,accountNumber|""accountNumber":""|"-"|test,		//"
,If-FALSE-Goto,Newhistory22,

,Assign,fullAccountNum|accountNumber,
,Assign,anum|accountNumber,

,ParseString,oldNumber|"##KEEP##-"|accountNumber,
,If-FALSE-Goto,skipThis,
,Assign,anum|oldNumber,

skipThis,NOP,,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx", 
,If-TRUE-Goto,SKIPofxAccId,

,GetDataAfterString,ofxAccountId|"ofxAccountId":""|"-_"|test,
,If-FALSE-Goto,FndnxtAccount2,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skip_number,

,Assign,accRealNumber|ofxAccountId,
,FindReplace,"_"|""|accRealNumber|test,
,FindReplace,"-"|""|accRealNumber|test,

skip_number,GetDataAfterString,ofxAccountType|"ofxAccountType":""|""|test,

SKIPofxAccId,GetDataAfterString,chkType|""type":"|" "|test,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx", 
,If-FALSE-Goto,SKIPSetofxAccIdtype,

,Assign,ofxAccountType|"",
,Assign,ofxAccountId|"",

SKIPSetofxAccIdtype,GetDataAfterString,aname|"nickname":""|" -'?&()+"|test,
,FindReplace,"\?"|""|aname|test, 

,RemoveExtraWhitespaces,aname,
,RemoveHTMLTags,aname,

,Compare,customerId|"1008715912",  // we skip this duplicate logic if we get any other customers with similar issue.
,If-FALSE-Goto,skipDuplicateLogic,

,Compare,aname|"Spending",
,If-FALSE-Goto,skipDuplicateLogic,

,Add,tempAcctIndex|1,

,AppendVars,aname|"-",
,AppendVars,aname|tempAcctIndex,

skipDuplicateLogic,CheckAccounts,accountNumber||||aname,
,If-FALSE-Goto,FndnxtAccount2,
                                                                       
,GetDataAfterString,abal|"ledgerBalance":"|".##COMMA##-"|test,  "//

,Compare,aname|"Consumer Loan",
,If-TRUE-Goto,GoToURL,

,Compare,abal|"##COMMA##",
,If-FALSE-Goto,GoToAvailable,

AssignZero,Assign,abal|0,

GoToAvailable,GetDataAfterString,availablebal|"availableBalance":"|"."|test,  "//

GoToURL,GetDataAfterString,sURL1|"url":""|":/."|test,

findNxtAccId,GetDataAfterString,fullAccountNumber|"fullAccountNumber":""|""|test,
,If-FALSE-Goto,skpFullNUM,

,Right$,TempACCOUNT_NUMBER_REAL|fullAccountNumber|4,
,Right$,AccAnum|anum|4,

,Compare,TempACCOUNT_NUMBER_REAL|AccAnum,
,If-FALSE-Goto,findNxtAccId,
                                                                                               
skpFullNUM,Log,STATUS|script_Name|" FullAccountNumber not Found  "|institutionId|" and CCID : "|customerId|" and Partner ID "|partnerId,

,CheckAccounts,accountNumber||||aname,
,If-TRUE-Goto,skipNextCheck,

,CheckAccounts,accountNumber||||aname,
,If-FALSE-Goto,FndnxtAccount2,

,Assign,accountNumber|anum,
//////////////////

skipNextCheck,Compare,ofxAccountType|"",
,If-TRUE-Goto,Assign_Account_Type,

,Assign,chkType|ofxAccountType,

//////////////////
//  CHECKING
//////////////////
Assign_Account_Type,Assign,Acctype|chkType,

,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,setChecking,

//////////////////
//  SAVING 
//////////////////

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,setSaving,

//////////////////
//  CREDIT CARD
//////////////////

,ParseString,type|"CREDITCARD##KEEP##"|Acctype,
,If-TRUE-Goto,setCC,

,ParseString,type|"CREDITLINE##KEEP##"|Acctype,
,If-TRUE-Goto,setLoan,

,ParseString,type|"Loan##KEEP##"|Acctype,
,If-FALSE-Goto,setDefaultType,

,ParseString,type|"Credit Card##KEEP##"|aname,
,If-TRUE-Goto,setCC,

,ParseString,type|"Visa##KEEP##"|aname,
,If-TRUE-Goto,setCC,

,ParseString,type|"MasterCard##KEEP##"|aname,
,If-TRUE-Goto,setCC,                                                                                               
                                                                                             
,ParseString,type|"TRAILERS CAMPERS##KEEP##"|aname,
,If-TRUE-Goto,setCC,

,ParseString,type|"##KEEP##MAZDA MAZDA3"|aname,
,If-TRUE-Goto,setCC,

,ParseString,type|"##KEEP##ES Sedan 4D"|aname,
,If-TRUE-Goto,setCC,

,ParseString,type|"##KEEP##Card"|aname,
,If-TRUE-Goto,setCC,

//////////////////
//  LOC
//////////////////

,ParseString,type|"LINE OF CREDIT##KEEP##"|aname,
,If-TRUE-Goto,setLOC,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,setLOC,

,ParseString,type|"Home Equity##KEEP##"|aname,
,If-TRUE-Goto,setLOC,

//////////////////
//  Mortgage //
//////////////////
,ParseString,type|"MORTGAGE##KEEP##"|aname,
,If-TRUE-Goto,setMortgage, 

,ParseString,type|"Loan##KEEP##"|aname,
,If-TRUE-Goto,setLoan,

,ParseString,type|"FastCash##KEEP##"|aname,
,If-TRUE-Goto,setLoan,

,Goto,setLoan,
                                                                                    
//////////////////////////////////////////////
setDefaultType,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,setChecking,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 2nd Account Type for firstambank.scr"|AccTypeID,

,Goto,CheckNeg, 

setChecking,Assign,AccTypeID|"100",
,Goto,CheckNeg,

setSaving,Assign,AccTypeID|"101",
,Goto,CheckNeg,

setCC,Assign,AccTypeID|"200",
,Goto,CheckNeg,

setLOC,Assign,AccTypeID|"201",
,Goto,CheckNeg,

setMortgage,Assign,AccTypeID|"400",
,Goto,CheckNeg,

setmoney,Assign,AccTypeID|"103",
,Goto,CheckNeg,

setLoan,Assign,AccTypeID|"401",

CheckNeg,Compare,AccTypeID|"200",
,If-TRUE-Goto,GoNegtve,

,Compare,AccTypeID|"201",
,If-TRUE-Goto,GoNegtve,

,Compare,AccTypeID|"400",
,If-TRUE-Goto,GoNegtve,

,Compare,AccTypeID|"401",
,If-FALSE-Goto,SkipNegtve,

GoNegtve,ParseString,testbal|"[-]##KEEP##"|abal,
,If-TRUE-Goto,skip_ngtve,
                                                                         
,AppendVars,abal|"-",

skip_ngtve,Compare,abal|"0.0",
,If-TRUE-Goto,skpneg,

SkipNegtve,ConvertToValidDollar,abal|test,
,Right$,MaskedAccNumber|ofxAccountId|4,
,Add,account|1,

,SetReturnData,sURL1|sURL1|account,
,SetReturnData,AccURL|AccURL|account,
,SetReturnData,ofxAccountId|ofxAccountId|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|accountNumber|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,
,Compare,MaskedAccNumber|"",
,If-TRUE-Goto,skipAssignMaskNum,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|account,

skipAssignMaskNum,Compare,availablebal|"",
,If-TRUE-Goto,Skip_AvailBalReturn,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  
Skip_AvailBalReturn,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,
,SetReturnData,fullAccountNum|fullAccountNum|account,

,Compare,accRealNumber|"",
,If-TRUE-Goto,skp_accRealNumber,
,SetReturnData,accRealNumber|accRealNumber|account,

skp_accRealNumber,Compare,fullAccountNumber|"",
,If-TRUE-Goto,skpFullNUMBER,
,SetReturnData,fullAccountNumber|fullAccountNumber|account,

skpFullNUMBER,Compare,##REQUEST##|"DISCOVERY",
,If-TRUE-Goto,GoForSetReturn,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",	  // FI 9751
,If-TRUE-Goto,NextAccnts,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,FndnxtAccount2,

,FindString,""CustomUnMaskedAccountNumber""|test,
,Goto,FndnxtAccount2,

GoForSetReturn,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",	  // FI 9751
,If-TRUE-Goto,NextAccnts,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,FndnxtAccount2,

,FindString,""CustomUnMaskedAccountNumber""|test,
,Goto,FndnxtAccount2,
//**************************************************************************

JSONLayout3,MoveToTopOfPage,,

,Assign,account|0,

,FindSignature,""accounts"",
,If-FALSE-Goto,Error908,

,FindString,"Account Activity"|test,
,If-FALSE-Goto,history,


,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,AccURL||"href",

,MoveToTopOfPage,,

FndnxtAccount3,Compare,institutionId|"7095",
,If-FALSE-Goto,skipBelowDiscovery,

,GetDataAfterString,aname|"nickname":""|" -'?&()"|test,
,If-FALSE-Goto,history,                                                                                                  
                                                                                                  
,FindReplace,"\?"|""|aname|test, 

,RemoveExtraWhitespaces,aname,
,RemoveHTMLTags,aname,

,GetDataAfterString,anum|""accountNumber":""|"-"|test,		//"
,If-FALSE-Goto,history,
                                                                                                  
,GetDataAfterString,routingNumber|"routingNumber":""|""|test,  //"
,If-FALSE-Goto,history,
  
,GetDataAfterString,chkType|""type":"|""|test,
,If-FALSE-Goto,history,

,Goto,getLedgerBal,

skipBelowDiscovery,GetDataAfterString,routingNumber|"routingNumber":""|""|test,  //"
,If-FALSE-Goto,history,

,GetDataAfterString,anum|""accountNumber":""|"-"|test,		//"
,If-FALSE-Goto,history,
                      
,GetDataAfterString,chkType|""type":"|""|test,       
         
,GetDataAfterString,aname|"nickname":""|" -'?&()"|test,
,FindReplace,"\?"|""|aname|test, 

,RemoveExtraWhitespaces,aname,
,RemoveHTMLTags,aname,


getLedgerBal,GetDataAfterString,abal|"ledgerBalance":"|".##COMMA##-"|test,  "//

,ParseString,srore|"##KEEP##Loan"|chkType,
,If-FALSE-Goto,GetAvailBal,


,GetDataAfterString,availableCreditBalance|""availableCreditBalance":"|"."|test,
,Goto,skipthis1,

GetAvailBal,GetDataAfterString,availablebal|""availableBalance":"|"."|test,
,If-FALSE-Goto,FndnxtAccount3,

skipthis1,FindString,"transactionsAt"|test,
,If-FALSE-Goto,FndnxtAccount3,

,GetDataAfterString,sURL1|"url":""|":/."|test,
,If-FALSE-Goto,FndnxtAccount3,


,CheckAccounts,anum||||aname,
,If-FALSE-Goto,FndnxtAccount3,

//////////////////////////////////
//////////////////
//  CHECKING & Savings
//////////////////
,Assign,Acctype|chkType,

,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC100,

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC101,

,ParseString,type|"Saver##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC101,


//////////////////
//  CREDIT CARD
//////////////////

,ParseString,type|"Credit Card##KEEP##"|aname,
,If-TRUE-Goto,SETACC200,

,ParseString,type|"Visa##KEEP##"|aname,
,If-TRUE-Goto,SETACC200,

,ParseString,type|"MasterCard##KEEP##"|aname,
,If-TRUE-Goto,SETACC200,
                                                                                                  
,ParseString,type|"x147[-]L2##KEEP##"|anum,
,If-TRUE-Goto,SETACC200,
                                                                                                  
,ParseString,type|"TRAILERS CAMPERS##KEEP##"|aname,
,If-TRUE-Goto,SETACC200,

,ParseString,type|"##KEEP##MAZDA MAZDA3"|aname,
,If-TRUE-Goto,SETACC200,

,ParseString,type|"##KEEP##ES Sedan 4D"|aname,
,If-TRUE-Goto,SETACC200,

,ParseString,type|"##KEEP##Card"|aname,
,If-TRUE-Goto,SETACC200,

//////////////////
//  LOC
//////////////////

,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC201,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC201,

//////////////////
//  Mortgage //
//////////////////
,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC400, 

,ParseString,type|"Loan##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC400,

,ParseString,type|"FastCash##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC400,

,Goto,SETACC400,
                                                                                    
//////////////////////////////////////////////
,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,SETACC100,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 1st Account Type for firstambank.scr"|AccTypeID,
,Goto,skipNeg1, 

SETACC100,Assign,AccTypeID|"100",
,Goto,skipNeg1,

SETACC101,Assign,AccTypeID|"101",
,Goto,skipNeg1,

SETACC102,Assign,AccTypeID|"102",
,Goto,skipNeg1,

SETACC103,Assign,AccTypeID|"103",
,Goto,skipNeg1,

SETACC200,Assign,AccTypeID|"200",
,Goto,setNeg1,

SETACC201,Assign,AccTypeID|"201",
,Goto,setNeg1,

SETACC400,Assign,AccTypeID|"400",
,Goto,setNeg1,


setNeg1,AppendVars,abal|"-",
skipNeg1,ConvertToValidDollar,abal|test,
,Assign,accountIDFlag|"TRUE",

,GetLength,MaskedNumber_length|anum
  
,Compare,MaskedNumber_length|4,
,If-FALSE-Goto,Skip_MaskedNumber_Logic4,

,Right$,MaskedAccNumber|anum|4,
,Goto,Goto_AddAccCount,  

Skip_MaskedNumber_Logic4,Compare,MaskedNumber_length|5,
,If-FALSE-Goto,Skip_MaskedNumber_Logic5,

,Right$,MaskedAccNumber|anum|5,
,Goto,Goto_AddAccCount,  

Skip_MaskedNumber_Logic5,Right$,MaskedAccNumber|anum|6,


//////////////////////////////////
Goto_AddAccCount,Add,account|1,
,SetReturnData,sURL1|sURL1|account,
,SetReturnData,AccURL|AccURL|account,
,SetReturnData,accountID|accountID|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,

,Compare,MaskedAccNumber|"",
,If-TRUE-Goto,SkipMaskNumbSetnew,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|account,

SkipMaskNumbSetnew,ParseString,srore|"##KEEP##Loan"|chkType,
,If-FALSE-Goto,SkipReturn,

,Compare,availableCreditBalance|"",
,If-TRUE-Goto,GOnormalflow,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_LOC:CREDIT_AVAILABLE_AMOUNT##|availableCreditBalance|account,  

,Goto,GOnormalflow,


SkipReturn,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  

GOnormalflow,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,FndnxtAccount3,

,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,
,Goto,FndnxtAccount3,
  
//********************************************************************************
//           JSON LAYOUT 4 (FIID 5899) START
//********************************************************************************  
  
JSONLayout4,MoveToTopOfPage,,

,Assign,account|0,
,Assign,tempAcctIndex|0,
,Assign,fullNumFLAG|"TRUE",

,FindSignature,""accountNumber"",
,If-FALSE-Goto,Error908,

,ExtractFromRawPage,CsrfToken|"["]X-CSRF-Token["]##COMMA## ["]##KEEP##["]"|test,


FndnxtAccount4,GetDataAfterString,routingNumber|"routingNumber":""|""|test,  //"
,If-FALSE-Goto,history_4,

,GetDataAfterString,anum|""accountNumber":""|"-"|test,		//"
,If-FALSE-Goto,history_4,
                      
,GetDataAfterString,chkType|""type":"|""|test,       
         
,GetDataAfterString,aname|"nickname":""|" -'?&()"|test,
,FindReplace,"\?"|""|aname|test, 

,RemoveExtraWhitespaces,aname,
,RemoveHTMLTags,aname,


,GetDataAfterString,abal|"ledgerBalance":"|".##COMMA##-"|test,  "//

,ParseString,srore|"##KEEP##Loan"|chkType,
,If-FALSE-Goto,GetAvailBal4,


,GetDataAfterString,availableCreditBalance|""availableCreditBalance":"|"."|test,
,Goto,skipthis4,

GetAvailBal4,GetDataAfterString,availablebal|""availableBalance":"|"."|test,
,If-FALSE-Goto,FndnxtAccount4,

skipthis4,FindString,"transactionsAt"|test,
,If-FALSE-Goto,FndnxtAccount4,

,GetDataAfterString,sURL1|"url":""|":/."|test,
,If-FALSE-Goto,FndnxtAccount4,

,GetDataAfterString,Token|"token":""|"=/+"|test,
,If-FALSE-Goto,FndnxtAccount4,

,CheckAccounts,anum||||aname,
,If-FALSE-Goto,FndnxtAccount4,  

//////////////////////////////////
//////////////////
//  CHECKING & Savings
//////////////////
,Assign,Acctype|chkType,

,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_100,

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_101,

,ParseString,type|"Saver##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_101,


//////////////////
//  CREDIT CARD
//////////////////

,ParseString,type|"Credit Card##KEEP##"|aname,
,If-TRUE-Goto,SETACC_200,

,ParseString,type|"Visa##KEEP##"|aname,
,If-TRUE-Goto,SETACC_200,

,ParseString,type|"MasterCard##KEEP##"|aname,
,If-TRUE-Goto,SETACC_200,
                                                                                                  
,ParseString,type|"x147[-]L2##KEEP##"|anum,
,If-TRUE-Goto,SETACC_200,
                                                                                                  
,ParseString,type|"TRAILERS CAMPERS##KEEP##"|aname,
,If-TRUE-Goto,SETACC_200,

,ParseString,type|"##KEEP##MAZDA MAZDA3"|aname,
,If-TRUE-Goto,SETACC_200,

,ParseString,type|"##KEEP##ES Sedan 4D"|aname,
,If-TRUE-Goto,SETACC_200,

,ParseString,type|"##KEEP##Card"|aname,
,If-TRUE-Goto,SETACC_200,

//////////////////
//  LOC
//////////////////

,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_201,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_201,

//////////////////
//  Mortgage //
//////////////////
,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_400, 

,ParseString,type|"Loan##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_400,

,ParseString,type|"FastCash##KEEP##"|Acctype,
,If-TRUE-Goto,SETACC_400,

,Goto,SETACC_400,
                                                                                    
//////////////////////////////////////////////
,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,SETACC_100,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 1st Account Type for firstambank.scr"|AccTypeID,
,Goto,skipNeg4, 

SETACC_100,Assign,AccTypeID|"100",
,Goto,skipNeg4,

SETACC_101,Assign,AccTypeID|"101",
,Goto,skipNeg4,

SETACC_102,Assign,AccTypeID|"102",
,Goto,skipNeg4,

SETACC_103,Assign,AccTypeID|"103",
,Goto,skipNeg4,

SETACC_200,Assign,AccTypeID|"200",
,Goto,skipNeg4,

SETACC_201,Assign,AccTypeID|"201",
,Goto,skipNeg4,

SETACC_400,Assign,AccTypeID|"400",
,Goto,skipNeg4,


setNeg4,AppendVars,abal|"-",
skipNeg4,ConvertToValidDollar,abal|test,
,Assign,accountIDFlag|"TRUE",

//////////////////////////////////
,Add,account|1,
,SetReturnData,sURL1|sURL1|account,
,SetReturnData,Token|Token|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,

,ParseString,srore|"##KEEP##Loan"|chkType,
,If-FALSE-Goto,SkipReturn4,

,Compare,availableCreditBalance|"",
,If-TRUE-Goto,GOnormalflow4,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_LOC:CREDIT_AVAILABLE_AMOUNT##|availableCreditBalance|account,  

,Goto,GOnormalflow4,


SkipReturn4,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  

GOnormalflow4,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,FndnxtAccount4,

,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,
,Goto,FndnxtAccount4,  

//***************************************************************************************************
//             JSON Layout 4 END
//*****************************************************************************************************
    
history_4,NOP,,

,Compare,##REQUEST##|"DISCOVERY",
,If-TRUE-Goto,logout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD",
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Assign,hIndex|0,
,Assign,trans|0,


nexttrans,NOP,,
,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Assign,StartDate|##STARTDATE##,
,Assign,EndDate|##ENDDATE##,

,ConvertDateToText,##STARTDATE##|StartDate|"yyyy-MM-dd",
,ConvertDateToText,##ENDDATE##|EndDate|"yyyy-MM-dd",
,RollDate,EndDate|EndDate|DAY|-1|test,
  
,Assign,tower|##TOWER_WEBSITE##,
,ParseString,TOWER|"https://##KEEP##/"|tower,  

,Add,hIndex|1,

,GetReturnData,sURL1|sURL1|hIndex,
,GetReturnData,Token|Token|hIndex,

,RollDate,EndDate|tempDate|DAY|-120|test,

,CompareDates,##STARTDATE##|tempDate|<,
,If-FALSE-Goto,checkAgain,

,Assign,StartDate|tempDate,

checkAgain,Assign,downloadURL|"https://",
,AppendVars,downloadURL|TOWER,
,AppendVars,downloadURL|sURL1,
,AppendVars,downloadURL|"?maxCount=250&sortBy=isPending DESC##COMMA##transactionDate DESC&transactionTypeId=&searchString=&startDate=",
,AppendVars,downloadURL|StartDate,
,AppendVars,downloadURL|"&endDate=",
,AppendVars,downloadURL|EndDate,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0",
,SetHeader,"Accept"|"application/json",
,SetHeader,"X-Request-Token"|Token,
,SetHeader,"X-CSRF-Token"|CsrfToken,

,GetURL,downloadURL|,

,ExtractFromRawPage,vpage|"##KEEP##"|test,

,Assign,Vpage|"{"TransactionData":",
,AppendVars,Vpage|vpage,
,AppendVars,Vpage|"}",

,JSON-GetValueFromObject,accountsData|"TransactionData"|Vpage,
,If-FALSE-Goto,retpage,
  
,JSON-GetLength,len|accountsData,

,Assign,jindex|0,

againTXN,JSON-GetValueFromArray,TxnDate|"transactionDate"|jindex|accountsData|test, 
,If-FALSE-Goto,retpage,

,JSON-GetValueFromArray,TxnDesc|"description"|jindex|accountsData|test,
,If-FALSE-Goto,retpage,
  
,RemoveExtraWhitespaces,TxnDesc,

,Assign,PendingFlag|"F",

,ParseString,srore|"Pending##KEEP##"|TxnDesc,
,If-FALSE-Goto,SkipPendingFlag,

,Assign,PendingFlag|"T",

SkipPendingFlag,JSON-GetValueFromArray,TxnAmt|"amount"|jindex|accountsData|test,
,If-FALSE-Goto,retpage,  
  
,ConvertToValidDollar,TxnAmt,

,Add,jindex|1, 

,GetSubstring,year|TxnDate|0|4,
,GetSubstring,month|TxnDate|5|7,
,GetSubstring,dte|TxnDate|8|10,

,CreateDate,TxnDate|year|month|dte|test,

,ConvertToValidDate,TxnDate,
,If-FALSE-Goto,nexttrans,

,Add,trans|1,

,Compare,PendingFlag|"T",
,If-FALSE-Goto,SkipPendingstatus,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:STATUS##|"P"|hIndex|trans,

SkipPendingstatus,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|TxnDate|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:POSTED_DATE##|TxnDate|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|TxnDesc|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|TxnAmt|hIndex|trans,

,Goto,againTXN,

retpage,NOP,,

,Assign,EndDate|StartDate,

,RollDate,StartDate|EndDate|DAY|-1|test,

,RollDate,EndDate|StartDate|DAY|-120|test,

,CompareDates,##STARTDATE##|EndDate|>,
,If-TRUE-Goto,checkthisfirst,

,CompareDates,StartDate|##STARTDATE##|>,
,If-TRUE-Goto,checkAgain,

,Assign,StartDate|##STARTDATE##,

,Goto,checkAgain,

checkthisfirst,NOP,

,Goto,nexttrans,

//**************************************************************************

Newhistory,Compare,##REQUEST##|"DISCOVERY", 
,If-TRUE-Goto,logout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD", 
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Assign,txnIndex|0,

,Assign,hIndex|0,

NextAccHistory,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Assign,trans|0,
,Add,hIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

,GetURLv2,"https://onlinebanking.affinityplus.org/ToolAlert/TaxInformation.aspx"|,

,FindSignature,">Download Transactions<",

,GetURL,"https://onlinebanking.affinityplus.org/ToolAlert/DownloadTransaction.aspx"|,

,GetReturnData,accountID|accountID|hIndex,

,FindString,"Select the account"|test,

,MoveToTag,"select"|test,
,GetDataFromTag,VALUE||"id",

,ParseString,VAL|"M_layout_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,//"

//**********************************************************************************************************

,Assign,accountDropDown|"M$layout$content$PCDZ$XXXXXX$ctl00$accountDropDown",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calStartDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calEndDate$TB",
,Assign,quickenWebConnectButton|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.x",
,Assign,quickenWebConnectButton1|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.y",

,FindReplace,"XXXXXX"|VAL|accountDropDown|test,
,FindReplace,"XXXXXX"|VAL|StartDate|test,
,FindReplace,"XXXXXX"|VAL|EndDate|test,
,FindReplace,"XXXXXX"|VAL|quickenWebConnectButton|test,
,FindReplace,"XXXXXX"|VAL|quickenWebConnectButton1|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,accountDropDown|accountID,
,SetPostURLData,StartDate|STRTDATE,
,SetPostURLData,EndDate|ENDDATE,
,SetPostURLData,quickenWebConnectButton|"0",
,SetPostURLData,quickenWebConnectButton1|"0",

,PostURL,||,

//**********************************************************************************************************  



//,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA##+Version=4.0.0.0##COMMA##+Culture=neutral##COMMA##+PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA##+Version=2014.2.618.40##COMMA##+Culture=neutral##COMMA##+PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",

//,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
//,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
//,SetPostURLData,"M$layout$content$PCDZ$MGSICDQ$ctl00$accountDropDown"|accountID,
//,SetPostURLData,"M$layout$content$PCDZ$MGSICDQ$ctl00$calStartDate$TB"|STRTDATE,
//,SetPostURLData,"M$layout$content$PCDZ$MGSICDQ$ctl00$calEndDate$TB"|ENDDATE,
//,SetPostURLData,"M$layout$content$PCDZ$MGSICDQ$ctl00$quickenWebConnectButton.x"|"60",
//,SetPostURLData,"M$layout$content$PCDZ$MGSICDQ$ctl00$quickenWebConnectButton.y"|"10",
//,PostURL,"https://onlinebanking.affinityplus.org/ToolAlert/DownloadTransaction.aspx"||,

,FindSignature,">No transactions found for specified date range.<",
,If-TRUE-Goto,NextAccHistory,

,FindSignature,"Please select an account",
,If-TRUE-Goto,NextAccHistory,

,Add,txnIndex|1,
,GetStatementFromOFX,hIndex,

,ParseString,srore|"200##PIPE##400##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,SkipAccountTypeReturn,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|QFX_Account_Type_ID|hIndex,
,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,
  
 ,Assign,Result|"Account Type ID Match : ",
,Compare,QFX_Account_Type_ID|AccTypeID,
,If-TRUE-Goto,PrintLogs,
,Assign,Result|"Account Type ID Mismatch : ",

PrintLogs,Log,ALERT|"Account Type Overriding Logging for Institution ID : "|institutionId|" AccountType in QFX - "|QFX_Account_Type_ID|" : AccountType overriding QFX - "|AccTypeID|" : Result - "|Result|" Customer ID -"|customerId|" : Partner ID - "|partnerId,

  
SkipAccountTypeReturn,Compare,AccTypeID|"200",
,If-FALSE-Goto,NEgtran,

,GetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,
,Assign,Negative|"-",
,AppendVars,Negative|abal,
,Assign,abal|Negative,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,

NEgtran,ReturnToPreviousPage,2,
,Goto,NextAccHistory,

Newhistory22,Goto,history,

/////////////////////////////////////////////

//  RETURN ACCOUNT TYPE ID

//////////////////////////////////////////////

newlayout,MoveToTopOfPage,,

,FindString,"accountID"|test,
,If-FALSE-Goto,Error908,

chknxtAccount,GetDataAfterString,aname|"left"|" "|test,
,If-FALSE-Goto,nxtAccount,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DNTSKP_check1,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SKP_check1,

DNTSKP_check1,Compare,aname|"",
,If-TRUE-Goto,nxtAccount,

,Compare,aname|"right",
,If-TRUE-Goto,chknxtAccount,
,Goto,do_This,


SKP_check1,Compare,aname|"right",
,If-TRUE-Goto,nxtAccount,
do_This,GetDataAfterString,availablebal|"right"|".##COMMA##-$"|test,
,If-FALSE-Goto,chknxtAccount,
,GetDataAfterString,anum|"left"|"-"|test,
,If-FALSE-Goto,chknxtAccount,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DNTSKP_check2,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SKP_check2,

DNTSKP_check2,Compare,anum|"Payment",
,If-FALSE-Goto,SKP_check2,

,Assign,anum|aname,

,GetDataAfterString,sURL1|"url":""|":/."|test,
,If-FALSE-Goto,chknxtAccount,


,ParseString,srore|"Credit Card##KEEP##"|aname|test,
,If-FALSE-Goto,gotoavailbal,

,GetDataAfterString,sURL1|"url":""|":/.-?="|test,
,If-FALSE-Goto,chknxtAccount,

gotoavailbal,GetDataAfterString,abal|""availableBalance":"|"."|test,
,If-FALSE-Goto,chknxtAccount,

,Goto,dontassign,

SKP_check2,GetDataAfterString,abal|""right":"|".##COMMA##:$ "|test,
,If-FALSE-Goto,chknxtAccount,

,ParseString,Abal1|"Available[:] ##KEEP##"|abal,
,If-TRUE-Goto,AsgnBal,

,ParseString,Abal1|"Balance[:] ##KEEP##"|abal,

AsgnBal,Assign,abal|Abal1,
,RemoveExtraWhitespaces,abal,
	
,FindReplace,"##COMMA##"|""|abal|test,
,ConvertToValidDollar,abal,

,Compare,aname|"1st mortgage",
,If-TRUE-Goto,mortageurlAssign,
,Compare,aname|"10 yr Mortgage",
,If-FALSE-Goto,SkipSpeAssign,
mortageurlAssign,Assign,sURL1|"https://ebanking.nwfcu.org/2126/Accounts/AccountActivity.aspx",
,Assign,anum|aname,
,Goto,dontassign,

SkipSpeAssign,GetDataAfterString,sURL1|"url":""|":/."|test,
,If-FALSE-Goto,chknxtAccount,


//////////////////

//  CHECKING 

//////////////////

dontassign,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-TRUE-Goto,skiptd,
  
,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipmytd,  

,Assign,Acctype|aname,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,SKIPparsing,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,tomytd,
                       
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-TRUE-Goto,tomytd,
  
,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,tomytd,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,tomytd,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,tomytd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/GreeceCommunityFCU/SignIn.aspx",
,If-TRUE-Goto,tomytd,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,tomytd,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,tomytd,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-FALSE-Goto,skipmytd,

tomytd,MoveToTag,"td",
,GetDataFromTag,|Acctype|,

skipmytd,NOP,,

//////////////////

//  SAVING 

//////////////////
,ParseString,srore|"M8BXPV4##KEEP##"|sURL1,
,If-TRUE-Goto,checkTypes,                                                                                                  
,ParseString,srore|"MJH6C3I##KEEP##"|sURL1,
,If-TRUE-Goto,checkTypes,                                                                                                  
,ParseString,srore|"MB4PY2##KEEP##"|sURL1,
,If-TRUE-Goto,checkTypes,
  
,ParseString,srore|"MF25I7S##KEEP##"|sURL1,
,If-TRUE-Goto,CheckSavings,

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToSaving,
                                                                                                  
,ParseString,srore|"MAW01GQ##KEEP##"|sURL1,
,If-FALSE-Goto,SkipSavings,

CheckSavings,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToSaving,

,Goto,setTypeToSaving,

//////////////////

//  CD 

//////////////////

SkipSavings,ParseString,type|"##KEEP##MLR1FPT"|sURL1,
,If-TRUE-Goto,setTypeToCD, 

,ParseString,type|"##KEEP##MC3IUT5"|sURL1,
,If-TRUE-Goto,setTypeToCD, 

//////////////////

//  Checking 

//////////////////
,ParseString,srore|"MXWGDOM##KEEP##"|sURL1,
,If-FALSE-Goto,SkipChecking,

checkTypes,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToChecking,
                                                                                                  
,ParseString,type|"##KEEP##Money Market"|Acctype,
,If-TRUE-Goto,setTypeTomoney,

,ParseString,type|"##KEEP##MARKET"|Acctype,
,If-TRUE-Goto,setTypeTomoney,

,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToSaving,

,ParseString,type|"HSA##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToSaving,

,ParseString,type|"CD##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCD,

,ParseString,type|"CARD##KEEP##"|Acctype,
,If-TRUE-Goto,CheckCreditCard,

,ParseString,type|"Certificate##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCD,

,Goto,setTypeToChecking,


//////////////////

//  CREDIT CARD 

//////////////////

SkipChecking,ParseString,type|"Visa##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"MasterCard##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"MC1ZISY##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"MYTXCNY##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"MC9V0WF##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToCC,

,ParseString,srore|"MB28E9N##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToCC,

,ParseString,srore|"MLV7KC1##KEEP##"|sURL1,
,If-TRUE-Goto,CheckCreditCard,

,ParseString,srore|"M702WF4##KEEP##"|sURL1,
,If-TRUE-Goto,CheckCreditCard,

,ParseString,srore|"MM3RPRF##KEEP##"|sURL1,
,If-FALSE-Goto,SkipCreditCard,

CheckCreditCard,ParseString,type|"MORTGAGE##KEEP##"|aname,
,If-TRUE-Goto,checkLoan,

,ParseString,type|"Credit Card##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"Line of Credit##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLOC,
  
,ParseString,type|"MasterCard##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCC,
                                                                                                  
,ParseString,type|"Platinum##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"##KEEP##Card"|Acctype,
,If-TRUE-Goto,setTypeToCC,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLOC,

,ParseString,type|"30-360##KEEP##"|Acctype,
,If-TRUE-Goto,checkLoan, 
  
,ParseString,type|"Loan##KEEP##"|Acctype,
,If-TRUE-Goto,checkLoan, 
  
,Goto,setTypeToCC,
//////////////////

//  LOAN //

//////////////////

SkipCreditCard,NOP,,
,ParseString,srore|"MKBXFM3##KEEP##"|sURL1,
,If-TRUE-Goto,checkLoan,

,ParseString,type|"M702WF4##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToLoan,
  
,ParseString,srore|"MO31N95##KEEP##"|sURL1,
,If-TRUE-Goto,checkLoan,  

,ParseString,srore|"30-360##KEEP##"|sURL1,
,If-TRUE-Goto,checkLoan,  

,ParseString,srore|"30-360##KEEP##"|Acctype,
,If-TRUE-Goto,checkLoan, 
  
,ParseString,type|"##KEEP##MTPUWBH"|sURL1,
,If-FALSE-Goto,skipLoan,

checkLoan,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLOC,

,ParseString,type|"##KEEP##Student Loan"|Acctype,
,If-TRUE-Goto,setTypeToSL,

,ParseString,type|"Home##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToMortgage,
                                                                                          
,ParseString,type|"MTG##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToMortgage,

,ParseString,type|"LOAN##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLoan,

,ParseString,type|"USED AUTO##KEEP##"|Acctype|test,
,If-TRUE-Goto,setTypeToLoan,

,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToMortgage,

,Goto,setTypeToLoan,

//////////////////

//  LOC

//////////////////

skipLoan,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLOC,

,ParseString,type|"MW743OZ##KEEP##"|Module_ID,
,If-TRUE-Goto,setTypeToMortgage,

,ParseString,type|"Line of Credit##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToLOC,

//////////////////

//  INVESTMENT

//////////////////

,ParseString,type|"IRA CERT ##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToInvestment,

,ParseString,type|"IRA CD##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToInvestmentIRA,
/////////////////////////////////////////////

Defaultacctype,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,setTypeToChecking,
,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 3rd Account Type for firstambank.scr"|Acctype,
,Goto,movenext,

setTypeToChecking,Assign,AccTypeID|"100",
,Goto,movenext,

setTypeToSaving,Assign,AccTypeID|"101",
,Goto,movenext,

setTypeToCD,Assign,AccTypeID|"102",
,Goto,movenext,

setTypeToCC,Assign,AccTypeID|"200",
,Goto,movenext,

setTypeToLOC,Assign,AccTypeID|"201",
,Goto,movenext,

setTypeToInvestment,Assign,AccTypeID|"309",
,Goto,movenext,

setTypeToInvestmentIRA,Assign,AccTypeID|"304",
,Goto,movenext,

setTypeToMortgage,Assign,AccTypeID|"400",
,Goto,movenext,

setTypeTomoney,Assign,AccTypeID|"103",
,Goto,movenext,

setTypeToLoan,Assign,AccTypeID|"401",
,Goto,movenext,

setTypeToSL,Assign,AccTypeID|"402",

//////////////////////////////////////////////

movenext,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,SkpAcct_Real,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,SkpAcct_Real,

//,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx", // updated on 27th Feb 2021 FIID 5343
//,If-TRUE-Goto,movetd,
                                                                   
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/e-fnb/SignIn.aspx",
,If-TRUE-Goto,movetd,
                                                                        
,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,                                                                         

,Compare,##TOWER_WEBSITE##|"http://www.anbtx.com/",
,If-TRUE-Goto,movetd,

SKIPparsing,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,skiptd,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2189/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://oceanbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Laurelroadbank/SignIn.aspx",
,If-TRUE-Goto,movetd,  

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,movetd, 

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,move3td, 
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,movetd,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,comparenum,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-FALSE-Goto,skipThisCompare,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,comparenum,

skipThisCompare,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skiptd,

move3td,MoveToTag,"td",

movetd,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-FALSE-Goto,goa_sussual, 

,Compare,AccTypeID|"401",
,If-FALSE-Goto,goa_sussual, 

,Assign,anum|aname,
,If-FALSE-Goto,nxtAccount, 
,MoveToTag,"td",
,Goto,chk_accnts,

goa_sussual,MoveToTag,"td",          

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skiptd,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,SkipSpan,                                                                                                   

skiptd,MoveToTag,"td",

,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipTdTag,

,ParseString,srore|"201##PIPE##400##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,skipTdTag,

,GetDataFromTag,|DueDate|,
,ParseString,srore|"/##KEEP##/"|DueDate,
,If-FALSE-Goto,skipTdTag,

,MoveToTag,"td"|test,

skipTdTag,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,SkipSpan,

,MoveToTag,"SPAN",
//****************
SkipSpan,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,Skip_anbtx_tower,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-FALSE-Goto,SkipTD,

Skip_anbtx_tower,GetDataFromTag,|aname|,
,RemoveHTMLTags,aname,
,MoveToTag,"td"|test,

,GetDataFromTag,|anum|,
,RemoveHTMLTags,anum,

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-TRUE-Goto,SkipTD,

,Goto,SkipSpanTag,                                                                                                  
//*******************                                                                                                  
SkipTD,GetDataFromTag,|anum|,
,RemoveHTMLTags,anum,

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-FALSE-Goto,SkipSpanTag,

,Assign,Acctype|aname,
,ParseString,type|"Checking##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,


,ParseString,type|"CKG##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,
                                                                         
,ParseString,type|"Debit Card##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,

,ParseString,type|"##KEEP##CASH FLOW"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,

,ParseString,type|"##KEEP##CHECKING"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,

,ParseString,type|"SPEND CARD##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,

,ParseString,type|"Household##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,
                                                                                                  
,ParseString,type|"##KEEP##Executive Money Market"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"##KEEP##MARKET"|Acctype,
,If-TRUE-Goto,SETTTYPEMM,



//////////////////

//  SAVING 

//////////////////



,ParseString,type|"Saving##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,
                                                                                                                                                                                                    
,ParseString,type|"HOUSE PROJECT##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"Statement##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"SVGS##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"PRIMARY SHARE##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"SHAREDRAFT##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECHECKING,

,ParseString,type|"HSA Account##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"SAVING##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,


//////////////////

//  CREDIT CARD 

//////////////////

,ParseString,type|"Credit Card##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"Visa Card##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"Nice Card##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"MasterCard Platinum Rewards##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

//////////////////

//  LOC

//////////////////

,ParseString,type|"HELOC##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOC,
,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOC,

//  INVESTMENT

//////////////////

,ParseString,type|"IRA CERT ##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPEINVEST,


//////////////////

//  LOAN //

//////////////////

,ParseString,type|"5 Year/1 Year ARM##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
  
,ParseString,type|"Fixed Rate##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
  
,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOC,

,ParseString,type|"AUTO-USED FIXED##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                         
,ParseString,type|"Conforming Fixed Rate##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN, 

,ParseString,type|"Indirect Used Vehicle##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,                                                                          
 
,ParseString,type|"Subaru##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN, 
 
,ParseString,type|"Jeep##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN, 

,ParseString,type|"Mortgage##KEEP##Student Loan"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"Do Not Use##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"emergency fund##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"HOME 10##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"Home##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPEMORT,

,ParseString,type|"2015 FORD ESCAPE##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2011 TOYOTA CAMRY##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2014 HONDA CR-V##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##BUILDER"|Acctype,
,If-TRUE-Goto,SETTTYPELOC,

,ParseString,type|"##KEEP##Quincy"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"##KEEP##Chance"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"##KEEP##Asher"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"##KEEP##SAVES"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"Do Not Use##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPESAVING,

,ParseString,type|"2016 CHEVROLET SONIC##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"LOAN##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"HOLIDAY/SUMMER##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"NEW AUTO##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"Used Auto Fixed##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"x4767-L0002##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2012 TOYOTA HIGHLANDER LTD##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"TOYOTA SIENNA##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2016 SUBARU CROSSTREK##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                         
,ParseString,type|"2015 MAZDA##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2015 FORD ESCAPE##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2014 GMC SIERRA 2500 HD##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"Used Auto##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##New Cars"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,                                                                                                

,ParseString,type|"##KEEP##MAZDA MAZDA3"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPEMORT,

,ParseString,type|"VISA##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"2015 GMC Sierra##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"GMC SIERRA##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECC,

,ParseString,type|"2015 HONDA ODYSSEY##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"MasterLine##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2011 HONDA CIVIC##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2001 coachman m305##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"2017 BMW X3##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                         
,ParseString,type|"3 Year ARM##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                         
,ParseString,type|"QWIK Cash##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,                                                                
                                                                         
,ParseString,type|"2013 FORD EDGE##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,    

,ParseString,type|"CONSOLIDATION##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,          
                                                                         
,ParseString,type|"EASY CASH##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,  
                                                                         
,ParseString,type|"2008 SUBARU IMPREZA##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"BK Fixed First##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##ES Sedan 4D"|Acctype,
,If-TRUE-Goto,SETTTYPECC,
                                                                                                  
,ParseString,type|"Residential Fixed Rate##KEEP##"|Acctype|test,
,If-TRUE-Goto,SETTTYPEMORT,                                                                                                       

,ParseString,type|"Mthly Fixed Rate##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Card"|Acctype,
,If-TRUE-Goto,SETTTYPECC,
    
,ParseString,type|"CD##KEEP##"|Acctype,
,If-TRUE-Goto,SETTTYPECD,

,ParseString,type|"##KEEP##Jet Ski"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Kelby-Carman Camper"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Pontoon"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
,ParseString,type|"##KEEP##Ice Castle"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Megan Car"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                                                  
,ParseString,type|"##KEEP##2017 MAZDA CX-9"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##FHA"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Direct-New"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,

,ParseString,type|"##KEEP##Fixed Rate greater"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,
                                                                                                  
,ParseString,type|"##KEEP##TOYOTA TACOMA"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,                                                                                                       
                                                                                                  
,ParseString,type|"##KEEP##FORD FUSION"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,  

,ParseString,type|"##KEEP##Ford"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN, 
      
,ParseString,type|"##KEEP##Dodge Charger"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN, 
                                                                                                  
 ,ParseString,type|"##KEEP##Mercedes-Benz"|Acctype,
,If-TRUE-Goto,SETTTYPELOAN,                                                                                                 

,ParseString,type|"##KEEP##House"|Acctype,
,If-TRUE-Goto,SETTTYPEMORT,            

//////////////////////////////////////////////

checkDefault,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,SETTTYPECHECKING,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 4th Account Type for firstambank.scr"|Acctype,

,Goto,SkipSpanTag,

SETTTYPECHECKING,Assign,AccTypeID|"100",

,Goto,SkipSpanTag,



SETTTYPESAVING,Assign,AccTypeID|"101",

,Goto,SkipSpanTag,

SETTTYPECD,Assign,AccTypeID|"102",

,Goto,SkipSpanTag,

SETTTYPECC,Assign,AccTypeID|"200",

,Goto,SkipSpanTag,



SETTTYPELOC,Assign,AccTypeID|"201",

,Goto,SkipSpanTag,

SETTTYPEINVEST,Assign,AccTypeID|"309",

,Goto,SkipSpanTag,



SETTTYPEMORT,Assign,AccTypeID|"400",

,Goto,SkipSpanTag,


SETTTYPEMM,Assign,AccTypeID|"103",

,Goto,SkipSpanTag,



SETTTYPELOAN,Assign,AccTypeID|"401",

//************************************************************************************

SkipSpanTag,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,SkipSpan1,

,MoveToTag,"SPAN",
,GetDataFromTag,|REAL_ACH_Number|,
,RemoveHTMLTags,REAL_ACH_Number,

SkipSpan1,ParseString,type|"x8047##KEEP##"|anum,
,If-FALSE-Goto,checkUTBTowr,

,Assign,AccTypeID|"101",

checkUTBTowr,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-FALSE-Goto,comparenum, 
,Goto,comparenum,                                                                                                  
//,MoveToTag,"td",
                                                                                                  
//,GetDataFromTag,|AccNumForStmt|,
//,AppendVars,AccNumForStmt|" ",
//,AppendVars,AccNumForStmt|aname,

//*************************************

,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-TRUE-Goto,go2AccParse,

,Compare,userid|"ecurrin42",		// CC: 28070895
,If-FALSE-Goto,comparenum,

,Compare,anum|"UNION SAVINGS",
,If-FALSE-Goto,comparenum,

go2AccParse,Left$,anum|AccNumForStmt|5|test,

,Compare,anum|"<DIV",
,If-TRUE-Goto,nxtAccount,
//*************************************

comparenum,Compare,anum|"",
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"[$]##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Account Nickname##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Checking##KEEP##Checking"|aname,
,If-TRUE-Goto,skpCheck,

,ParseString,chk|"Checking##KEEP##"|anum,
,If-TRUE-Goto,skpCheck,

,ParseString,chk|"Account##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

skpCheck,ParseString,chk|"Account Name##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,
,ParseString,chk|"Current Balance##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Account Type##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Deliver By##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Report##KEEP##"|anum,
,If-TRUE-Goto,nxtAccount,

,ParseString,chk|"Send On##KEEP##"|anum,
,If-TRUE-Goto,history,

//****************************************************                                                                         
,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipxanumcheck,
,RemoveExtraWhitespaces,anum,                                                                         
,Right$,anumcheck|anum|4,
,Assign,anum|"x",
,AppendVars,anum|anumcheck,                                                              
skipxanumcheck,NOP,,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-FALSE-Goto,skiplast4num,
,RemoveExtraWhitespaces,anum,                                                                         
,Right$,anum|anum|4,
skiplast4num,NOP,,                                                                    
//****************************************************| // Get Account Real Number Start
,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,getAcct_Real,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getAcct_Real,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,getAcct_Real,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SkpAcct_Real,

getAcct_Real,Assign,aNumReal|anum,                                         // Get Account Real Number

,FindReplace,"A"|""|aNumReal|test,
,FindReplace,"B"|""|aNumReal|test,
,FindReplace,"C"|""|aNumReal|test,
,FindReplace,"D"|""|aNumReal|test,
,FindReplace,"E"|""|aNumReal|test,
,FindReplace,"F"|""|aNumReal|test,
,FindReplace,"G"|""|aNumReal|test,
,FindReplace,"H"|""|aNumReal|test,
,FindReplace,"I"|""|aNumReal|test,
,FindReplace,"J"|""|aNumReal|test,
,FindReplace,"L"|""|aNumReal|test,
,FindReplace,"M"|""|aNumReal|test,
,FindReplace,"N"|""|aNumReal|test,
,FindReplace,"O"|""|aNumReal|test,
,FindReplace,"P"|""|aNumReal|test,
,FindReplace,"Q"|""|aNumReal|test,
,FindReplace,"R"|""|aNumReal|test,
,FindReplace,"S"|""|aNumReal|test,
,FindReplace,"T"|""|aNumReal|test,
,FindReplace,"U"|""|aNumReal|test,
,FindReplace,"V"|""|aNumReal|test,
,FindReplace,"W"|""|aNumReal|test,
,FindReplace,"X"|""|aNumReal|test,
,FindReplace,"Y"|""|aNumReal|test,
,FindReplace,"Z"|""|aNumReal|test,
,FindReplace,"-"|""|aNumReal|test,

,RemoveExtraWhitespaces,aNumReal,

//****************************************************| // Get Account Real Number End

SkpAcct_Real,NOP,

,RemoveExtraWhitespaces,anum,
,RemoveExtraWhitespaces,aname,


GOTOparsing,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-FALSE-Goto,chk_accnts,

,ParseString,type|"-S##KEEP##"|anum,
,If-FALSE-Goto,CHECKNextMortgage,

,ParseString,type|"CHECKIN##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextChecking,

,ParseString,type|"MONEY MARKET##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeNextTomoney,

,ParseString,type|"SAVING##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextSaving,

,Goto,setTypeToNextChecking,

CHECKNextMortgage,ParseString,type|"-M##KEEP##"|anum,
,If-FALSE-Goto,CHECKNextCC,

,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextMortgage,

,ParseString,type|"LOAN##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextLoan,

,ParseString,type|"LOC##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextLOC,

,Goto,setTypeToNextMortgage,

CHECKNextCC,ParseString,type|"x##KEEP##"|anum,
,If-FALSE-Goto,LOANNextacctype,

,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextMortgage,

,ParseString,type|"LOAN##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextLoan,

,Goto,setTypeToNextCC,

LOANNextacctype,ParseString,type|"-L##KEEP##"|anum,
,If-FALSE-Goto,GOTOSTANDARDacctype,

,ParseString,type|"MORTGAGE##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextMortgage,

,ParseString,type|"LINE OF CREDIT##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextLOC,

,ParseString,type|"LOAN##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextLoan,

,Goto,setTypeToNextLoan,

GOTOSTANDARDacctype,ParseString,type|"CREDIT CARD##KEEP##"|Acctype,
,If-TRUE-Goto,setTypeToNextCC,

DefaultNextacctype,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,setTypeToNextChecking,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 5th Account Type for firstambank.scr"|Acctype,

,Goto,chk_accnts,

setTypeToNextChecking,Assign,AccTypeID|"100",

,Goto,chk_accnts,



setTypeToNextSaving,Assign,AccTypeID|"101",

,Goto,chk_accnts,

setTypeToNextCD,Assign,AccTypeID|"102",

,Goto,chk_accnts,

setTypeToNextCC,Assign,AccTypeID|"200",

,Goto,chk_accnts,



setTypeToNextLOC,Assign,AccTypeID|"201",

,Goto,chk_accnts,

setTypeToNextInvestment,Assign,AccTypeID|"309",

,Goto,chk_accnts,



setTypeToNextMortgage,Assign,AccTypeID|"400",

,Goto,chk_accnts,


setTypeNextTomoney,Assign,AccTypeID|"103",

,Goto,chk_accnts,



setTypeToNextLoan,Assign,AccTypeID|"401",

                                                                                                  
chk_accnts,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-TRUE-Goto,GetdisTD, 

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-TRUE-Goto,GetdisTD, 

//,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx", // updated on 27th Feb 2021 FIID 5343
//,If-TRUE-Goto,GetdisTD, 

,ParseString,srore|"anbtx.onlinebank.com##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,chkNameNum, 
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,chkNameNum,                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,chkNameNum,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,chkNameNum,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-TRUE-Goto,chkNameNum,

,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-FALSE-Goto,chkNumOnly, 

chkNameNum,CheckAccounts,anum||||aname,
,If-FALSE-Goto,nxtAccount,
                                                                                                  
,Goto,nxtcmpr,
                                                                                                  
                                                                                                  
chkNumOnly,CheckAccounts,anum,
,If-TRUE-Goto,nxtcmpr,
                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,chknxtAccount,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,chknxtAccount,

                                                                     
,Goto,nxtAccount,


nxtcmpr,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx", 
,If-TRUE-Goto,continue,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,continue,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-FALSE-Goto,skipThisNorthWest,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,continue,

skipThisNorthWest,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,continue,

//********************
GetdisTD,MoveToTag,"td"|test,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-FALSE-Goto,Skpblwappnd,

,GetDataFromTag,|Suffix|,
,AppendVars,anum|"-",
,AppendVars,anum|Suffix,

,CheckAccounts,anum||||aname,
,If-FALSE-Goto,nxtAccount,
                                                                                                  
Skpblwappnd,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx", 
,If-TRUE-Goto,checkThis,
,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx", 
,If-TRUE-Goto,checkThis,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx", 
,If-TRUE-Goto,checkThis,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx", 
,If-TRUE-Goto,checkThis,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-TRUE-Goto,Mov1moreTD,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",     
,If-FALSE-Goto,SKP_Balance_Check,

,GetDataFromTag,|temp_Balance|,
,RemoveHTMLTags,temp_Balance,

,ParseString,srore|"##KEEP##%"|temp_Balance,
,If-TRUE-Goto,Mov1moreTD,

SKP_Balance_Check,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com", 
,If-FALSE-Goto,skiptd1,

Mov1moreTD,MoveToTag,"td",

checkThis,Compare,AccTypeID|"200",
,If-TRUE-Goto,skipThisCheck,

,Compare,AccTypeID|"201",
,If-TRUE-Goto,skipThisCheck,

,Compare,aname|"2001 coachman m305",
,If-TRUE-Goto,skipThisCheck2,

,Compare,aname|"2013 FORD EDGE",
,If-TRUE-Goto,skipThisCheck2,

,Compare,AccTypeID|"401",
,If-TRUE-Goto,skipThisCheck,

skiptd1,Compare,aname|"Used Auto Fixed",
,If-TRUE-Goto,skipThisCheck,
                                       
,Compare,aname|"New Auto",
,If-TRUE-Goto,skipThisCheck,                                                                         

,Compare,aname|"2012 TOYOTA HIGHLANDER LTD",
,If-TRUE-Goto,skipThisCheck,

,Compare,aname|"2002 Mazda Protege ES Sedan 4D",
,If-TRUE-Goto,skipThisCheck,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,SKP_401Bal,

,Compare,AccTypeID|"401",
,If-TRUE-Goto,getBal,

SKP_401Bal,Compare,CountAccLayout|2,
,If-TRUE-Goto,skipThisCheck2,

,Compare,aname|"Line of Credit",
,If-TRUE-Goto,skipThisCheck2,

,Compare,aname|"LOC",
,If-FALSE-Goto,getBal,

,Compare,aname|"MasterCard Platinum Rewards",
,If-FALSE-Goto,getBal,

skipThisCheck,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com", 
,If-TRUE-Goto,skipThisCheck2,

,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx", 
,If-TRUE-Goto,skipThisCheck2,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx", 
,If-TRUE-Goto,skipThisCheck2,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",  		// FI ID: 11688 
,If-TRUE-Goto,getBal,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx", 
,If-TRUE-Goto,skipThisCheck2,

,MoveToTag,"td",
skipThisCheck1,MoveToTag,"td",
skipThisCheck2,MoveToTag,"td",

getBal,ParseString,srore|"3185##KEEP##"|institutionId,
,If-FALSE-Goto,SkipLedgerBalance,

,GetURL,"https://oceanbank.onlinebank.com/Accounts/AccountActivity.aspx"||test,
,FindString,"Account History:"|test,
,If-FALSE-Goto,previousPage,  
,FindString,anum|test,
,If-FALSE-Goto,previousPage,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,previousPage,    
,GetDataFromTag,acctBalValue||"value",
,ExtractFromRawPage,actValue1|"<SELECT name="##KEEP##" id="|test, //"
,ParseString,actValue|"[$]PCDZ[$]##KEEP##[$]ctl00[$]"|actValue1,

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM1|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM1|test,

,ExtractFromRawPage,__VIEWSTATEID1|"__VIEWSTATEID" value="##KEEP##""|test,//"

,ExtractFromRawPage,__EVENTVALIDATION1|"__EVENTVALIDATION" value="##KEEP##""|test,//"

,CreateForm,"balanceForm"|"https://oceanbank.onlinebank.com/Accounts/AccountActivity.aspx",

,Assign,AccountNickName|"M$layout$content$PCDZ$XXXXXX$ctl00$AccountNickName",
,Assign,selectedAccount|"M$layout$content$PCDZ$XXXXXX$ctl00$selectedAccount",
,Assign,ClearedDateChoices|"M$layout$content$PCDZ$XXXXXX$ctl00$ClearedDateChoices",
,Assign,calFromDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calFromDate$TB",
,Assign,calToDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calToDate$TB",
,Assign,transactionTypes|"M$layout$content$PCDZ$XXXXXX$ctl00$transactionTypes",
,Assign,description|"M$layout$content$PCDZ$XXXXXX$ctl00$description",
,Assign,checkNumber|"M$layout$content$PCDZ$XXXXXX$ctl00$checkNumber",
,Assign,amount|"M$layout$content$PCDZ$XXXXXX$ctl00$amount",
,Assign,endAmount|"M$layout$content$PCDZ$XXXXXX$ctl00$endAmount",
,Assign,search|"M$layout$content$PCDZ$XXXXXX$ctl00$search",

,FindReplace,"XXXXXX"|actValue|AccountNickName|test,
,FindReplace,"XXXXXX"|actValue|selectedAccount|test,
,FindReplace,"XXXXXX"|actValue|ClearedDateChoices|test,
,FindReplace,"XXXXXX"|actValue|calFromDate|test,
,FindReplace,"XXXXXX"|actValue|calToDate|test,
,FindReplace,"XXXXXX"|actValue|transactionTypes|test,
,FindReplace,"XXXXXX"|actValue|description|test,
,FindReplace,"XXXXXX"|actValue|checkNumber|test,
,FindReplace,"XXXXXX"|actValue|amount|test,
,FindReplace,"XXXXXX"|actValue|endAmount|test,
,FindReplace,"XXXXXX"|actValue|search|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM1|"balanceForm",
,SetPostURLData,"__EVENTTARGET"|""|"balanceForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"balanceForm",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"balanceForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID1|"balanceForm",
,SetPostURLData,"__VIEWSTATE"|""|"balanceForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION1|"balanceForm",	

,SetPostURLData,AccountNickName|aname|"balanceForm",
,SetPostURLData,selectedAccount|acctBalValue|"balanceForm",
,SetPostURLData,ClearedDateChoices|"60"|"balanceForm",
,SetPostURLData,calFromDate|""|"balanceForm",
,SetPostURLData,calToDate|""|"balanceForm",
,SetPostURLData,transactionTypes|"none_selected"|"balanceForm",
,SetPostURLData,description|""|"balanceForm",
,SetPostURLData,checkNumber|""|"balanceForm",
,SetPostURLData,amount|""|"balanceForm",
,SetPostURLData,endAmount|""|"balanceForm",
,SetPostURLData,search|"1"|"balanceForm",

,PostURL,"https://oceanbank.onlinebank.com/Accounts/AccountActivity.aspx"||"balanceForm",

,FindString,"Ledger:"|test,
,If-FALSE-Goto,previousPage,

,MoveToTag,"td",
,GetDataFromTag,|abal|,
,ConvertToValidDollar,abal,

,ReturnToPreviousPage,2,
,Goto,skipThisCheck22,

previousPage,ReturnToPreviousPage,2,
,Goto,SkipAvailBal,  
  
SkipLedgerBalance,Compare,institutionId|"1066",
,If-FALSE-Goto,SkipAvailBal,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##KEEP##"|AccTypeID,
,If-FALSE-Goto,SkipAvailBal,

,GetDataFromTag,|availablebal|,
,RemoveHTMLTags,availablebal,
,FindReplace,":"|""|availablebal|test,
,ConvertToValidDollar,availablebal|test,

,MoveToTag,"td"|test, 
,GetDataFromTag,|abal|,
,RemoveHTMLTags,abal,
,FindReplace,":"|""|abal|test,
,Goto,SkpNxtavailBalPost,


SkipAvailBal,GetDataFromTag,|abal|,
,RemoveHTMLTags,abal,
,FindReplace,":"|""|abal|test,

,Compare,institutionId|"4399",
,If-TRUE-Goto,parseabal,

skipThisCheck22,MoveToTag,"td"|test, 

,Compare,institutionId|"5420",
,If-FALSE-Goto,skipBelowScrape,

,GetDataFromTag,classval|availablebal|"class",

,ParseString,srore|"&nbsp;##KEEP##"|availablebal|test,
,If-TRUE-Goto,GetAvBal,

,ParseString,srore|"<A href##KEEP##"|availablebal|test,
,If-FALSE-Goto,skipAvBal,

GetAvBal,Assign,availablebal|"",

skipAvBal,Compare,classval|"push-right",
,If-TRUE-Goto,gotoThisBal,  

,MoveToTag,"td"|"REV"|test,
,Goto,parseabal,  
  
skipBelowScrape,GetDataFromTag,|availablebal|,
gotoThisBal,RemoveHTMLTags,availablebal,  
,FindReplace,":"|""|availablebal|test,

,ConvertToValidDollar,availablebal|test,
,If-FALSE-Goto,parseabal,
  
SkpNxtavailBalPost,Compare,availablebal|"",
,If-FALSE-Goto,parseabal,
ASSIGNTHISBAl,Assign,availablebal|"0.0",				  

parseabal,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx", 
,If-FALSE-Goto,SkipthisAssgnBal,
                                                                                                  
,Compare,AccTypeID|"201",
,If-FALSE-Goto,SkipthisAssgnBal,                                                                                                    
,Assign,abal|availablebal,                                                                                                  
                                                                                                  
SkipthisAssgnBal,ParseString,abal1|"##KEEP##Available"|abal,
,If-FALSE-Goto,Nextcheck,
,Assign,abal|abal1,
,Goto,convert,                                                                         

Nextcheck,ParseString,abal1|"[$]##KEEP##[$]"|abal,
,If-FALSE-Goto,NextcheckThis,
,Assign,abal|abal1,
,Goto,convert,                                                                         
                                                                         
NextcheckThis,ParseString,abal1|"##KEEP##[/]"|abal,
,If-FALSE-Goto,convert,
,MoveToTag,"td",
,GetDataFromTag,|abal|,

convert,ConvertToValidDollar,abal|test,

,Compare,userid|"balancedproposal",
,If-FALSE-Goto,goACC,

,Compare,userid|"balancedproposal",
,If-FALSE-Goto,goACC,

,Compare,anum|"xxxxxx2066",
,If-FALSE-Goto,goACC,

,Assign,AccTypeID|"200",

goACC,Compare,abal|"0.0",
,If-TRUE-Goto,skpneg,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,Goneg,

,Compare,AccTypeID|"201",
,If-TRUE-Goto,Goneg,

,Compare,AccTypeID|"400",
,If-TRUE-Goto,Goneg,

,Compare,abal|"",
,If-FALSE-Goto,skipzero,

,Assign,abal|"0.0",
,Goto,Goneg,


skipzero,Compare,AccTypeID|"401",

,If-FALSE-Goto,skpneg,

Goneg,AppendVars,abal|"-",

,Compare,abal|"0.0",
,If-TRUE-Goto,skpneg,

skpneg,ConvertToValidDollar,abal|test,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx", 	//FI 1066
,If-FALSE-Goto,continue,

,MoveToTag,"td"|test,
,If-FALSE-Goto,continue,

,GetDataFromTag,|ACCTPLAN|,

,ParseString,srore|"ACCTPLAN=Regular Checking##KEEP##"|ACCTPLAN,
,If-FALSE-Goto,continue,

,Assign,AccTypeID|"100",

continue,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DntSkpThsCHECK,

,Compare,institutionId|"5420",
,If-TRUE-Goto,DntSkpThsCHECK,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SkpThsCHECK,

DntSkpThsCHECK,FindReplace,"##COMMA##"|""|availablebal|test,


,Compare,AccTypeID|"200",
,If-TRUE-Goto,Gotoneg,


,Compare,AccTypeID|"201",
,If-TRUE-Goto,Gotoneg,


,Compare,AccTypeID|"400",
,If-TRUE-Goto,Gotoneg,

,Compare,availablebal|"",
,If-FALSE-Goto,skipasgnzero,

,Assign,abal|"0.0",
,Goto,Gotoneg,

skipasgnzero,Compare,AccTypeID|"401",
,If-FALSE-Goto,skpnegbal,

Gotoneg,AppendVars,availablebal|"-",

,Compare,availablebal|"0.0",
,If-TRUE-Goto,skpneg,

skpnegbal,ConvertToValidDollar,availablebal|test,


SkpThsCHECK,Compare,institutionId|"3185",
,If-FALSE-Goto,SkipMoreThan10Accounts,

,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,SkipMoreThan10Accounts,

,CompareNumbers,account|10|=,
,If-FALSE-Goto,SkipMoreThan10Accounts,

PromptQues,AddQuestion,AnsChoice|"Do You wish to add remaining accounts",

,AddAnswerChoice,"Yes"|"Yes",
,AddAnswerChoice,"No"|"No",
,WaitForAnswers,

,Compare,AnsChoice|"No",
,If-TRUE-Goto,history,

SkipMoreThan10Accounts,ExtractFromRawPage,MaskedAccNumber|"instUserId [=] [']##KEEP##[']"|test,
,If-FALSE-Goto,SkipDisLogic,

,AppendVars,MaskedAccNumber|"-",


,AppendVars,MaskedAccNumber|Suffix,
,Goto,SKipDisLogic_2,

SkipDisLogic,Compare,aNumReal|"",
,If-TRUE-Goto,SKipDisLogic_2,

,Assign,MaskedAccNumber|aNumReal,

SKipDisLogic_2,Add,account|1,

,Assign,sURL1Flag|"TRUE",

,Compare,institutionId|"5420",
,If-FALSE-Goto,setNewURL,

,SetReturnData,sURL|sURL|account,

,Goto,skipSetNewURL,

setNewURL,SetReturnData,sURL1|sURL1|account,

skipSetNewURL,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|account,

,SetReturnData,AccURL|AccURL|account,

,Compare,institutionId|"11142",
,If-TRUE-Goto,SkipMaskAccLogic,

,Compare,institutionId|"4566",
,If-TRUE-Goto,SkipMaskAccLogic,

,Compare,institutionId|"12590",
,If-TRUE-Goto,SkipMaskAccLogic,
 
,Compare,MaskedAccNumber|"",
,If-TRUE-Goto,skipAssignMaskNumNew,

,ParseString,AfterCol|"[-]##PIPE##[:]##PIPE##[A-Z]##KEEP##"|MaskedAccNumber,
,If-FALSE-Goto,Alter4,

,GetLength,AfterCol|AfterCol|test,

,Compare,AfterCol|1,
,If-FALSE-Goto,Checklen2,

,Right$,MaskedAccNumber|MaskedAccNumber|6,
,Goto,SkipAlterNumb,

Checklen2,Compare,AfterCol|2,
,If-FALSE-Goto,Checklen3,

,Right$,MaskedAccNumber|MaskedAccNumber|7,

,Goto,SkipAlterNumb,

Checklen3,Compare,AfterCol|3,
,If-FALSE-Goto,Checklen4,

,Right$,MaskedAccNumber|MaskedAccNumber|8,
,Goto,SkipAlterNumb,

Checklen4,Right$,MaskedAccNumber|MaskedAccNumber|9,
,Goto,SkipAlterNumb,

Alter4,GetLength,MaskedNumber_length|MaskedAccNumber,

,CompareNumbers,MaskedNumber_length|5|>=,
,If-FALSE-Goto,SkipMaskAccLogic,

,Right$,MaskedAccNumber|MaskedAccNumber|5,
,Goto,SkipAlterNumb,

SkipMaskAccLogic,Right$,MaskedAccNumber|anum|4,

SkipAlterNumb,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|account,

skipAssignMaskNumNew,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-FALSE-Goto,skpAccNumForStmt,
,Assign,AccNumForStmt|"",
,AppendVars,AccNumForStmt|anum,
,AppendVars,AccNumForStmt|" ",
,AppendVars,AccNumForStmt|aname,

,SetReturnData,AccNumForStmt|AccNumForStmt|account,
//*************************| ACH Set Details Start |*************************
skpAccNumForStmt,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-FALSE-Goto,goooRNum,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingN|account,                // Set Routing Number
,Goto,SkpACH,

,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,goooRNum,

,SetReturnData,achURL|achURL|account,                
,Goto,SkpACH,

goooRNum,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,SkpACH,
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,SkpACH,
,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,SkpACH,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,goRNum,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,goRNum,
                                                                   
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-TRUE-Goto,goACHReturn,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-FALSE-Goto,SkpACH,

goRNum,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-FALSE-Goto,goo_RRNum

,Compare,AccTypeID|"401",
,If-TRUE-Goto,SkpACH, 

,Compare,AccTypeID|"200",
,If-TRUE-Goto,SkpACH, 

goo_RRNum,Compare,AccTypeID|"401",
,If-TRUE-Goto,SkpACH, 

,Compare,AccTypeID|"200",
,If-TRUE-Goto,SkpACH, 

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingN|account,                              // Set Routing Number

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|aNumReal|account,                  // Set Account Real Number
,Goto,SkpACH,

goACHReturn,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|anum|account,               // Set Account Real Number
,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingN|account,
//*************************| ACH Set Details End   |*************************

SkpACH,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-TRUE-Goto,DntSkpSetReturn,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,SkpParse,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,Set_Return,
,Goto,SkpParse,

DntSkpSetReturn,ParseString,srore|"100##PIPE##101##KEEP##"|AccTypeID,
,If-FALSE-Goto,Set_Return,

SkpParse,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|availablebal|account,
,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|abal|account,  

,Goto,Set_Type_ID,

Set_Return,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,VerifyLOC,

,Compare,availablebal|"",
,If-TRUE-Goto,Set_Type_ID,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  

,Goto,Set_Type_ID,

VerifyLOC,ParseString,srore|"200##PIPE##201##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,Set_Type_ID,

,Compare,availablebal|"",
,If-TRUE-Goto,Set_Type_ID,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_LOC:CREDIT_AVAILABLE_AMOUNT##|availablebal|account,  

Set_Type_ID,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,GoComp1,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_number|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|REAL_ACH_Number|account,

GoComp1,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DNTSKPCheck,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SKP_Check,

DNTSKPCheck,Compare,##REQUEST##|"AGGREGATION", 
,If-TRUE-Goto,chknxtAccount,

SKP_Check,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,commandbank_nxtAccount,


,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,FndnxtAccount2,

commandbank_nxtAccount,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,nxtAccount,

,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,chknxtAccount,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,FndnxtAccount2,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,chknxtAccount,


,Goto,nxtAccount,

//*************************

// Aggregation Section

//*************************

history,Compare,##SINGLE_SESSION_STATE##|"",
,If-FALSE-Goto,lblHandleSingleSession,

,Compare,##REQUEST##|"DISCOVERY", 
,If-TRUE-Goto,lblACH2Layout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD", 
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Compare,account|0,
,If-TRUE-Goto,logout,

,Assign,hIndex|0,


NextHisAcct,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Assign,trans|0,
,Add,hIndex|1,

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",

,GetReturnData,AccURL|AccURL|hIndex,

,Compare,institutionId|"5420",
,If-FALSE-Goto,getNewURL,

,GetReturnData,sURL|sURL|hIndex,

,Goto,skipGetNewURL,

getNewURL,GetReturnData,sURL1|sURL1|hIndex,
skipGetNewURL,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

,Compare,institutionId|"4399",
,If-FALSE-Goto,skipNextHisAcct,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,NorthwestCreditCardLayout,

skipNextHisAcct,Compare,accRealNumber|"",
,If-TRUE-Goto,skpFull_RealNumber,

,GetReturnData,accRealNumber|accRealNumber|hIndex,

skpFull_RealNumber,Compare,fullAccountNumber|"",
,If-TRUE-Goto,skpFull_NUMBER,

,GetReturnData,fullAccountNumber|fullAccountNumber|hIndex,

skpFull_NUMBER,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipACHGet,

,SetReturnData,achURL|achURL|hIndex,  

,GetReturnData,achURL|achURL|hIndex,

,GetURL,achURL|,

,FindString,"Routing Number"|test,
,If-FALSE-Goto,SkipACHGet,


,MoveToTag,"span",
,GetDataFromTag,|BANKID|,
,RemoveHTMLTags,BANKID,

,FindString,aname|test,
,If-FALSE-Goto,SkipACHGet,

,MoveToTag,"td",
,GetDataFromTag,|realNum|,
,RemoveHTMLTags,realNum,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|realNum|hIndex,
,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|BANKID|hIndex,


SkipACHGet,ParseString,srore|"CustomEZCardSSO##KEEP##"|sURL1,
,If-TRUE-Goto,NewEZCardInfo,

,ParseString,srore|"MyCardInfo##KEEP##"|sURL1,
,If-TRUE-Goto,NewMyCardInfo,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,GoForCompare,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,GoForCompare,

,MoveToTopOfPage,,


,FindString,"Credit Cards"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,CCURL||"href",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",

,GetURL,CCURL|,

findAccountName,FindString,aname|test,
  
,MoveToTag,"a"|"REV",
,GetDataFromTag,CCURL1||"href",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",
,GetURL,CCURL1|,

,Goto,NewMYCardInfoCheck,

GoForCompare,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                       
,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,CSVLayout,

,Compare,institutionId|"12489",
,If-TRUE-Goto,CSVLayout,

,Compare,institutionId|"10771",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,   

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",  // FI ID: 15216
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",  
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-TRUE-Goto,CheckthisHist,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-TRUE-Goto,CheckthisHist,   

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-TRUE-Goto,CheckthisHis1,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,                                                                                                                             

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,WebConnectttt,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,                                                                       
                                                                         
,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
     
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Laurelroadbank/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",   
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2189/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,
,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
          
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com/",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                                               
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/e-fnb/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,NewManualLayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fairfieldfederal/signin.aspx",
,If-TRUE-Goto,NewManualLayout,                                                                                                  

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,CSVLayout,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout, 

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectttt,
                                                                                 
,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",		// FI ID: 11688 
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/GreeceCommunityFCU/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-TRUE-Goto,NewManualLayout,
 
,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,                                                                         

,Compare,##TOWER_WEBSITE##|"https://dime.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,                                                                         

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,  
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewManualLayout,                                                                                                    

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-TRUE-Goto,NewManualLayout,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,CSVLayout,
                                                          
,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-TRUE-Goto,CSVLayout,


,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,
                                                                         
,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://bossierfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://oceanbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://fsb.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-TRUE-Goto,WebConnectttt,

//**************************************************
,Compare,AccTypeID|"200",
,If-TRUE-Goto,CSVLayout,

,Compare,AccTypeID|"401",
,If-FALSE-Goto,SkipCSVLayout,

SkipCSVLayout,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
                                                                                                  
,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,                                                                                                  

//***********************************************

,MoveToTopOfPage,,

,FindString,">Export"|test,


,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,NextHisAcct,

,GetDataFromTag,exporturl||"href",


,GetURL,exporturl|,


,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,


,FindString,aname|test,

,If-FALSE-Goto,NextHisAcct,



,MoveToTag,"option"|"REV",

,GetDataFromTag,selectedAcc||"value",



,SetPostURLData,"M$layout$content$PCDZ$MG157W4$ctl00$accountDropDown"|selectedAcc,

,SetPostURLData,"M_layout_content_PCDZ_MG157W4_ctl00_calStartDate_DP_dateInput_text"|sdate,

,SetPostURLData,"M_layout_content_PCDZ_MG157W4_ctl00_calEndDate_DP_dateInput_text"|edate,

,SetPostURLData,"M$layout$content$PCDZ$MG157W4$ctl00$quickenWebConnectButton.x"|"49",

,SetPostURLData,"M$layout$content$PCDZ$MG157W4$ctl00$quickenWebConnectButton.y"|"14",

,PostURL,||,



,FindSignature,">No transactions found for specified date range",

,If-TRUE-Goto,NextHisAcct,



,GetStatementFromOFX,hIndex||##STARTDATE##|##ENDDATE##,


,Goto,NextHisAcct



history2,GetURL,"https://secure.myvirtualbranch.com/ProvidentBankOnline/AccountActivity.aspx"|,



,GetURL,"https://secure.myvirtualbranch.com/ProvidentBankOnline/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx"|,

,Goto,Skiphis,

skipManual,NOP,
SKP_Assign3,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-FALSE-Goto,SKP_Assign2,

,Assign,QuickenURL|"https://secure.myvirtualbranch.com/Equitablebank/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx",
,Goto,SKP_Assign1,

SKP_Assign2,Assign,QuickenURL|"https://secure.myvirtualbranch.com/Ionmybanking/8ed1c170-34ed-40a2-8a64-ad615a41cf28.aspx",
SKP_Assign1,GetURLv2,QuickenURL|,

,Goto,Skiphis,



history1,GetURL,"https://secure.myvirtualbranch.com/banknbsb5814/AccountActivity.aspx"|,



,GetURL,"https://secure.myvirtualbranch.com/banknbsb5814/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx"|,


//**************************OFX Posting FOR FI 8105***************************************

Skiphis,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|hIndex,

,FindString,anum|test,

,MoveToTag,"option"|"REV",

,GetDataFromTag,OPTION||"value",
,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"

,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-FALSE-Goto,skip_tsm,

tsmEXtract,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,

,Goto,get_state_id,


skip_tsm,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:fa6755fd-da1a-49d3-9eb4-1e473e780ecd:ea597d4b:b25378d2",

get_state_id,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,

,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlAccount"|OPTION|,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-FALSE-Goto,SKP_Post,

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$FromDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ToDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"16",
,Goto,SKP_DateRange,


SKP_Post,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"60"|,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"1"|,

SKP_DateRange,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$btnDownload"|"Download"|,

,Goto,post_direct,


postviewState,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,

,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlAccount"|OPTION|,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"60"|,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"12"|,

,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$btnDownload"|"Download"|,

post_direct,PostURL,||,

,Compare,userid|"ctblondi414",
,If-FALSE-Goto,get_header,

,StoredHTTPResponse,,
  
get_header,FindSignature,"OFXHEADER",
,If-TRUE-Goto,skipThisLog1,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",
,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,
,Goto,NextHisAcct


skipThisLog1,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,skipZeroLogs,

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

skipZeroLogs,Goto,NextHisAcct



//############################################################	

logout,Compare,##REQUEST##|"DISCOVERY",    
,If-FALSE-Goto,continueError106,

,Compare,account|0,
,If-FALSE-Goto,continueError106,

,Assign,LogMsg|"Error 911 in",
,AppendVars,LogMsg|##REQUEST##,
,AppendVars,LogMsg|" for Customer ID ",
,AppendVars,LogMsg|customerId,
,AppendVars,LogMsg|" and Institution ID ",
,AppendVars,LogMsg|institutionId,
,AppendVars,LogMsg|" and Partner ID ",
,AppendVars,LogMsg|partnerId,

,Log,ALERT|"User specific issue or FI partially broken or FI completely broken and it is Existing.Script:- firstambank.scr"|LogMsg,

,StoredHTTPResponse,,

,Exit,911|"User specific issue or FI partially broken or FI completely broken and it is Existing",

continueError106,Compare,account|0,
,If-TRUE-Goto,Error106,

//*****************************************************************************
//                     SINGLE SESSION REQUEST TYPE LOGIC
//*****************************************************************************
lblHandleSingleSession,SetReturnData,__NUMACCOUNTS__*|account,

,Compare,##SINGLE_SESSION_STATE##|"SINGLE_SESSION_DISCOVERY",
,If-FALSE-Goto,lblACHSingleSession,
,ContinueSingleSession,,

lblACHSingleSession,NOP,,
,Compare,##SINGLE_SESSION_STATE##|"SINGLE_SESSION_ACH",
,If-FALSE-Goto,lblSingleSessionLogout,
,Goto,lblACH2Layout,

lblContinueSingleSession,NOP,,
,Compare,##SINGLE_SESSION_STATE##|"",
,If-TRUE-Goto,lblExit,

,ContinueSingleSession,,

lblSingleSessionLogout,NOP,,
,Compare,##SINGLE_SESSION_STATE##|"SINGLE_SESSION_LOGOUT",
,If-FALSE-Goto,lblExit,

lblExit,NOP,,

//**********************************************************************************************************

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",  // FI ID: 4987
,If-FALSE-Goto,SouthwestAirlinesFCU,

,GetURL,"https://www.myswacu.org/logout.aspx"|,
,Goto,goSet,

SouthwestAirlinesFCU,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",  // FI ID: 4220
,If-FALSE-Goto,skpubtgo,

,GetURL,"https://ubtgo.ubt.com/UBT/Accounts/logoff.aspx"|,
,Goto,goSet,

skpubtgo,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-FALSE-Goto,skpallsouthlog,

,GetURL,"https://allsouth.onlinebank.com/LoggedOut.aspx"|,
,Goto,goSet,

skpallsouthlog,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Newgolog115,

,GetURL,"https://ulstersavings.onlinebank.com/logoff.aspx"|,

,Goto,goSet,


Newgolog115,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Newgolog112,

,GetURL,"https://valleystar.onlinebank.com/logoff.aspx"|,

,Goto,goSet,


Newgolog112,NOP,


Newgolog1,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,Newgolog_realtorsfcu,

,GetURL,"https://ebanking.realtorsfcu.org/2126/Accounts/logoff.aspx"|,

,Goto,goSet,

Newgolog_realtorsfcu,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-FALSE-Goto,skip2269,

,GetURLv2,"https://my.communityfirstcu.org/LoggedOut.aspx"|,
,Goto,goSet,

skip2269,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipflushingbank,

,GetURLv2,"https://www.flushingbank.com/"|,
,Goto,goSet,
    
  
skipflushingbank,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",     // FI ID: 5061 
,If-FALSE-Goto,SkipGesaCU,


,GetURLv2,"https://onlinexpress.gesa.com/Banking/Accounts/logoff.aspx"|,
,Goto,goSet,

SkipGesaCU,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",     // FI ID: 7664 
,If-FALSE-Goto,SkipParkNational,

,GetURLv2,"https://parknational.onlinebank.com/LoggedOut.aspx"|,
,Goto,goSet,

SkipParkNational,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-FALSE-Goto,Skipsdccubank,


,GetURLv2,"https://ib.sdccu.com/SDCCU/Accounts/logoff.aspx"|,
,Goto,goSet,


Skipsdccubank,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skip5343,
  
,Assign,tlsv1_2|"TLSv1.2",
,SetSSLProtocols,tlsv1_2,
  
  
skip5343,GetURL,logoutURL|,
goSet,SetReturnData,__NUMACCOUNTS__*|account,
,Exit,OK|"Script completed successfully!",


//************************
// Error Section
//************************

errorRetry,Exit,RETRY|"Site is down!"|line,
errorMFA,Exit,187|"Incorrect answer to Challenge Question"|line,
Error906,Exit,906|"MFA QUESTION ANSWER HAS TO BE CAPTURED",
errorLogin,Exit,ERROR_LOGON|"User ID/Password is Blank"|line,
Error103,Exit,103|"Undefined Username or Password field"|line,
errorLogon2,Exit,ERROR_LOGON|"Your account access is locked."|line,
errorLogon1,Exit,ERROR_LOGON|"You've entered an invalid User ID or Password. Please try again."|line,
errorLogon,Exit,ERROR_LOGON|"Your request was not successful because the UserID and/or Password your entered is not recognized as valid."|line,
error_userAction,Exit,ERROR_REQ_USER_ACTION|"User needs to read the agreement"|line,
Error106,Exit,106|"No Account Found",
generalErr,Exit,101|"General Error",
Useraction_108,Exit,ERROR_REQ_USER_ACTION|"User action required",
Error108,Exit,ERROR_REQ_USER_ACTION|"enroll an account in e-Statements.",
Error108_1,Exit,ERROR_REQ_USER_ACTION|"Steps required to reconnect Quicken or Quickbooks account",
Error109,Exit,109|"Need to change the password"|line,
Error101,Exit,101|"OTP call section needs to be implemented",
Error900,Exit,900|"Existing RFNI with Failing Accounts",
Error961,Exit,961|"Enrollment Required for Paperless Statement/Activate Electronic Statement",
PDF961,Exit,961|"Registration Required to Download PDF.",
Error960,Exit,960|"Electronic Statement is not available for the requested account",
Error907,Exit,907|"Need to cpture page after OTP.",
Error940,Exit,940|"FI is disabled & not supported",
error102,Exit,RETRY|"System is unavailable at this time. Please try again later.",
error961,Exit,961|"Enrollment Required for Paperless Statement/Activate Electronic Statement",
error960,Exit,960|"Electronic Statement is not available for the requested account",
error914,Exit,914|"No accounts to be displayed.",
Error927,Exit,927|"Production IPs blocked by FI",
Error924,Exit,924|"Google Captcha Not Supported", 
Error928,Exit,928|"You are being rate limited. FI has banned you temporarily",
//************************************************
//  New Manual Layout For Aggregation Section 
//************************************************
NewManualLayout,MoveToTopOfPage,,

,Assign,pageIndex|2,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CheckthisHist,

,FindString,">Account Activity<"|test,
,If-TRUE-Goto,goContne,

,ReturnToPreviousPage,,
,Goto,NewManualLayout,

goContne,MoveToTag,"a"|"REV",
,GetDataFromTag,aggrURL||"href",

,GetURLv2,aggrURL|,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx"|
,If-TRUE-Goto,SkipFind,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,SkipFind,

//************************************************************************************
come_here,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,SkipFind,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,SkipFind,

,FindString,">Quicken<"|test,
,If-TRUE-Goto,skipManual,

SkipFind,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,FindString,"Account History:"|test,

SkipFSt,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com"|
,If-TRUE-Goto,FindName, 

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx"|
,If-TRUE-Goto,FindName, 

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx"|
,If-TRUE-Goto,FindName, 

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx"|
,If-TRUE-Goto,FindName, 
                        
,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx"|
,If-TRUE-Goto,Findanum, 
                        
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx"|
,If-TRUE-Goto,FindName, 

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx"|
,If-TRUE-Goto,FindName, 
                        
Findanum,FindString,anum|test,
,If-TRUE-Goto,optionTag,

FindName,FindString,aname|test,
,If-TRUE-Goto,optionTag, 
                        
,Assign,tempAccNameVar|aname,
                        
,FindReplace,"'"|"&#39;"|tempAccNameVar|test, 
                        
,FindString,tempAccNameVar|test,
                        
optionTag,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,acctValue||"value",

get_TSM,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-TRUE-Goto,newposting,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,newposting,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-TRUE-Goto,newposting,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,newposting,
,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx"|
,If-TRUE-Goto,newposting, 

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-TRUE-Goto,post_other,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NEWOFXLAYOUT,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,ExtractFromRawPage,aname1|"name="M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName" type="text" autocomplete="off" value="##KEEP##""|test,

post_other,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname,

,Compare,institutionId|"12590",
,If-TRUE-Goto,checkOtherDateposting,

,Compare,institutionId|"7175",
,If-FALSE-Goto,GoToDatechoice,   
checkOtherDateposting,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,Goto,Skip60dayslogic,
  
GoToDatechoice,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"60",
Skip60dayslogic,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
post_now,PostURL,||,

,Compare,institutionId|"12590",
,If-FALSE-Goto,skip180Days,

,FindSignature,"Please enter a date range between",
,If-FALSE-Goto,skip180Days,

,RollDate,##NOW##|sdate|DAY|-180|test,    		          //When FI provides only 6 Months Transactions
,ConvertDateToText,##ENDDATE##|edate|"yyyy-MM-dd",
,CompareDates,##STARTDATE##|edate|>,
,If-TRUE-Goto,checkthisfirst2,

,CompareDates,sdate|##STARTDATE##|>,
,If-TRUE-Goto,checkAgain2,

,Assign,sdate|##STARTDATE##,

checkthisfirst2,Goto,NextHisAcct,

checkAgain2,ConvertDateToText,sdate|sdate|"MM/dd/yyyy",
,ConvertDateToText,edate|edate|"MM/dd/yyyy",

,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
,PostURL,||,

skip180Days,NOP,,

,Goto,fndsgnature,


newposting,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname,
,PostURL,||,

fndsgnature,FindSignature,"There are no transactions within the specified dates.",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,"No transactions matched your search.",
,If-TRUE-Goto,NextHisAcct, 

,FindSignature,"There are no Transactions to display",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,"There is no account activity",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,">NO ACTIVITY<",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,"Account Activity is not available",
,If-TRUE-Goto,NextHisAcct,

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,
                        
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-TRUE-Goto,CSVLayout,              

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,                     
                      
,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",	//FI 12590
,If-TRUE-Goto,CSVLayout,
//============================================================================
//                 Manual Scrapping Transactions Layout
//============================================================================
//=========================================
//    ACH Layout If they are present at the FI
//=========================================
,Assign,accountRealNum|"",
,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",
                        
,FindSignature,">Show/Hide<",
,If-FALSE-Goto,SkipACHLayout,

,FindString,"Routing Number:"|test,
,If-FALSE-Goto,getAccFullNumber,
                        
,MoveToTag,"td"|test,
,GetDataFromTag,|RoutingN|,
,RemoveHTMLTags,RoutingN,

,Compare,RoutingN|"",
,If-TRUE-Goto,SkipACHLayout,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingN|hIndex,   

getAccFullNumber,GetDataAfterString,accountRealNum|"fullAccountNumber = ""||test,           //"
,If-FALSE-Goto,SkipACHLayout,

,Compare,accountRealNum|"",
,If-TRUE-Goto,SkipACHLayout,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|accountRealNum|hIndex, 

//=========================================         
SkipACHLayout,MoveToTopOfPage,,

nxtPage,FindString,">Account History:"|test,

,FindString,"class="download_options""|test,
,If-FALSE-Goto,NextHisAcct,

,MoveToTag,"table"|test,
,MoveToTag,"tr"|test,

txnLoop,MoveToTag,"tr"|test,
,MoveToTag,"td"|test,
,GetDataFromTag,|txnDate|,
,RemoveHTMLTags,txnDate,
,ConvertToValidDate,txnDate|test,
,If-FALSE-Goto,JumptoNextpage,

,CompareDates,txnDate|##STARTDATE##|<,
,If-TRUE-Goto,txnLoop,

,CompareDates,txnDate|##ENDDATE##|>,
,If-TRUE-Goto,txnLoop,

,FindSignature,">Transaction Type<",              // If transacrions type column is present
,If-TRUE-Goto,shiftOneTd,

,Compare,institutionId|"14872",         
,If-TRUE-Goto,shiftOneTd,

,FindSignature,">Type<",                                     // If transacrions type column is present
,If-TRUE-Goto,takeDesc,

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,takeDesc,
  
shiftOneTd,MoveToTag,"td",

takeDesc,MoveToTag,"td",
,GetDataFromTag,|txnDesc|,
,RemoveHTMLTags,txnDesc,
,RemoveExtraWhitespaces,txnDesc,

//=================================
,FindSignature,">Card #<",                                       // If Card No col is present
,If-FALSE-Goto,getTrxnsWithdrawlAmt,

,Compare,institutionId|"14872",         
,If-TRUE-Goto,SkipOneTD,
  
,Compare,institutionId|"11818",         
,If-TRUE-Goto,SkipOneTD,
  
,MoveToTag,"td",                                   
SkipOneTD,MoveToTag,"td",
getTrxnsWithdrawlAmt,MoveToTag,"td",
,GetDataFromTag,|txnAmount|,                           // Withdrawl Amt
,RemoveHTMLTags,txnAmount,

,Compare,txnAmount|"",
,If-TRUE-Goto,getDepositAmt,

,ParseString,VAL|"[-]##KEEP##"|txnAmount|test,
,If-TRUE-Goto,convertAmount,
,AppendVars,txnAmount|"-",

,Goto,convertAmount,

//=================================
getDepositAmt,MoveToTag,"td",                             // Deposit Amt
,GetDataFromTag,|txnAmount|,
,RemoveHTMLTags,txnAmount,

convertAmount,ConvertToValidDollar,txnAmount|test,

,Add,trans|1,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|txnDate|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|txnDesc|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|txnAmount|hIndex|trans,
,Goto,txnLoop,

//===============================================================================
JumptoNextpage,NOP,

,Assign,test|">",
,AppendVars,test|pageIndex,

,Assign,thisIndex|test,
,AppendVars,thisIndex|"<",

,FindString,thisIndex|test,
,If-FALSE-Goto,NextHisAcct,

,MoveToTag,"a"|"REV",
,GetDataFromTag,nextTargetURL||"href",

,ParseString,__EVENTTARGET|"&#39;##KEEP##&#39;"|nextTargetURL,
,ParseString,VAL|"PCDZ[$]##KEEP##[$]"|__EVENTTARGET,

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,//"

//**********************************************************************************************************
,Assign,accountNickname|"M$layout$content$PCDZ$XXXXXX$ctl00$AccountNickName",
,Assign,selectedAcct|"M$layout$content$PCDZ$XXXXXX$ctl00$selectedAccount",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calFromDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calToDate$TB",
,Assign,ClearedDateChoices|"M$layout$content$PCDZ$XXXXXX$ctl00$ClearedDateChoices",
,Assign,TransactionTypes|"M$layout$content$PCDZ$XXXXXX$ctl00$transactionTypes",

,FindReplace,"XXXXXX"|VAL|accountNickname|test,
,FindReplace,"XXXXXX"|VAL|selectedAcct|test,
,FindReplace,"XXXXXX"|VAL|ClearedDateChoices|test,
,FindReplace,"XXXXXX"|VAL|TransactionTypes|test,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,Assign,acctsActivityURL|##URL##
,CreateForm,"ScreenScrapForm"|acctsActivityURL,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"ScreenScrapForm",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET|"ScreenScrapForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"ScreenScrapForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"ScreenScrapForm",

,FindSignature,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName",
,If-FALSE-Goto,SetDefaultPostings,

,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname|"ScreenScrapForm",
,SetPostURLData,selectedAcct|acctValue|"ScreenScrapForm",
,Goto,SkipDefaultOne,

SetDefaultPostings,SetPostURLData,accountNickname|aname|"ScreenScrapForm",
,SetPostURLData,selectedAcct|acctValue|"ScreenScrapForm",
,SetPostURLData,ClearedDateChoices|"-2"|"ScreenScrapForm",
,SetPostURLData,StartDate|STRTDATE|"ScreenScrapForm",
,SetPostURLData,EndDate|ENDDATE|"ScreenScrapForm",
SkipDefaultOne,PostURL,||"ScreenScrapForm",

,Add,pageIndex|1,

,Goto,nxtPage,

GenError417,CompareNumbers,pageIndex|3|>=,
,If-TRUE-Goto,NextHisAcct,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,NoTrxnLog|"No Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,NextHisAcct,

//***************************************************************************
//     OFX DOWNLOAD
//***************************************************************************

NEWOFXLAYOUT,Assign,HISINDEX|0,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-FALSE-Goto,skipthispost,

,MoveToTopOfPage,,
,FindString,">Download Transactions<"|test,

,MoveToTag,"a"|"REV",
,GetDataFromTag,tURL|aName|"href",

,GetURL,tURL|,
,Goto,HISTRYACCNT,

skipthispost,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-FALSE-Goto,skipthispost11,

skipthispost11,ParseString,OFXURL|"##KEEP##/SignIn.aspx"|##TOWER_WEBSITE##,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,SKP_Find,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,IONBankAcc,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,
                                                 
,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Go2MvTop,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,SKP_Find,

Go2MvTop,MoveToTopOfPage,,

,FindString,"Download Data"|test,
,If-TRUE-Goto,MvARev,
,FindString,"Download Transactions"|test,
,If-TRUE-Goto,MvARev,
,FindString,"WebConnect"|test,

MvARev,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,OFXURL||"href",
,Goto,TryNow,

SKP_Find,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,WebConnectttt,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,WebConnect,
                                                
,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,                                                 

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,
                                                 
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,CSVLayout,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,
                                                 
,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,
                                                 
,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,WebConnectAcc,

,Goto,OnlyWeb,

WebConnectttt,AppendVars,OFXURL|"/WebConnect.aspx",
,Goto,TryNow,

IONBankAcc,AppendVars,OFXURL|"/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx",
,Goto,TryNow,

FlorenceBankAcc,Assign,OFXURL|"https://secure.myvirtualbranch.com/FlorenceBank/8ed1c170-34ed-40a2-8a64-ad615a41cf28.aspx",
,Goto,TryNow,

WebConnectAcc,AppendVars,OFXURL|"/Accounts/WebConnect.aspx",
,Goto,TryNow,

WebConnect,Assign,OFXURL|"https://langleyfcu.onlinebank.com/Accounts/WebConnect.aspx",
,Goto,TryNow,

WebConnectbankatpeoples,Assign,OFXURL|"https://secure.myvirtualbranch.com/bankatpeoples/Accounts/WebConnect.aspx",
,Goto,TryNow,                                      

OnlyWeb,AppendVars,OFXURL|"/Accounts/WebConnect2.aspx",

TryNow,NOP,

SKIPAdd_headers_centerstatebank,GetURL,OFXURL|,

,Compare,customerId|"25651764",      // 03 Jun 2021  FIID 72 DSS-70542
,If-TRUE-Goto,NextStorePage,

,Compare,customerId|"26093286",      // 07 May 2021  FIID 4566 DSS-70949
,If-FALSE-Goto,HISTRYACCNT,
  
NextStorePage,StoredHTTPResponse,,

HISTRYACCNT,Compare,HISINDEX|account,
,If-TRUE-Goto,logout,

,Assign,trans|0,
,Add,HISINDEX|1,
,Assign,achAccountNumber|"",
,FindSignature,"Disclosure View",
,If-TRUE-Goto,Useraction_108,
 
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|HISINDEX,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|HISINDEX,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|HISINDEX,

,ParseString,srore|"4566##KEEP##"|institutionId|test,   // FI ID: 4566 
,If-FALSE-Goto,SkipLoggingThis,
  
,ParseString,srore|"Business##PIPE##BUSINESS##PIPE##PLLC##PIPE##LLC##PIPE##Inc##PIPE##INC##KEEP##"|aname,
,If-FALSE-Goto,SkipLoggingThis,

,Log,ALERT|""OBB Business Account Found Script name: firstambank.scr for FI ID: "|institutionId|" Customer ID : ""|customerId|"" Partner ID :""|partnerId,

SkipLoggingThis,Compare,institutionId|"5420",
,If-FALSE-Goto,getNewURL1,

,GetReturnData,sURL|sURL|HISINDEX,

,Goto,skipGetNewURL1,

getNewURL1,GetReturnData,sURL1|sURL1|HISINDEX,

skipGetNewURL1,Compare,institutionId|"4399",
,If-FALSE-Goto,skipNextHisAcct1,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,NorthwestCreditCardLayout,

skipNextHisAcct1,Compare,fullNumFLAG|"TRUE",
,If-FALSE-Goto,skipThisGet,
,GetReturnData,fullAccountNum|fullAccountNum|HISINDEX,
,Assign,anum|fullAccountNum,

skipThisGet,FindString,"Select the account"|test,
,If-TRUE-Goto,SkipThisSection,

,FindString,"* Account"|test,
,If-TRUE-Goto,SkipThisSection,

,FindString,"Select Account"|test,
,If-TRUE-Goto,SkipThisSection,

,FindString,"* Account"|test,
,If-TRUE-Goto,SkipThisSection,
,FindString,"Choose an account"|test,
,If-FALSE-Goto,SkipThisCode,

SkipThisSection,MoveToTag,"select"|test,
,GetDataFromTag,VALUE||"id",

,ParseString,VALUE1|"M_layout_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,
,If-TRUE-Goto,SkipThisCode,

,ParseString,VALUE1|"M_layout_content_PCDZ_##KEEP##_ctl00_webInputForm_accountDropDown"|VALUE,
,If-TRUE-Goto,SkipThisCode,

,ParseString,VALUE1|"M_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,

SkipThisCode,NOP,

,Compare,AccTypeID|"100",
,If-TRUE-Goto,GOFORsURL,

,Compare,AccTypeID|"101",
,If-FALSE-Goto,SKipLayout,

GOFORsURL,GetURLv2,sURL1|,

,Compare,customerId|"1015043009",
,If-FALSE-Goto,skipCustStore,
,StoredHTTPResponse,,

skipCustStore,FindString,anum|test,
,If-FALSE-Goto,SkipRealNum,

,FindString,""achAccountNumber""|test,
,If-FALSE-Goto,SkipRealNum,

,GetDataAfterString,achAccountNumber|":""|, "//

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|HISINDEX,

SkipRealNum,ReturnToPreviousPage,,


SKipLayout,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,CheckCCAccount,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,GoForCompare1,

CheckCCAccount,Compare,AccTypeID|"200",
,If-FALSE-Goto,GoForCompare1,

,MoveToTopOfPage,,

,FindString,"Credit Cards"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,CCURL||"href",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",

,GetURL,CCURL|,

,FindString,aname|test,
,If-FALSE-Goto,NewCCHisLayout, 

  
,MoveToTag,"a"|"REV",
,GetDataFromTag,CCURL1||"href",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",
,GetURL,CCURL1|,


,FindSignature,"To help us more efficiently service your account in the future##COMMA## please provide a current email address below.",
,If-TRUE-Goto,NextReturnP1,

,FindString,"View All Transactions"|test,
,If-FALSE-Goto,NextReturnP1,

,MoveToTag,"a"|"REV",
,GetDataFromTag,TraAll||"href",

,GetURL,TraAll|,

,ExtractFromRawPage,VIEWSTATE|"id[=]["]__VIEWSTATE["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,VIEWSTATEGENERATOR|"id[=]["]__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,EVENTVALIDATION|"id[=]["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",

,Assign,translink|"./AccountTransactions.aspx?vw=all",

,CreateForm,"loginform"|translink,
,SetPostURLData,"ctl00$MainContent$txtCustomDateBegin"|sdate|"loginform",
,SetPostURLData,"ctl00$MainContent$txtCustomDateEnd"|edate|"loginform",
,SetPostURLData,"ctl00$MainContent$rblFileTypes"|"qfx"|"loginform",
,SetPostURLData,"ctl00$MainContent$btnDownload"|"Continue"|"loginform",
,SetPostURLData,"__VIEWSTATE"|VIEWSTATE|"loginform",
,SetPostURLData,"__VIEWSTATEGENERATOR"|VIEWSTATEGENERATOR|"loginform",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"loginform",
,PostURLr,"/downloadtransactions.ashx?m=qfx"||"loginform"|translink,

,FindSignature,"OFXHEADER",
,If-FALSE-Goto,NextReturnP1,

,ExtractFromRawPage,storage|"<?xml ##KEEP##"|test,
,RemoveInvalidSpecialCharacter,storage,

,FindReplace,"\?"|""|storage|test,
,ParseString,srore1|"version##KEEP##["][>]"|storage, //"
,FindReplace,srore1|""|##VPAGE##|test,   //
,FindReplace,"version="1.0" encoding="USASCII" standalone="no"><OFX"|""|storage,
,ReloadVPage,storage,

,GetStatementFromOFX,HISINDEX||##STARTDATE##|##ENDDATE##,


NextReturnP1,GetURL,"https://ebanking.nwfcu.org/2126/Accounts/AccountSummary.aspx"|,


,Goto,Go2MvTop,

GoForCompare1,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-FALSE-Goto,goassimpleas,

,Assign,aname1|aname,

checkthistype,Compare,AccTypeID|"200",
,If-TRUE-Goto,CSVLayout,

goassimpleas,MoveToTopOfPage,,

//,FindString,">Select the account<"|test,

,Assign,tempName|aname,

CheckNxtTower,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,  
                                                 
,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,getnum, 

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|" https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  // FIID: 15146
,If-TRUE-Goto,getnum,
                                                 
,Compare,##TOWER_WEBSITE##|"https://oceanbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,                                                 

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,getnum,  

,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,
                                                 
,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,GOHERE2,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,getnum,  
  
,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,getnum, 

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,  

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",  // FI ID: 4399
,If-TRUE-Goto,getnum,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipParknational,

,Assign,Newnum|anum,
,AppendVars,Newnum|" - ",
,AppendVars,Newnum|aname,

,FindString,Newnum|test,
,If-TRUE-Goto,jumphere,

skipParknational,ParseString,srore|"Debit Card##KEEP##"|tempName,
,If-TRUE-Goto,getnum,

,ParseString,srore|"Savings##KEEP##"|tempName,
,If-TRUE-Goto,getnum,
  
,Goto,GOHERE1,

getQFXID,GetReturnData,ofxAccountId|ofxAccountId|HISINDEX,
,Assign,anum|ofxAccountId,

getnum,FindString,anum|test,
,If-TRUE-Goto,jumphere,

,Compare,institutionId|"4741",     //We'll remove these once we find more scenarios like this DSS-59840
,If-FALSE-Goto,SkpThisCode1,

,Right$,anum|anum|7,
,FindString,anum|test,
,If-TRUE-Goto,jumphere,

SkpThisCode1,Right$,anum|anum|4,

,FindString,anum|test,
,If-FALSE-Goto,HISTRYACCNT,

,Goto,jumphere

GOHERE1,FindReplace,"&"|"&amp;"|tempName|test,

,FindReplace,"'"|"&#39;"|tempName|test,

GOHERE2,FindString,tempName|test,
,If-FALSE-Goto,HISTRYACCNT,

jumphere,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,HISTRYACCNT,

,GetDataFromTag,ACCNTVALUE||"value",

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,Assign,CheckTransactions|0,

JumpToRollDate,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,gesaCreditUnion,
  
,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"1010",
,If-TRUE-Goto,tyndallonline,

,Compare,institutionId|"7112",
,If-TRUE-Goto,tyndallonline,
  
,Compare,institutionId|"7419",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"15146",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"5420",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"2617",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"4399",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"12524",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"7726",
,If-TRUE-Goto,tyndallonline, 

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx", // FI 4096
,If-TRUE-Goto,tyndallonline,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx", // FI 4231
,If-TRUE-Goto,radiantcu,

,Compare,institutionId|"4566",
,If-TRUE-Goto,tyndallonline, 

,Compare,institutionId|"7414",
,If-TRUE-Goto,tyndallonline,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,Compare,institutionId|"4741",
,If-FALSE-Goto,SkipNewParameters,

,Assign,accountDropDown|"M$content$PCDZ$XXXXXX$ctl00$accountDropDown",
,Assign,rblStockDateRanges|"M$layout$content$PCDZ$XXXXXX$ctl00$rblStockDateRanges",
,Assign,StartDate|"M$content$PCDZ$XXXXXX$ctl00$calStartDate$TB",
,Assign,EndDate|"M$content$PCDZ$XXXXXX$ctl00$calEndDate$TB",
,Assign,quickenWebConnectButton|"M$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.x",
,Assign,quickenWebConnectButton1|"M$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.y",

,Goto,CheckForReplace,

SkipNewParameters,Assign,accountDropDown|"M$layout$content$PCDZ$XXXXXX$ctl00$accountDropDown",
,Assign,rblStockDateRanges|"M$layout$content$PCDZ$XXXXXX$ctl00$rblStockDateRanges",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calStartDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calEndDate$TB",
,Assign,quickenWebConnectButton|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.x",
,Assign,quickenWebConnectButton1|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.y",

CheckForReplace,FindReplace,"XXXXXX"|VALUE1|accountDropDown|test,
,FindReplace,"XXXXXX"|VALUE1|rblStockDateRanges|test,
,FindReplace,"XXXXXX"|VALUE1|StartDate|test,
,FindReplace,"XXXXXX"|VALUE1|EndDate|test,
,FindReplace,"XXXXXX"|VALUE1|quickenWebConnectButton|test,
,FindReplace,"XXXXXX"|VALUE1|quickenWebConnectButton1|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,Compare,institutionId|"4741",
,If-TRUE-Goto,SkipThisPost,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,SkipThisPost,

,SetPostURLData,"M$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.x"|"190",
,SetPostURLData,"M$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.y"|"25",

,Goto,SkipDropDown,

SkipThisPost,SetPostURLData,accountDropDown|ACCNTVALUE,
,SetPostURLData,rblStockDateRanges|"-2",
,SetPostURLData,StartDate|STRTDATE,
,SetPostURLData,EndDate|ENDDATE,
,SetPostURLData,quickenWebConnectButton|"0",
,SetPostURLData,quickenWebConnectButton1|"0",

SkipDropDown,Goto,PstNw,


,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-TRUE-Goto,DiffQfx3,

,Compare,##TOWER_WEBSITE##|" https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,DiffQfx3,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DiffQfx_realtorsfcu,

,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-TRUE-Goto,DiffQfweokie,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,DiffQfx_nwfcu,
                                                                                               
,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,DiffQfxio,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-TRUE-Goto,sunstatefcu,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,sunstatefcu1,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,sunstatefcu1,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",  //FI 15146
,If-TRUE-Goto,sunstatefcu1,

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com/",
,If-TRUE-Goto,AnbtxPosting,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,anbtx,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-FALSE-Goto,anotherpost,

MoveHere,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MLOSV65$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MLOSV65$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MLOSV65$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MLOSV65$ctl00$quickenWebConnectButton.x"|"63",
,SetPostURLData,"M$layout$content$PCDZ$MLOSV65$ctl00$quickenWebConnectButton.y"|"26",
,Goto,PstNw,

anotherpost,NOP,
  
tyndallonline,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$lstDownloadFormat"|"QFX",

,PostURL,OFXURL||,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$lstDownloadFormat"|"QFX",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$btnDownload"|"Download",

,Goto,PstNw,  

radiantcu,NOP,,
,MoveToTopOfPage,,
,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,FindString,"Select an Account"|test,
,If-FALSE-Goto,HISTRYACCNT,

,MoveToTag,"SELECT"|"REV"|test,
,GetDataFromTag,accNameParameter||"name"|test,

,FindString,tempName|test,
,If-FALSE-Goto,HISTRYACCNT,

,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,ACCNTVALUE||"value",

,MoveToTag,"INPUT"|test,
,GetDataFromTag,stDateNameParameter||"name",

,MoveToTag,"INPUT"|test,
,GetDataFromTag,endDateNameParameter||"name",

,MoveToTag,"INPUT"|test,
,GetDataFromTag,buttonNameParameter||"name",
,GetDataFromTag,buttonNameParameterValue||"value",

,MoveToTag,"INPUT"|test,
,MoveToTag,"INPUT"|test,
,GetDataFromTag,btnDownload||"name",
,GetDataFromTag,btnDownloadValue||"value",

,SetPostURLData,accNameParameter|ACCNTVALUE|0,
,SetPostURLData,stDateNameParameter|STRTDATE|0,
,SetPostURLData,endDateNameParameter|ENDDATE|0,
,SetPostURLData,buttonNameParameter|"QFX"|0,
,SetPostURLData,btnDownload|"Download"|0,
,Goto,PstNw,

gesaCreditUnion,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,

,PostURL,OFXURL||,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.x"|"62",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.y"|"36",

,Goto,PstNw,

DiffQfx,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/e-fnb/SignIn.aspx",
,If-FALSE-Goto,DiffQfx1,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ddlAccount"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$FromDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ToDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ddlFormat"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$btnDownload"|"Download",

,Goto,PstNw,
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
DiffQfx_realtorsfcu,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MQEEOMC$ctl00$accountDropDown",

,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$calEndDate$TB"|ENDDATE,


,PostURL,||,

,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$quickenWebConnectButton.x"|"68",
,SetPostURLData,"M$layout$content$PCDZ$MQEEOMC$ctl00$quickenWebConnectButton.y"|"16",


,Goto,PstNw,

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

DiffQfx_nwfcu,FindSignature,"M$layout$content$PCDZ$MQEEOMC$ctl00$accountDropDown",
,If-TRUE-Goto,DiffQfx_realtorsfcu,
 ,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MPEGC4Z$ctl00$accountDropDown",

,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$calEndDate$TB"|ENDDATE,


,PostURL,||,

,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$quickenWebConnectButton.x"|"51",
,SetPostURLData,"M$layout$content$PCDZ$MPEGC4Z$ctl00$quickenWebConnectButton.y"|"18",

,Goto,PstNw,
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

DiffQfx1,NOP,

DiffQfx22,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/e-fnb/SignIn.aspx",
,If-FALSE-Goto,DiffQfxio,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ddlAccount"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$FromDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ToDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$ddlFormat"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MHXKBVK$ctl00$btnDownload"|"Download",

,Goto,PstNw,

DiffQfxio,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlAccount"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$FromDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ToDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"16",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$btnDownload"|"Download",

,Goto,PstNw1,


DiffQfx3,NOP,

DiffQfx4,Goto,sunstatefcu,

DiffQfxioXX,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlAccount"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$FromDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ToDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"12",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$btnDownload"|"Download",

,Goto,PstNw1,


sunstatefcu,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-FALSE-Goto,anbtx,

sunstatefcu1,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MXI16GH$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$MXI16GH$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$MXI16GH$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$MXI16GH$ctl00$quickenWebConnectButton.x"|"23",
,SetPostURLData,"M$layout$content$PCDZ$MXI16GH$ctl00$quickenWebConnectButton.y"|"7",

,Goto,PstNw,

anbtx,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,DiffQfx5,

AnbtxPosting,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown",
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown"|ACCNTVALUE,

,PostURL,||,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown",
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$dateRangeDropDown"|"dr",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown",

,PostURL,||,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$dateRangeDropDown"|"dr",
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$quickenWebConnectButton.x"|"37",
,SetPostURLData,"M$layout$content$PCDZ$M9G0CW4$ctl00$quickenWebConnectButton.y"|"22",

,PostURL,||,

,Goto,asitis,

DiffQfx5,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.x"|"196",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.y"|"21",

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,PstNw1,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,PstNw1,  
                                                 
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-FALSE-Goto,PstNw,

PstNw1,PostURL,||,
,Goto,asitis,

PstNw,PostURL,OFXURL||,                                                
                                                 
asitis,FindSignature,"Register for Quicken and/or QuickBooks Direct Connect",
,If-TRUE-Goto,Useraction_108,

,GetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|HISINDEX,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|HISINDEX,

,FindString,">No transactions found for specified date range.<"|test,
,If-FALSE-Goto,Skip_NoTrans,

,CompareNumbers,CheckTransactions|1|>=,
,If-TRUE-Goto,NoTrans,

,Add,CheckTransactions|1,

,RollDate,ENDDATE|STRTDATE|MONTH|-6|test,
,ConvertDateToText,STRTDATE|STRTDATE|"MM/dd/yyyy",

,Goto,JumpToRollDate,

Skip_NoTrans,FindSignature,"General Error",
,If-TRUE-Goto,HISTRYACCNT,

,Compare,AccTypeID|"103",
,If-TRUE-Goto,Skipthisone,
,Compare,AccTypeID|"201",
,If-TRUE-Goto,Skipthisone,
,Compare,AccTypeID|"200",
,If-TRUE-Goto,Skipthisone,
,Compare,AccTypeID|"400",
,If-TRUE-Goto,Skipthisone,
,Compare,AccTypeID|"401",
,If-TRUE-Goto,Skipthisone,
,Compare,achAccountNumber|"",
,If-TRUE-Goto,Skipthisone,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|HISINDEX,

///////////////////////////////////////////////////////////////
Skipthisone,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

//--------------------------- // Applied institution check as other FIs are failing with error 145 due to this code
,Compare,institutionId|"3185",
,If-TRUE-Goto,aggACHnumber,
  
,Compare,institutionId|"6671", 
,If-FALSE-Goto,lbldwdsign,

aggACHnumber,ExtractFromRawPage,achAccountNumber|"<ACCTID>##KEEP##<"|test,

,ParseString, accnumber|"-##KEEP##-"|achAccountNumber|test,
,If-FALSE-Goto,lbldwdsign,

,Assign,achAccountNumber|accnumber,

lbldwdsign,NOP,,
//---------------------------

,FindSignature,"Download Transactions",
,If-TRUE-Goto,skipThisCustomError,              
  
,FindSignature,"OFX",
,If-TRUE-Goto,skipThisLog,            

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|HISINDEX|,

skipThisCustomError,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,ret2pp,

///////////////////////////////////////////////////////////////

skipThisLog,GetStatementFromOFX,HISINDEX|trans|STRTDATE|ENDDATE,

///////////////////////////////////////////////////////////////

NoTrans,Compare,trans|0,
,If-FALSE-Goto,skipAddLogs,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

///////////////////////////////////////////////////////////////

skipAddLogs,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|HISINDEX,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|HISINDEX,

//,Compare,AccTypeID|"201",
//,If-TRUE-Goto,ret2pp,
//,Compare,AccTypeID|"200",
//,If-TRUE-Goto,ret2pp,
//,Compare,AccTypeID|"400",
//,If-TRUE-Goto,ret2pp,
//,Compare,AccTypeID|"401",
//,If-TRUE-Goto,ret2pp,
 
,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,ret2pp,
  
,Compare,achAccountNumber|"",
,If-TRUE-Goto,ret2pp,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|HISINDEX,

ret2pp,ReturnToPreviousPage,,
,Goto,HISTRYACCNT,

//***************************************************************************
//     CSV DOWNLOAD
//***************************************************************************
CSVLayout,MoveToTopOfPage,,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",  // FI ID: 5899
,If-TRUE-Goto,getActivity,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,getActivity,

,Compare,institutionId|"7095",
,If-TRUE-Goto,getActivity,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,getThisActivity, 
  
,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,getActivity, 

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",  // FI ID: 4781
,If-FALSE-Goto,Skiptthis1, 

getThisActivity,GetURL,"/Accounts/Activity.aspx"|,

Skiptthis1,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skipfirstcommandbank,

getActivity,GetURL,"/Accounts/AccountActivity.aspx"|,
,Goto,SkipAcctActivity,

Skipfirstcommandbank,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-FALSE-Goto,SkipCompare,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,NextHisAcct,

SkipCompare,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,CheckXfcuTower,

,GetURL,"/Accounts/AccountActivity.aspx"|,

CheckXfcuTower,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-FALSE-Goto,findstr,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,

,FindReplace,"$"|":"|sURL1|test,

,CreateForm,"Form2"|"/AccountsSummary.aspx",
,SetPostURLData,"__EVENTTARGET"|sURL1|"Form2",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form2",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form2",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstSourceAccount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstDestinationAccount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstAmountOption"|"0"|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$txtAmount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption0"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption1"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption2"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption3"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption4"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstContributionYear"|"Current"|"Form2",

,PostURLr,"https://langleyfcu.onlinebank.com/Accounts/AccountsSummary.aspx"||"Form2"|"/Accounts/AccountActivity.aspx", 

,Goto,findstrng,

findstr,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,findstr12,
,FindString,"Account Activity"|test,
,If-FALSE-Goto,NxtChk,
,Goto,GoToAncr,	

findstr12,FindString,">Account Activity<"|test,
,If-FALSE-Goto,NxtChk,

,Goto,GoToAncr,

NxtChk,FindString,">Account Activity<"|test,
,If-FALSE-Goto,NxtChk11,
,Goto,GoToAncr,  
NxtChk11,FindString,"Account Activity"|test,
,If-FALSE-Goto,NextHisAcct,

GoToAncr,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,NxtChk,

,GetDataFromTag,aggrURL||"href",

,GetURL,aggrURL|,

findstrng,FindString,"Account History:"|test,

,MoveToTag,"select"|test,
,GetDataFromTag,aValue||"name",
,ParseString,aValue1|"M[$]layout[$]content[$]PCDZ[$]##KEEP##[$]ctl00[$]"|aValue,

goto_northshore_bank,FindSignature,"Export all history",
,If-FALSE-Goto,skipMyMechanicsAddPosts,

,MoveToTopOfPage,,

,FindString,"Export all history"|test,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,aggrURL||"href",
,GetURL,aggrURL|,

,FindString,"Export all account History"|test,
,MoveToTag,"form"|test,
,GetDataFromTag,postURL||"action",

,FindStringRE,"M$layout$content$PCDZ$MTH2W5T$ctl00$chkAllAccounts"|test,

,FindReplace,"&amp;"|"&"|aname|test,
,FindString,anum|test,
,FindString,aname|test,

,MoveToTag,"input"|"REV"|test,
,GetDataFromTag,postParamsName||"name",
,GetDataFromTag,postParamsValue||"value",

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,CreateForm,"txnDownloadForm"|postURL,                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"txnDownloadForm",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M3SN6LC:ctl00:DownloadOptions:ctl00:Download"|"txnDownloadForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"txnDownloadForm",
,SetPostURLData,"__VIEWSTATE"|""|"txnDownloadForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"txnDownloadForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$ddlTxnTypes"|"none_selected"|"txnDownloadForm",
,SetPostURLData,postParamsName|postParamsValue|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$rblStockDateRanges"|"-2"|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$calFromDate$TB"|sdate|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$calToDate$TB"|edate|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$btnDownload"|"Download"|"txnDownloadForm",
,SetPostURLData,"M$layout$content$PCDZ$MTH2W5T$ctl00$ddlDataFormat"|"1"|"txnDownloadForm",
,PostURL,||"txnDownloadForm",
,Goto,CSVdown,

skipMyMechanicsAddPosts,NOP,

,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipAcctActivity,

,Assign,AccountNickName|aname,

,FindString,"Account Activity:"|test,
,If-FALSE-Goto,NextHisAcct,


SkipAcctActivity,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,findNum,   

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,findNum,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,findNum,

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,findNum,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2189/SignIn.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,findname,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,skipthisfind,

,FindString,"Account Activity"|test,
,If-FALSE-Goto,NextHisAcct,
,Goto,findname,


skipthisfind,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,goAssgn, 

,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-TRUE-Goto,goAssgn,

,Compare,institutionId|"1066",
,If-TRUE-Goto,goAssgn,

,Compare,institutionId|"7175",
,If-TRUE-Goto,goAssgn,

,Compare,institutionId|"4781",
,If-TRUE-Goto,goAssgn,
  
,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,goAssgn,
                                               
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,findNum,

SelectAcct,FindString,"Select an Account"|test,
,If-TRUE-Goto,findNum,


,FindSignature,"Account Activity",
,If-TRUE-Goto,GETNUM,

,FindSignature,"Account History:",
,If-FALSE-Goto,SkpThisCode,

GETNUM,Right$,anum|anum|4,
,Goto,findNum,


SkpThisCode,Log,ALERT|" Transaction not generated for firstambank.scr from date:-  "|sdate|" and EndDate "|edate|" and partner "|partnerId|" and Customer ID "|customerId,
,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Goto,NextHisAcct,

findNum,FindString,"Account History:"|test,
,If-TRUE-Goto,Move2Select,

,MoveToTopOfPage,,
,FindString,"Account History:"|test,

Move2Select,MoveToTag,"select"|test,
,GetDataFromTag,aValue||"name",
,ParseString,aValue1|"M[$]layout[$]content[$]PCDZ[$]##KEEP##[$]ctl00[$]"|aValue,


,FindString,"Routing #"|test,
,If-FALSE-Goto,skipREV,

,GetDataAfterString,RoutingNumber|":"|" "|test,
,If-FALSE-Goto,skipREV,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,
  
,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skipREV,
,MoveToTag,"select"|"REV"|test,
skipREV,FindString,anum|test,
,Goto,gofortag,

skipthissign,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-TRUE-Goto,MakeAccNameToFind,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-FALSE-Goto,findname,

goAssgn,Assign,namefind|anum,
,AppendVars,namefind|" - ",
,AppendVars,namefind|aname,
,Assign,aname|namefind,

,Goto,findname,

MakeAccNameToFind,Assign,namefind|" - ",
,AppendVars,namefind|aname,
,Assign,aname|namefind,

findname,FindString,"Account History:"|test,
,MoveToTag,"select"|test,
,GetDataFromTag,aValue||"name",
,ParseString,aValue1|"M[$]layout[$]content[$]PCDZ[$]##KEEP##[$]ctl00[$]"|aValue,

,MoveToTopOfPage,,

,FindReplace,"&"|"&amp;"|aname|test,
,FindString,aname|test,
,If-TRUE-Goto,gofortag,

,FindReplace,"&"|"&amp;"|aname|test,
,FindString,aname|test,
,If-FALSE-Goto,NextHisAcct,


gofortag,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,goforOPTtag,
,Goto,gettagval,
                                                 
goforOPTtag,MoveToTag,"option",
gettagval,GetDataFromTag,acctValue||"value",
//*********************************************************************************\\
,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipReal_num,

,Compare,accRealNumber|"",
,If-TRUE-Goto,SkipReal_num,

,ParseString,srore|"100##PIPE##101##PIPE##103##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,skip_ACH,

,FindString,"Routing Number"|test,
,If-FALSE-Goto,skipRealLog,

,GetDataAfterString,RoutingNumber|":"|" "|test,
,If-FALSE-Goto,skipRealLog,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,


,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|hIndex,   
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|accRealNumber|hIndex, 
,Goto,skip_ACH,

//*********************************************************************************\\
SkipReal_num,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Nxt_ACH,

,ParseString,srore|"100##PIPE##101##PIPE##103##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,skip_ACH,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|fullAccountNumber|hIndex, 

,FindString,"Routing Number"|test,
,If-FALSE-Goto,skipRealLog,

,MoveToTag,"DIV",
,GetDataFromTag,|RoutingNumber|,
,RemoveHTMLTags,RoutingNumber,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|hIndex, 
//*********************************************************************************\\

Nxt_ACH,ParseString,srore|"100##PIPE##101##PIPE##103##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,skip_ACH,

,FindString,"Routing Number"|test,
,If-FALSE-Goto,skipRealLog,

,GetDataAfterString,RoutingNumber|":"|" "|test,
,If-FALSE-Goto,skipRealLog,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,FindReplace,"-"|""|anum|test,
,If-FALSE-Goto,skipRealLog,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|hIndex, 

,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-TRUE-Goto,skip_ACH,
,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,skip_ACH,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|anum|hIndex, 
,Goto,skip_ACH,

skipRealLog,Log,STATUS|script_Name|" ACH: ACH Details not found for Institution ID "|institutionId|" and CCID : "|customerId|" and Partner ID "|partnerId,

skip_ACH,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,CSVDOWNLOAD,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,CSVDOWNLOAD,                         
,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,GoForCSV,                                                  
,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVDOWNLOAD,

,Compare,institutionId|"5341",
,If-TRUE-Goto,CSVDOWNLOAD,

,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-FALSE-Goto,skipUBTACHLayout,

///////////////////////////////////////////////////////////////////////////
// ACH Layout for UBT Bank
,ParseString,srore|"100##PIPE##101##PIPE##103##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,skipUBTACHLayout,

,MoveToTopOfPage,,
,FindString,"Select an Account"|test,
,If-FALSE-Goto,skipUBTACHLayout,
,FindString,anum|test,
,If-FALSE-Goto,skipUBTACHLayout,
,MoveToTag,"option"|"REV",
,If-FALSE-Goto,skipUBTACHLayout,
,GetDataFromTag,selectedAccountValue||"value",
,RemoveHTMLTags,selectedAccountValue,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:db3d9eb3-6d72-4959-b303-32b61119a4a8:ea597d4b:b25378d2",
,SetPostURLData,"_EVENTTARGET"|"M$layout$content$PCDZ$MORB7FN$ctl00$search",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$selectedAccount"|selectedAccountValue,
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$ClearedDateChoices"|"60",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$search"|"1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ddlPaginationSelectionOptions"|"25",
,PostURL,"https://ubtgo.ubt.com/UBT/Accounts/AccountActivity.aspx"||,

,FindString,"Show Full Account"|test,
,If-FALSE-Goto,skipRealLog_1,
,GetDataAfterString,realAccountNumber|"display:none"|"[+];'">"|test,        //"
,If-TRUE-Goto,ParserealAccountNumber,

skipRealLog_1,Log,STATUS|script_Name|" ACH: ACH Details not found for Institution ID "|institutionId|" and CCID : "|customerId|" and Partner ID "|partnerId,
,Goto,skipUBTACHLayout,

ParserealAccountNumber,ParseString,realAccountNumber|"[;][']["][>]##KEEP##"|realAccountNumber, //"
,Right$,trimLast4Digit|realAccountNumber|4|test,
,Right$,trimLastDigitAccountNumber|anum|4|test,
,Compare,trimLastDigitAccountNumber|trimLast4Digit,
,If-FALSE-Goto,skipUBTACHLayout,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|realAccountNumber|hIndex,

,Goto,skipUBTACHLayout,
//////////////////////////////////////////////////////////////////////////

skipUBTACHLayout,NOP,
,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVDOWNLOAD,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CSVDOWNLOAD,

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",	//FI 12590
,If-TRUE-Goto,CSVDOWNLOAD,
  
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-TRUE-Goto,Skiphistory2,

,FindReplace,"&amp;"|"&"|aname|test,

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,firstcommandbankTrans,
  
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,GOHERE122,
//**********************************************************************************************************
,MoveToTopOfPage,,
,FindString,"Export all history"|test,
,If-FALSE-Goto,SkipThisLayout,

,MoveToTag,"a"|"REV",
,GetDataFromTag,ExportURL||"href",
,GetURL,ExportURL|,

,FindString,"Download:"|test,
,MoveToTag,"select"|test,
,GetDataFromTag,aValue||"name",
,ParseString,aValue1|"M[$]layout[$]content[$]PCDZ[$]##KEEP##[$]ctl00[$]"|aValue,

,FindString,anum|test,
,MoveToTag,"input"|"REV"|test,
,GetDataFromTag,acctValue||"value",
,GetDataFromTag,acctValuePost||"name",
  
,ExtractFromRawPage,__VIEWSTATEID_1|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION_1|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM_1|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM_1|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM_1|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM_1|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM_1|test,

,Assign,transactionTypes|"M$layout$content$PCDZ$XXXXXX$ctl00$ddlTxnTypes",
,Assign,ClearedDateChoices|"M$layout$content$PCDZ$XXXXXX$ctl00$rblStockDateRanges",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calFromDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calToDate$TB",
,Assign,DataFormat|"M$layout$content$PCDZ$XXXXXX$ctl00$ddlDataFormat",
,Assign,Download|"M$layout$content$PCDZ$XXXXXX$ctl00$btnDownload",

,FindReplace,"XXXXXX"|aValue1|ClearedDateChoices|test,
,FindReplace,"XXXXXX"|aValue1|StartDate|test,
,FindReplace,"XXXXXX"|aValue1|EndDate|test,
,FindReplace,"XXXXXX"|aValue1|transactionTypes|test,
,FindReplace,"XXXXXX"|aValue1|DataFormat|test,
,FindReplace,"XXXXXX"|aValue1|Download|test,

,MoveToTopOfPage,,
,Assign,accountActivityURL|"./AccountActivity.aspx",
,MoveToTag,"form"|test,
,If-FALSE-Goto,skipThisFormGet,

,GetDataFromTag,accountActivityURL||"action",

,CreateForm,"Form1"|accountActivityURL,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM_1|"Form1",
,SetPostURLData,"__EVENTTARGET"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID_1|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION_1|"Form1",
,SetPostURLData,acctValuePost|acctValue|"Form1",
,SetPostURLData,ClearedDateChoices|"-2"|"Form1",
,SetPostURLData,StartDate|sdate|"Form1",
,SetPostURLData,EndDate|edate|"Form1",
,SetPostURLData,transactionTypes|"none_selected"|"Form1",
,SetPostURLData,DataFormat|"1"|"Form1",
,SetPostURLData,Download|"Download"|"Form1",
,PostURL,||"Form1",

,Goto,CSVdown,

//**********************************************************************************************************
 
SkipThisLayout,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthfculayout,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GetAcNum,

,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthfculayout,  
  
,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthfculayout,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,allsouthfculayout,
,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,allsouthfculayout,
,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipcafcuTower,

GetAcNum,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|hIndex,
,Goto,allsouthfculayout,

skipcafcuTower,Assign,EVENTTARGET|"M:layout:content:PCDZ:XXXXXX:ctl00:DownloadOptions:ctl00:Download",
,Assign,AccountNickName|"M$layout$content$PCDZ$XXXXXX$ctl00$AccountNickName",
,Assign,selectedAccount|"M$layout$content$PCDZ$XXXXXX$ctl00$selectedAccount",
,Assign,ClearedDateChoices|"M$layout$content$PCDZ$XXXXXX$ctl00$ClearedDateChoices",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calFromDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calToDate$TB",
,Assign,transactionTypes|"M$layout$content$PCDZ$XXXXXX$ctl00$transactionTypes",


,FindReplace,"XXXXXX"|aValue1|EVENTTARGET|test,
,FindReplace,"XXXXXX"|aValue1|AccountNickName|test,
,FindReplace,"XXXXXX"|aValue1|selectedAccount|test,
,FindReplace,"XXXXXX"|aValue1|ClearedDateChoices|test,
,FindReplace,"XXXXXX"|aValue1|StartDate|test,
,FindReplace,"XXXXXX"|aValue1|EndDate|test,
,FindReplace,"XXXXXX"|aValue1|transactionTypes|test,

,MoveToTopOfPage,,
,Assign,accountActivityURL|"./AccountActivity.aspx",
,MoveToTag,"form"|test,
,If-FALSE-Goto,skipThisFormGet,

,GetDataFromTag,accountActivityURL||"action",

skipThisFormGet,CreateForm,"Form1"|accountActivityURL,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|EVENTTARGET|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,AccountNickName|aname|"Form1",
,SetPostURLData,selectedAccount|acctValue|"Form1",
,SetPostURLData,ClearedDateChoices|"-2"|"Form1",
,SetPostURLData,StartDate|sdate|"Form1",
,SetPostURLData,EndDate|edate|"Form1",
,SetPostURLData,transactionTypes|"none_selected"|"Form1",
,PostURL,||"Form1",

,Goto,CSVdown,

//**********************************************************************************************************

allsouthfculayout,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Gotomovetopcursor,

,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Gotomovetopcursor,  
  
,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipMovetoTopCursor,

Gotomovetopcursor,MoveToTopOfPage,,

,FindString,"Account History:"|test,
,If-FALSE-Goto,NextHisAcct,

SkipMovetoTopCursor,FindString,anum|test,
,If-FALSE-Goto,NextHisAcct,

,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,acctValue||"value",

,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts,
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__VIEWSTATE"|"",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Referer"|"/Accounts/AccountActivity.aspx",
,SetHeader,"Upgrade-Insecure-Requests"|"1",
,PostURL,"/Accounts/AccountActivity.aspx"||,

,FindString,"Account Number:"|test,
,If-FALSE-Goto,nxtTAG,

,MoveToTag,"td"|test,
,If-FALSE-Goto,nxtTAG,

,Compare,institutionId|"11142",
,If-FALSE-Goto,Skipthislogic,

,FindString,"> Full Account<"|test,
,If-FALSE-Goto,nxtTAG,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,nxtTAG,

,GetDataFromTag,formType||"onclick",

,ParseString,AccounID|"[(][']##KEEP##[']"|formType,
,Assign,ACH_URL|"https://neighborsfcu.onlinebank.com/api/FullPartialAccount?accountId=",
,AppendVars,ACH_URL|AccounID,

,GetURLv2,ACH_URL|,

,ExtractFromRawPage,achAccountNumber|"["]##KEEP##["]"|test,
,ReturnToPreviousPage,1,
,Goto,GetTheACH,
 
Skipthislogic,GetDataFromTag,|achAccountNumber|,
GetTheACH,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

nxtTAG,FindString,"Download For:"|test,
,If-TRUE-Goto,DownloadSpreadSheet,

,FindString,">Export To:<"|test,
,If-TRUE-Goto,skpDownload,
  
,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,DownloadSpreadSheet,
,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skpDownload,
DownloadSpreadSheet,FindString,"Download For:"|test,

skpDownload,MoveToTag,"a",
,GetDataFromTag,EVENTTARGET||"id",
,FindReplace,"_"|":"|EVENTTARGET,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"EVENTVALIDATION" value="##KEEP##""|test,//"

,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,
,CreateForm,"CSV1"|"/Accounts/AccountActivity.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|"CSV1",
,SetPostURLData,"__EVENTTARGET"|EVENTTARGET|"CSV1",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"CSV1",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname|"CSV1",

,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$description"|""|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$checkNumber"|""|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$amount"|""|"CSV1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$endAmount"|""|"CSV1",
,SetPostURLData,"__EVENTARGUMENT"|""|"CSV1",
,SetPostURLData,"__VIEWSTATE"|""|"CSV1",


,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Referer"|"/Accounts/AccountActivity.aspx",
,SetHeader,"Upgrade-Insecure-Requests"|"1",
,PostURL,"/Accounts/AccountActivity.aspx"||"CSV1"

,Goto,CSVdown,


//**********************************************************************************************************


,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkipThismywestfieldbank,
                                                 
,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,SkipThismywestfieldbank,
                                        
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,SkipThismywestfieldbank,  
                                           	
,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-TRUE-Goto,SkipThismywestfieldbank, 

,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SkipThismywestfieldbank,
 
,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,CSVLayoutFor7575,
 
,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,GOHERE,
  
,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,GOHERE,
  
,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,GOHERE122, 

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,
  
,Compare,##TOWER_WEBSITE##|"http://www.anbtx.com/",
,If-TRUE-Goto,GOHERE,  

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE122, 

,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-TRUE-Goto,GOHERE122, 

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,gotoNextForm,

firstcommandbankTrans,CreateForm,"Form1"|"./AccountActivity.aspx",                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M3SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE5$ctl00$AccountNickName"|aname|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$search"|"1"|"Form1",
,PostURL,||"Form1",

,CreateForm,"Form1"|"./AccountActivity.aspx",                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M3SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE5$ctl00$AccountNickName"|aname|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$ClearedDateChoices"|"30"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,PostURL,||"Form1",
,Goto,CSVdown,

gotoNextForm,Compare,##TOWER_WEBSITE##|"https://ubtgo.ubt.com/UBT/SignIn.aspx",
,If-FALSE-Goto,gotoNextTowerForm,

,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Referer"|"https://ubtgo.ubt.com/UBT/Accounts/AccountActivity.aspx",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Upgrade-Insecure-Requests"|"1",

,CreateForm,"Form1"|"./AccountActivity.aspx",   
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$selectedAccount"|acctValue|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$endAmount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$search"|"1"|"Form1",
,PostURL,||"Form1",

,CreateForm,"Form1"|"./AccountActivity.aspx", 
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Referer"|"https://ubtgo.ubt.com/UBT/Accounts/AccountActivity.aspx",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Upgrade-Insecure-Requests"|"1",

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$selectedAccount"|acctValue|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$ClearedDateChoices"|"30"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MORB7FN$ctl00$endAmount"|""|"Form1",
,PostURL,||"Form1",
,Goto,CSVdown,

gotoNextTowerForm,CreateForm,"Form1"|"./AccountActivity.aspx",                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$47846904-faa5-422c-a067-e9a2a3eb599b$ctl00$AccountNickName"|aname|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$0166d02d-6749-4cd7-9e4f-0c5530949143$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$0166d02d-6749-4cd7-9e4f-0c5530949143$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$0166d02d-6749-4cd7-9e4f-0c5530949143$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$0166d02d-6749-4cd7-9e4f-0c5530949143$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$0166d02d-6749-4cd7-9e4f-0c5530949143$ctl00$transactionTypes"|"none_selected"|"Form1",


,PostURL,||"Form1",
,Goto,CSVdown,

SkipThismywestfieldbank,NOP,

GOHERE122,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
,PostURL,||,

,Goto,CSVDOWNLOAD,


Skiphistory2,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"

,MoveToTopOfPage,,
,FindString,""Search""|test,
,If-FALSE-Goto,NormalSearch,
,MoveToTag,"input"|"REV",
,GetDataFromTag,SearchName||"name",
,SetPostURLData,SearchName|"1",
,Goto,skipNormalSearch,

NormalSearch,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1",
skipNormalSearch,SetPostURLData,"M_L_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA##Version=4.0.0.0##COMMA##Culture=neutral##COMMA##PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,

,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
,PostURL,||,

//************************************************************************************ M_layout_content_ScriptManager_TSM	;;System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI, Version=2014.2.618.40, Culture=neutral, PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a __EVENTTARGET	M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download __EVENTARGUMENT	 UsePrinterFriendlyVersion	Off __VIEWSTATEID	MWI4NjIwNWYxNWE3NGRlMmI4NDdlM2Y3YThmZWQ1MGY0MDIzYjkzNTVhNzk0MGY1ODk5MmYxZGFlMTIyMzZmOA== __VIEWSTATE	 __EVENTVALIDATION	Dq4ANo24bMi1/HDVLu+38eDdvjxtmkPWcmcA/D7gVf7bVNngM3QEmKFJJ2QBBHPtsbaI3acA3IF3yBOvy/FG5Mqb9MhA8sdAC4QBExi+mUy300xKYsl9XC/e+Hm6UdhKUccnYZE1i3hIONewLcmjxmvuOgGv1/a/TzeueIIhBdKVV1C0Ra7aeP3lck7EkwTEa7aNWi6evM62H1mzLBz07eKd498ReIfHJIc+AgDkeqatzpSDYQzTHIuL0vrULGta7x1ShWkSRLpZmCL7XNYd0aKVbM+OarfkHixAoU6CpK2sIfgM4UhNDYdnCwoPONih/GC4w7qodVzWEiYUsI5KCXnXIyk9aX813qsscxCthwmGzgPtKkag+jIjWk/MT8df/xVAF4u74jn8mfNcOVC2jHawWq314c3gNolby87EkJS4ahMy7HpDLEcdwvoTQvyuzRM9wEfRxD2HWOQisTWbDS+09uJbC6M9vQccVdQu2iPZl0L+HLfoDAUdizqGT+eTOR9iUoHZKzVYXDSrLi/y1gxZJ8ypm2Q5F6omn9BSFfbM7g9C8V7nvSnYhbzxuUnPHADW+wJ6XN5vMKgBSrbw8vkw8ifkBiQf+wu1nFeWbAwC23wisdj7YdRGjTqEOzYT0F8tPB8KKf4GWkDZptVZIohnX5MgFLMROOfYRSGtnLMF60RLuS7adB7wmpSnPTW0jbhCU1KDE11pvIi6MgBOzhl4qYCpcZLXCPgeM5yPvD/Wc77epo/oMpaiFyTxRAvl21Y6yD3dNZ8UFUbw3j9Rc5Gw47m+HAiVchVPwrVineKUfmTNiuu1WkpYapmWQoZyL+f23fyxAkQGGTjCQTIGrkE3l780gCZTF2ghSL19Y1mopRRW6WaOnzWZDAlJbFRNrebngsYylyvbnR3P5n7rsU1eLm/qWhmxCdegU8CKK3ui6lXInn4EiUSGosYhSgSm88MV2jCcaFVmo0m3CRtjT0SY2mlHYEtgtadt81Bn6DiwGuILWOUkBynwRHoXPgN2AG9GFI6in+gcg+pd4WizaFb8d+pX/uyenTRRyxNTW7+TbhepxH87fS8zcQ4gxvBk8CZQGN/roC/siTKtnU8552eYrBc/A2cik5uAUvBG+9K20qpbDNBlsIlZpFbP/Wy+OQS4nfR58Al7BFn7kvO5SdyaLcto35uBqnXetEZInLoolGcsYCrnrcBdYmdbtcVuxRlJI9h/aQTakYKuvQJwtQ2sxlkhk2VAREpNozPREr2XeqA9+7DLJyaaMpDxc9MxBHSryywoFlyLXneyvjnBlO8TZAnfV0HTy+BDYtqXIuiK7s1yNQwRSCYKnM2BDzoXm1hmifDNANCTiefbWNw2saBtxBU5yxyx1vTBzcXNclQ= ************************************************************************************

CSVDOWNLOAD,FindSignature,"There are no transactions within the specified dates.",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,"There are no Transactions to display",
,If-TRUE-Goto,NextHisAcct,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",	//FI 5341
,If-TRUE-Goto,skipThisSign,

,FindSignature,"No transactions matched your search.",
,If-TRUE-Goto,NextHisAcct,

skipThisSign,FindSignature,"There is no account activity",
,If-TRUE-Goto,NextHisAcct,

,FindSignature,">NO ACTIVITY<",
,If-TRUE-Goto,NextHisAcct,

//,FindSignature,"Account Activity is not available",
//,If-TRUE-Goto,NextHisAcct,

GoForCSV,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2189/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,GOHERE, 

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://infinityfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,
                                   
,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GOHERENew,

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",	//FI 12590
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,GOHERE,

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,createThisForm,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skipcontent11, 

createThisForm,CreateForm,"Form1"|"./Activity.aspx",

,Goto,GOHERE123,


GOHERE,CreateForm,"Form1"|"./AccountActivity.aspx",

GOHERE123,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,PostURL,||"Form1",

,Goto,CSVdown,
			   


GOHERENew,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SKIpp_myoccu,

////********************* |CSV Posting For FI ID 4818|******************************

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_L_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off",
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate,
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$checkNumber"|"",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$endCheckNumber"|"",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$description"|"",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$endAmount"|"",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$search"|"",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$search"|"1",

,PostURL,"https://myoccu.onlinebank.com/ViewAccounts/AccountActivity.aspx",

,FindString,"Download For:",  // Selection for the download option 
,MoveToTag,"a",
,GetDataFromTag,EVENTTARGET||"id",
,FindReplace,"_"|":"|EVENTTARGET,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"EVENTVALIDATION" value="##KEEP##""|test,//"

,SetPostURLData,"M_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:d28568d3-e53e-4706-928f-3765912b66ca:ea597d4b:b25378d2",
,SetPostURLData,"__EVENTTARGET"|EVENTTARGET,
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|,
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$selectedAccount"|acctValue|,
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$ClearedDateChoices"|"-2"|,
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$calFromDate$TB"|sdate|,
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$calToDate$TB"|edate|,
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$transactionTypes"|"none_selected",
	
,PostURL,||,

,Goto,CSVdown,
////********************* |END - CSV Posting For FI ID 4818|******************************


////********************* |Start - CSV Posting For FI ID 7575|******************************
CSVLayoutFor7575,CreateForm,"Form1"|"https://allsouth.onlinebank.com/Accounts/AccountActivity.aspx",


,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$endAmount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1"|"Form1",


,PostURL,||"Form1",
//--------------------------------------
,Assign,looping1|0,
ActivityScrapping,NOP,,
//--------------------------------------
,FindString,"Download For:",  // Selection for the download option 
,MoveToTag,"a",
,GetDataFromTag,EVENTTARGET||"id",
,FindReplace,"_"|":"|EVENTTARGET,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"EVENTVALIDATION" value="##KEEP##""|test,//"

,CreateForm,"Form1"|"https://allsouth.onlinebank.com/Accounts/AccountActivity.aspx",


,SetPostURLData,"M_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:d28568d3-e53e-4706-928f-3765912b66ca:ea597d4b:b25378d2"|"Form1",
,SetPostURLData,"__EVENTTARGET"|EVENTTARGET|"Form1",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form1",
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$content$PCDZ$M3I76QR$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$endCheckNumber"|""|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$description"|""|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$endAmount"|""|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$search"|""|"Form1",	

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8"|"Form1",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5"|"Form1",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br"|"Form1",
,SetHeader,"Referer"|"https://allsouth.onlinebank.com/Accounts/AccountActivity.aspx"|"Form1",
,SetHeader,"Connection"|"keep-alive"|"Form1",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0"|"Form1",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded"|"Form1",

,PostURL,||"Form1",

,Goto,CSVdown,

////********************* |END  - CSV Posting For FI ID 7575|******************************



SKIpp_myoccu,CreateForm,"Form1"|"./AccountActivity.aspx",

,SetPostURLData,"M_L_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:0f2ae90c-87fb-4f74-9210-4b167170d85e:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:88144a7a:ed16cbdc"|"Form1",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:L:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$L$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",

,PostURL,||"Form1",

,Goto,CSVdown,

Skipcontent11,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/kpcu/SignIn.aspx",
,If-TRUE-Goto,kpcuform,

,ExtractFromRawPage,aname1|"name[=]["]M[$]layout[$]content[$]PCDZ[$]MKLLCE4[$]ctl00[$]AccountNickName["] type[=]["]text["] autocomplete[=]["]off["] value[=]["]##KEEP##["]"|test,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,Createform5,
  
,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CreateformViewAccounts,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-FALSE-Goto,C_Form,

,CreateForm,"Form1"|"https://nasb.onlinebank.com/Accounts/AccountActivity.aspx",
,Goto,posting,

C_Form,Goto,Createform,

,If-FALSE-Goto,Skip_form,

Skip_form,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,Createform1,

kpcuform,CreateForm,"Form1"|"kpcu/Accounts/AccountActivity.aspx",
,Goto,posting,

CreateformViewAccounts,CreateForm,"Form1"|"ViewAccounts/AccountActivity.aspx",
,Goto,posting,
  
create_this,CreateForm,"Form1"|"/OnlineBanking/Accounts/AccountActivity.aspx",
,Goto,posting,

Createform1,CreateForm,"Form1"|"/2194/Accounts/AccountActivity.aspx",
,ExtractFromRawPage,aname1|"name[=]["]M[$]layout[$]content[$]PCDZ[$]MKLLCE4[$]ctl00[$]AccountNickName["] type[=]["]text["] autocomplete[=]["]off["] value[=]["]##KEEP##["]"|test,
,Goto,posting,

Createform5,CreateForm,"Form1"|"https://ebanking.realtorsfcu.org/2126/Accounts/AccountActivity.aspx",
,ExtractFromRawPage,aname1|"name[=]["]M[$]layout[$]content[$]PCDZ[$]MKLLCE4[$]ctl00[$]AccountNickName["] type[=]["]text["] autocomplete[=]["]off["] value[=]["]##KEEP##["]"|test,
,Goto,posting,

Createform2,CreateForm,"Form1"|"/FirstCountyBank/Accounts/AccountActivity.aspx",
,Goto,posting,

Createform3,CreateForm,"Form1"|"https://secure.myvirtualbranch.com/mywestfieldbank/Accounts/AccountActivity.aspx",
,Goto,posting,

Createform,CreateForm,"Form1"|"/Accounts/AccountActivity.aspx",

posting,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,Skip_wecu,

,SetPostURLData,"__EVENTTARGET"|""|"Form1",
,Goto,Con_posting,

Skip_wecu,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
Con_posting,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname1|"Form1"
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",

,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$endAmount"|""|"Form1"
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1"|"Form1",

,PostURL,||"Form1",

,FindSignature,"No transactions matched your search.",
,If-TRUE-Goto,NextHisAcct,

,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-FALSE-Goto,SKP_ACH_detail,

,FindString,"Account Number"|test,
,If-FALSE-Goto,SKP_ACH_detail,

,MoveToTag,"td"|test,
,If-FALSE-Goto,SKP_ACH_detail,

,GetDataFromTag,|Real_Acc|,
,RemoveHTMLTags,Real_Acc,
,RemoveExtraWhitespaces,Real_Acc,

,FindString,"Routing Number"|test,
,If-FALSE-Goto,SKP_ACH_detail,
,MoveToTag,"td"|test,
,If-FALSE-Goto,SKP_ACH_detail,

,GetDataFromTag,|Routing_Num|,
,RemoveHTMLTags,Routing_Num,
,RemoveExtraWhitespaces,Routing_Num,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_Num|hIndex,   
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|Real_Acc|hIndex, 


,MoveToTopOfPage,,


SKP_ACH_detail,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-FALSE-Goto,skipform2,

,Assign,aname1|aname,


skipform2,CreateForm,"Form1"|"/Accounts/AccountActivity.aspx",

postform1,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M2SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname1|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,PostURL,||"Form1",



newCSV2169,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-FALSE-Goto,CSVdown,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,

,CreateForm,"Form3"|"/AccountActivity.aspx"
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:ME35VAD:ctl00:DownloadOptions:ctl00:Download"|"Form3",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form3",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form3",
,SetPostURLData,"__VIEWSTATE"|""|"Form3",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form3",
,SetPostURLData,"M$layout$content$PCDZ$MW8U509$ctl00$AccountNickName"|aname|"Form3",

,PostURL,"https://langleyfcu.onlinebank.com/Accounts/AccountActivity.aspx"||"Form3",


CSVdown,CSV-GetReader,reader|##VPAGE##|count,

// ************************* NEWLY ADDED CSV MACROS IMPLEMENTATION ****************************************
// ********************************************************************************************************


,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,skipACHDetails,


,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|REAL_ACH_Number|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_number|hIndex,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|REAL_ACH_Number|hIndex,
,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_number|hIndex,

//,CSV-GetReader,reader|##VPAGE##|count,
//This variable will hold the value for csv files column count.

skipACHDetails,CSV-GetHeaderPosition,datePosition|""Date""|reader|test,
,If-TRUE-Goto,SkipCheck,

,CSV-GetHeaderPosition,datePosition|"Date"|reader|test,
,If-TRUE-Goto,SkipCheck,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,return2pp,


SkipCheck,CompareNumbers,datePosition|count|>=,
,If-TRUE-Goto,return2pp,

,CSV-GetHeaderPosition,DescriptionPosition|"Description"|reader,
,If-TRUE-Goto,skipThisDescription,

,CSV-GetHeaderPosition,DescriptionPosition|"Transaction Description"|reader,
,If-FALSE-Goto,return2pp,

skipThisDescription,CompareNumbers,DescriptionPosition|count|>=,
,If-TRUE-Goto,return2pp,

,CSV-GetHeaderPosition,Memo|"Comments"|reader,
,If-FALSE-Goto,return2pp,

,CompareNumbers,Memo|count|>=,
,If-TRUE-Goto,return2pp,

,CSV-GetHeaderPosition,CheckNumPosition|"Check Number"|reader,
,If-FALSE-Goto,return2pp,

,CompareNumbers,CheckNumPosition|count|>=,
,If-TRUE-Goto,return2pp,

,CSV-GetHeaderPosition,AmountPosition|"Amount"|reader|test,
,If-FALSE-Goto,return2pp,

,CompareNumbers,AmountPosition|count|>=,
,If-TRUE-Goto,return2pp,

// **********************************************************************************************************

nextRecord,CSV-GetRecord,record|reader|test,
,If-FALSE-Goto,return2pp,

,CSV-GetValue,date|record|datePosition,
,ConvertToValidDate,date|test,
,If-FALSE-Goto,return2pp,

,CSV-GetValue,desc|record|DescriptionPosition,
,RemoveExtraWhitespaces,desc,

,CSV-GetValue,desc2|record|Memo,
,RemoveExtraWhitespaces,desc2,

,ParseString,srore|"Processed##KEEP##"|desc2,
,If-TRUE-Goto,nextRecord,

,Compare,desc|desc2,
,If-TRUE-Goto,skipappend,

,Compare,desc2|"",
,If-TRUE-Goto,skipappend,

,AppendVars,desc|" ",
,AppendVars,desc|desc2,

skipappend,CSV-GetValue,checkNum|record|CheckNumPosition,

,Compare,checkNum|"",
,If-TRUE-Goto,skipthis,

SkpThsAsgn12,AppendVars,desc|" #",
,AppendVars,desc|checkNum,

skipthis,CSV-GetValue,amt|record|AmountPosition,

,ParseString,amount|"[(]##KEEP##[)]"|amt,
,If-FALSE-Goto,chkacctype,
,Assign,amt|amount,
,AppendVars,amt|"-",
,ConvertToValidDollar,amt,

chkacctype,Compare,AccTypeID|"200",
,If-FALSE-Goto,goforconvert,

,Compare,institutionId|"5341",
,If-TRUE-Goto,goforconvert,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,goforconvert,

,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,goforconvert,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,goforconvert,

,Compare,amt|"$0.00",
,If-TRUE-Goto,goforconvert,

,AppendVars,amt|"-",
goforconvert,ConvertToValidDollar,amt,


,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,getthisHINDEX,

,Add,trans|1,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|date|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|desc|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|amt|hIndex|trans,

,Goto,takenextRecord,

getthisHINDEX,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-FALSE-Goto,sdsdsdsds,


//,Compare,checkNum|"",							
//,If-TRUE-Goto,nextRecord,						
//,SetReturnData,##TABLE TP_ACCOUNT_TXN:REFERENCE_NO##|checkNum|HISINDEX|trans,
//,Goto,nextRecord,


sdsdsdsds,Add,trans|1,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|date|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|desc|hIndex|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|amt|hIndex|trans,

takenextRecord,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com",
,If-FALSE-Goto,GoCompare,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|REAL_ACH_Number|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_number|hIndex,

,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|REAL_ACH_Number|hIndex,
,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|Routing_number|hIndex,


GoCompare,Compare,checkNum|"",							
,If-TRUE-Goto,nextRecord,						
,SetReturnData,##TABLE TP_ACCOUNT_TXN:REFERENCE_NO##|checkNum|hIndex|trans,
,Goto,nextRecord,


,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-FALSE-Goto,return2pp2,

,ReturnToPreviousPage,3,
,Goto,nextone,

return2pp,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,prev2,
  
//,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
//,If-TRUE-Goto,prev2,
  
,Compare,RoutingNumber|"",
,If-TRUE-Goto,return2pp2,
  
,Compare,achAccountNumber|"",
,If-TRUE-Goto,return2pp2,
  
,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|hIndex,   
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|hIndex, 
  
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-FALSE-Goto,return2pp2,

prev2,ReturnToPreviousPage,2,
,Goto,nextone,

prev4,ReturnToPreviousPage,4,
,Goto,nextone,

return2pp2,GetURL,AccURL|,

//,ReturnToPreviousPage,,
//--------------------------------------
,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-FALSE-Goto,nextone,
 
,Add,looping1|1,
,Compare,looping1|2,
,If-TRUE-Goto,nextone,

,FindSignature,">Pending Transactions<",
,If-TRUE-Goto,ActivityScrapping,
//--------------------------------------
nextone,Goto,NextHisAcct,

NewEZCardInfo,Assign,trans|0,

,SetHeader,"User-Agent"|"Mozilal/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0",

,SetHeader,"X-AspNet-Version"|"-2.0.50727",
,SetHeader,"X-Powered-By"|"ASP.NET",

,SetHeader,"Location"|"https://www.ezcardinfo.com/login.aspx?SSOPacket=_cHiGIMt1qHBNtMqF0MiIPpkwqAhT6ZDnLN9etcLrnJYkio4n__IgyWy-RYcvAJoI3YhUt9eBT5LRDAiJkCKxsKgkuJXaqbnDNhVLaiYguPCrGjTr94UvXBrJm9Si7iLZLChgvVWv9BePuXpGj4LyWgc8IJJ48RVgu6jJRBIb332bHnPAvt__TXaoXPsHWZ0p41Ku2h2iU59z-kWAHcz5Dsi6TMqWbaT1JXzPCYRProidLx2RpAPVb36cGhCfj2OwU5UKuSjION0D2c247PrIo3xnphChC6hY-tsDx8vk-KUOfei82-U5TQcaBE791axGIcWEUpIpzVL3Ax0xA8KQoaVMXAN_P60CVTiEjtCvo1w-7F6rJgW4RNGzzLknkegrz65CxP5qaFKvkJi8pI5Gx2KgAkNKgx3LhXxaaN84HO7v9dKB-uc5b9tqebC05Ac",
,SetHeader,"Connection"|"keep-alive",
,GetURL,sURL1|,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0",
,GetURLv2,"https://www.ezcardinfo.com/Secure"|,

,FindString,"X-Csrf-Token"|test,
,GetDataAfterString,X-Csrf-Token|": '"|"_:-+@#$%"|test,

,FindString,"X-Security-Token"|test,
,GetDataAfterString,X-Security-Token|": '"|"_:-+@#$%"|test,

,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0",
,SetHeader,"X-Security-Token"|X-Security-Token,
,SetHeader,"X-Csrf-Token"|X-Csrf-Token,

,GetURLv2,"https://www.ezcardinfo.com/api/User/current"|,

,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0",
,SetHeader,"X-Security-Token"|X-Security-Token,
,SetHeader,"X-Csrf-Token"|X-Csrf-Token,

,GetURLv2,"https://www.ezcardinfo.com/api/Statement?"|,

,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0",
,SetHeader,"X-Security-Token"|X-Security-Token,
,SetHeader,"X-Csrf-Token"|X-Csrf-Token,

,GetURLv2,"https://www.ezcardinfo.com/api/Transaction?"|,

,Assign,ed|"[",

NEXT,GetDataAfterString,id|""Id":"||test, //"

,If-FALSE-Goto,getthist,

,FindString,"PostingDate",
,GetDataAfterString,postdate|":"|"-",
,ParseString,postdate|"##KEEP##T"|postdate,


,CompareDates,postdate|##STARTDATE##|<,
,If-TRUE-Goto,NEXT,

,AppendVars,ed|id,
,AppendVars,ed|"##COMMA##",
,Goto,NEXT,

getthist,AppendVars,ed|"]",

,CreateForm,"Form1"|"https://www.ezcardinfo.com/file/Export",

,SetPostURLData,"exportType"|"1"|"Form1",
,SetPostURLData,"ids"|ed|"Form1",
,PostURL,||"Form1",

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,SkpThisError417,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|##STARTDATE##,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|postdate,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,
,Goto,NextReturnP,

SkpThisError417,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,NextReturnP,

,Assign,temp_date|##STARTDATE##,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|postdate,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

NextReturnP,ReturnToPreviousPage,,
,Goto,NextHisAcct,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",
,GetURL,"https://ebanking.realtorsfcu.org/2126/Accounts/AccountSummary.aspx"|,

NewMYCardInfo,ExtractFromRawPage,URL_nwfcu|"Navigate["]##COMMA##["]url["][:]["]##KEEP##["]"|test, "//

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",
,GetURL,URL_nwfcu|,

NewMYCardInfoCheck,FindSignature,"To help us more efficiently service your account in the future##COMMA## please provide a current email address below.",
,If-TRUE-Goto,NextHisAcct,

,FindString,"View All Transactions"|test,
,If-FALSE-Goto,NextHisAcct,

,MoveToTag,"a"|"REV",
,GetDataFromTag,TraAll||"href",

,GetURL,TraAll|,

,ExtractFromRawPage,VIEWSTATE|"id[=]["]__VIEWSTATE["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,VIEWSTATEGENERATOR|"id[=]["]__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,EVENTVALIDATION|"id[=]["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",

,Assign,translink|"./AccountTransactions.aspx?vw=all",

,CreateForm,"loginform"|translink,
,SetPostURLData,"ctl00$MainContent$txtCustomDateBegin"|sdate|"loginform",
,SetPostURLData,"ctl00$MainContent$txtCustomDateEnd"|edate|"loginform",
,SetPostURLData,"ctl00$MainContent$rblFileTypes"|"qfx"|"loginform",
,SetPostURLData,"ctl00$MainContent$btnDownload"|"Continue"|"loginform",
,SetPostURLData,"__VIEWSTATE"|VIEWSTATE|"loginform",
,SetPostURLData,"__VIEWSTATEGENERATOR"|VIEWSTATEGENERATOR|"loginform",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"loginform",
,PostURLr,"/downloadtransactions.ashx?m=qfx"||"loginform"|translink,

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,SKpThisErr417,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,NextReturnP,

SKpThisErr417,ExtractFromRawPage,storage|"<?xml ##KEEP##"|test,
,RemoveInvalidSpecialCharacter,storage,

,FindReplace,"\?"|""|storage|test,
,ParseString,srore1|"version##KEEP##["][>]"|storage, //"
,FindReplace,srore1|""|##VPAGE##|test,   //
,FindReplace,"version="1.0" encoding="USASCII" standalone="no"><OFX"|""|storage,
,ReloadVPage,storage,

,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,SkpZeroTLogs,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

SkpZeroTLogs,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,skipGetDiscovery,


,GetURL,"https://ebanking.nwfcu.org/2126/Accounts/AccountSummary.aspx"|,


skipGetDiscovery,Goto,NextHisAcct,

//*****************************************************

CheckthisHist,Compare,##REQUEST##|"DISCOVERY", 
,If-TRUE-Goto,logout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD", 
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Assign,hIndex|0,

NextHisAcct11,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Assign,trans|0,
,Add,hIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

//***************************************************************************************************************************************//

,Assign,tempName|aname,
,Assign,tempNum|anum,

,ParseString,srore|"##KEEP##-"|tempNum,
,If-FALSE-Goto,SkipThispart,

,StrRev,tempNum,

,ParseString,tempNum|"##KEEP##-"|tempNum,
,StrRev,tempNum,

//***************

SkipThispart,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",    //FI ID:100394
,If-TRUE-Goto,SkipThisTower,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-FALSE-Goto,SkipSDCCUlayout,

SkipThisTower,MoveToTopOfPage,,

,Compare,institutionId|"100368",
,If-FALSE-Goto,SkipACHdeatails,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,SkipACHdeatails,

,Assign,TOWERWEBSITEcheck|##TOWER_WEBSITE##,

,ParseString,TOWER|"##KEEP##SignIn.aspx"|TOWERWEBSITEcheck,

,AppendVars,TOWER|"TransfersAccountNumberInformation.aspx",

,GetURLv2,TOWER||test,
,If-FALSE-Goto,SkipACHdeatails,

,FindString,">Account<"|test,
,If-FALSE-Goto,SkipACHdeatails,

,MoveToTag,"select"|test,
,If-FALSE-Goto,SkipACHdeatails,

,FindString,aname|test,
,If-FALSE-Goto,SkipACHdeatails,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,SkipACHdeatails,

,GetDataFromTag,achAccountNumber||"value",

,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,Compare,achAccountNumber|"",
,If-TRUE-Goto,SkipACHdeatails,

,FindString,">Routing Number<"|test,
,If-FALSE-Goto,SkipACHdeatails,

,MoveToTag,"INPUT"|test,
,If-FALSE-Goto,SkipACHdeatails,
,GetDataFromTag,RoutingNumber||"value",

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

SkipACHdeatails,FindString,"Account Activity"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,ActivityURL||"href",

,GetURLv2,ActivityURL|,

,ParseString,OFXURL|"##KEEP##/SignIn.aspx"|##TOWER_WEBSITE##,
,AppendVars,OFXURL|"/Accounts/WebConnect.aspx",

,GetURLv2,OFXURL|,

//------

,Assign,tempName|aname,

,FindReplace,"&"|"&amp;"|tempName|test,
,FindReplace,"'"|"&#39;"|tempName|test,

,FindString,">Select the account<"|test,
,MoveToTag,"select"|test,
,GetDataFromTag,VALUE||"id",

,ParseString,VALUE2|"M_layout_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,

,Assign,tempNum2|">",
,AppendVars,tempNum2|tempNum,
,FindString,tempNum2|test,
,If-TRUE-Goto,Getaccval,

,FindString,tempNum|test,
,If-TRUE-Goto,Getaccval,
,FindString,tempName|test,
,If-TRUE-Goto,Getaccval,

//***************

SkipSDCCUlayout,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-FALSE-Goto,GoFornexturl,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,CSVLayout1,


GoFornexturl,GetURLv2,"https://my.communityfirstcu.org/Acct/Export/Activity.aspx"||test,

,FindSignature,"currently experiencing system issues",
,If-FALSE-Goto,SkipOtheConnect11,

,GetURLv2,"/Export/Activity.aspx"||test,

SkipOtheConnect11,FindString,"Select the account"|test,
,If-FALSE-Goto,Skippp,

,MoveToTag,"select"|test,
,GetDataFromTag,VALUE||"id",

,ParseString,VALUE2|"M_layout_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,

,FindString,anum|test,
,If-TRUE-Goto,Getaccval,

Getaccval,MoveToTag,"option"|"REV"|test,
,If-TRUE-Goto,GETTAGVALUE,

,AppendVars,tempNum|" - ",
,AppendVars,tempNum|tempName,

,FindString,tempNum|test,
,If-FALSE-Goto,NextHisAcct11,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,NextHisAcct11,


GETTAGVALUE,GetDataFromTag,ACCNTVALUE||"value"|test,
,If-FALSE-Goto,NextHisAcct11,


,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

//**********************************************************************************************************

,Assign,accountDropDown|"M$layout$content$PCDZ$XXXXXX$ctl00$accountDropDown",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calStartDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calEndDate$TB",
,Assign,quickenWebConnectButton|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.x",
,Assign,quickenWebConnectButton1|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.y",
,Assign,__EVENTTARGET|"M$layout$content$PCDZ$XXXXXX$ctl00$accountDropDown",


,FindReplace,"XXXXXX"|VALUE2|accountDropDown|test,
,FindReplace,"XXXXXX"|VALUE2|StartDate|test,
,FindReplace,"XXXXXX"|VALUE2|EndDate|test,
,FindReplace,"XXXXXX"|VALUE2|quickenWebConnectButton|test,
,FindReplace,"XXXXXX"|VALUE2|quickenWebConnectButton1|test,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",     // FI ID: 100394 
,If-FALSE-Goto,skipMycfcuLayout,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__VIEWSTATE"|"",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$lstDownloadFormat"|"QFX",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$btnDownload"|"Download",

,Goto,GoTransactionPost,

skipMycfcuLayout,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,accountDropDown|ACCNTVALUE,
,SetPostURLData,StartDate|STRTDATE,
,SetPostURLData,EndDate|ENDDATE,
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,


//**********************************************************************************************************

//,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
//,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
//,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,
//,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown",

//**********************************************************************************************************

GoTransactionPost,Assign,PostingURL|##TOWER_WEBSITE##,
,ParseString,PostURL|"##KEEP##/SignIn.aspx"|PostingURL,
,If-FALSE-Goto,SkipThisAppend,

,AppendVars,PostURL|"/Accounts/WebConnect.aspx",
,Goto,GoToPostURLr,

SkipThisAppend,ParseString,PostURL|"##KEEP##/LogIn.aspx"|PostingURL,
,If-FALSE-Goto,GoToLabel,

,AppendVars,PostURL|"/Acct/Export/Activity.aspx",

GoToPostURLr,PostURLr,PostURL|||##URL##, 
,Goto,profurther,

GoToLabel,NOP,

//*****************************************************
//,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",     // FI ID: 100368 
//,If-TRUE-Goto,SkipThisPost,

//,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
//,If-FALSE-Goto,SkipSDCCUpst,

//,PostURLr,"https://ib.sdccu.com/SDCCU/Accounts/WebConnect.aspx"|||##URL##, 
//,Goto,profurther,

//SkipThisPost,PostURLr,"https://mycfcu.onlinebank.com/Accounts/WebConnect.aspx"|||##URL##, 
//,Goto,profurther,

//SkipSDCCUpst,PostURLr,"https://my.communityfirstcu.org/Acct/Export/Activity.aspx"|||##URL##, 

//*****************************************************


profurther,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",     // FI ID: 100394 
,If-TRUE-Goto,SKipThisForMycfcu,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded"|"T",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"IDS_X_Coord"|"0",
,SetPostURLData,"IDS_Y_Coord"|"0",
,SetPostURLData,accountDropDown|ACCNTVALUE,
,SetPostURLData,StartDate|STRTDATE,
,SetPostURLData,EndDate|ENDDATE,
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,quickenWebConnectButton|"0",
,SetPostURLData,quickenWebConnectButton1|"0",


//,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
//,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
//,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
//,SetPostURLData,"IDS_X_Coord"|"0",
//,SetPostURLData,"IDS_Y_Coord"|"0",
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$accountDropDown"|ACCNTVALUE,
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calStartDate$TB"|STRTDATE,
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$calEndDate$TB"|ENDDATE,
//,SetPostURLData,"__EVENTTARGET"|"",
//,SetPostURLData,"__EVENTARGUMENT"|"",
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.x"|"124",
//,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$quickenWebConnectButton.y"|"8",

,PostURL,||, 

SKipThisForMycfcu,FindSignature,"No transactions found for specified date range",
,If-TRUE-Goto,NextHisAcct11,

,FindSignature,"There are steps you need to take to reconnect your Quicken or Quickbooks account to your SDCCU account",
,If-TRUE-Goto,Error108_1,

,Compare,customerId|"14957010",
,If-FALSE-Goto,storePage2,

,StoredHTTPResponse,,


storePage2,FindSignature,"OFXHEADER",
,If-TRUE-Goto,SkpError417Log,            

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,
,Goto,NextHisAcct11,

SkpError417Log,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,skipZeroLogss,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

skipZeroLogss,ParseString,srore|"400##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,Skipreturn,

,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

Skipreturn,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",         // FI ID: 100368
,If-FALSE-Goto,NextHisAcct11,

,ReturnToPreviousPage,,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,NextHisAcct11,

,Compare,institutionId|"100368",
,If-FALSE-Goto,NextHisAcct11,

,Compare,achAccountNumber|"",
,If-TRUE-Goto,NextHisAcct11,

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|hIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|hIndex,

,Goto,NextHisAcct11,

//****************************************************************************//

NewCCHisLayout,GetURL,"https://onlinexpress.gesa.com/Banking/CreditCardSummary.aspx"|,

//,Assign,HisIndex|0,
,Assign,cycleIndx|0,
,Assign,CountOfCycle|0,

,ConvertStringToInt,cycleIndx,
,ConvertStringToInt,CountOfCycle,


,FindString,"Select Period"|test,
next_option,MoveToTag,"option"|test,
,If-FALSE-Goto,startAgg,

,GetDataFromTag,cycleIndxVal||"value",
,Assign,CountOfCycle|cycleIndxVal,

,ConvertStringToInt,CountOfCycle,

,Goto,next_option,

startAgg,MoveToTopOfPage,,

//NxtAccHistNew,Compare,HisIndex|account,
//,If-TRUE-Goto,logout,

//,Add,HisIndex|1,
//,Assign,trans|0,

,FindString,anum|test,
,MoveToTag,"option"|"REV",
,GetDataFromTag,ddlAccount||"value",

next_cycle,CompareNumbers,cycleIndx|CountOfCycle|>, 
,If-TRUE-Goto,SKIPAdd_headers_centerstatebank,


,ExtractFromRawPage,scriptManager|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"%3b"|";"|scriptManager|test,
,FindReplace,"%2c"|"##COMMA##"|scriptManager|test,
,FindReplace,"%3d"|"="|scriptManager|test,
,FindReplace,"%3a"|":"|scriptManager|test,
,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,CreateForm,"CCTRANS"|"https://onlinexpress.gesa.com/Banking/CreditCardSummary.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"CCTRANS",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MMBUB8E$ctl00$ddlselectedPeriod"|"CCTRANS",
,SetPostURLData,"__EVENTARGUMENT"|""|"CCTRANS",
,SetPostURLData,"__LASTFOCUS"|""|"CCTRANS",

,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"CCTRANS",
,SetPostURLData,"__VIEWSTATE"|""|"CCTRANS",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"CCTRANS",

,SetPostURLData,"M$layout$content$PCDZ$M36HNUW$ctl00$ddlAccount"|ddlAccount|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$ddlselectedPeriod"|cycleIndx|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$txtDescription"|""|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$calRightPaymentDate$TB"|""|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$txtAmount"|""|"CCTRANS",

,PostURL,||"CCTRANS",

,FindSignature,"No Transactions exist",
,If-FALSE-Goto,GoWithCurrentcycle,

,Add,cycleIndx|1,
 
,Goto,next_cycle,

GoWithCurrentcycle,CreateForm,"CCTRANS"|"https://onlinexpress.gesa.com/Banking/CreditCardSummary.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"CCTRANS",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:MMBUB8E:ctl00:linkDownload"|"CCTRANS",
,SetPostURLData,"__EVENTARGUMENT"|""|"CCTRANS",
,SetPostURLData,"__LASTFOCUS"|""|"CCTRANS",

,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"CCTRANS",
,SetPostURLData,"__VIEWSTATE"|""|"CCTRANS",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"CCTRANS",

,SetPostURLData,"M$layout$content$PCDZ$M36HNUW$ctl00$ddlAccount"|ddlAccount|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$ddlselectedPeriod"|cycleIndx|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$txtDescription"|""|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$calRightPaymentDate$TB"|""|"CCTRANS",
,SetPostURLData,"M$layout$content$PCDZ$MMBUB8E$ctl00$txtAmount"|""|"CCTRANS",

,PostURL,||"CCTRANS",

//*************************CSV layout************************************///


,CSV-GetReader,reader|##VPAGE##|count,
 
,CSV-GetHeaderPosition,TxnDateposi|"Transaction Date"|reader|test,
,If-FALSE-Goto,HISTRYACCNT,

,CSV-GetHeaderPosition,TxnDescriptionposi|"Description"|reader,
,If-FALSE-Goto,HISTRYACCNT,

,CSV-GetHeaderPosition,TxnAmountposi|"Amount"|reader,
,If-FALSE-Goto,HISTRYACCNT,

 NextCSVRecord,CSV-GetRecord,record|reader|test,
 ,If-TRUE-Goto,scrapeTXN,
 
 ,Add,cycleIndx|1,
 
 ,ReturnToPreviousPage,,
 
,Goto,next_cycle,

 
scrapeTXN ,CSV-GetValue,TxnDate|record|TxnDateposi,
 ,ConvertToValidDate,TxnDate|test,
 ,If-FALSE-Goto,NextCSVRecord,
 
  ,CSV-GetValue,TxnDescription|record|TxnDescriptionposi,
 ,RemoveExtraWhitespaces,TxnDescription,
 
 ,CSV-GetValue,TxnAmount|record|TxnAmountposi,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-FALSE-Goto,traxamt,
,Compare, AccTypeID|"200",
,If-FALSE-Goto,traxamt,

,AppendVars, TxnAmount|"-"| 
traxamt,ConvertToValidDollar,TxnAmount|test,
 
 ,CompareDates,TxnDate|##STARTDATE##|<,
 ,If-TRUE-Goto,NextCSVRecord,
 
 ,CompareDates,TxnDate|##ENDDATE##|>,
,If-TRUE-Goto,NextCSVRecord,
 
 ,Add,trans|1,
 
 ,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|TxnDate|HISINDEX|trans,
 ,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|TxnDescription|HISINDEX|trans,
 ,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|TxnAmount|HISINDEX|trans,
 
 ,Goto,NextCSVRecord,

//*******************************************************************************************************
CheckthisHis1,Compare,##REQUEST##|"DISCOVERY", 
,If-TRUE-Goto,logout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD", 
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Assign,hIndex|0,

NextHisAcct111,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Assign,trans|0,
,Add,hIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

,GetURLv2,"https://weokie.e-creditunion.org/Accounts/AccountActivity.aspx"||test,
,GetURLv2,"https://weokie.e-creditunion.org/Accounts/WebConnect Account Download.aspx"||test,
,FindString,anum|test,
,If-FALSE-Goto,NextHisAcct111,

,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,ACCNTVALUE||"value",

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M71W58$ctl00$accountDropDown",


,PostURLr,"https://weokie.e-creditunion.org/Accounts/WebConnect Account Download.aspx"|||##URL##, 

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded"|"T",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$calEndDate$TB"|ENDDATE,
,SetPostURLData,"__EVENTTARGET"|"",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$quickenWebConnectButton.x"|"42",
,SetPostURLData,"M$layout$content$PCDZ$M71W58$ctl00$quickenWebConnectButton.y"|"21",

,PostURL,||, 

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,SkpErrorr417,   

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,NextHisAcct111,

SkpErrorr417,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,SkpTrnsLogs,

,Assign,temp_date|STRTDATE,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|ENDDATE,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

SkpTrnsLogs,ParseString,srore|"400##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,Skipreturn1,

,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|hIndex,

Skipreturn1,Goto,NextHisAcct111,


//*****************************************************

NewMyCardInfo,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0",

,GetURL,sURL1|,

,FindString,"Account Activity",
,MoveToTag,"a"|"REV",
,GetDataFromTag,ActivityURL||"href",

,GetURLv2,ActivityURL|,

,ExtractFromRawPage,VIEWSTATE|"id[=]["]__VIEWSTATE["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,VIEWSTATEGENERATOR|"id[=]["]__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,EVENTVALIDATION|"id[=]["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",

,SetPostURLData,"ctl00$MainContent$txtCustomDateBegin"|sdate|"aspnetForm",
,SetPostURLData,"ctl00$MainContent$txtCustomDateEnd"|edate|"aspnetForm",
,SetPostURLData,"ctl00$MainContent$rblFileTypes"|"qfx"|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|"ctl00$MainContent$btnCustomDates"|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|VIEWSTATE|"aspnetForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|VIEWSTATEGENERATOR|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"aspnetForm",

,PostURL,||"aspnetForm",


,ExtractFromRawPage,VIEWSTATE|"id[=]["]__VIEWSTATE["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,VIEWSTATEGENERATOR|"id[=]["]__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test
,ExtractFromRawPage,EVENTVALIDATION|"id[=]["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",


//,CreateForm,"Form1"|ActivityURL,

,SetPostURLData,"ctl00$MainContent$txtCustomDateBegin"|sdate|"aspnetForm",
,SetPostURLData,"ctl00$MainContent$txtCustomDateEnd"|edate|"aspnetForm",
,SetPostURLData,"ctl00$MainContent$rblFileTypes"|"qfx"|"aspnetForm",
,SetPostURLData,"ctl00$MainContent$btnDownload"|"Continue"|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|VIEWSTATE|"aspnetForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|VIEWSTATEGENERATOR|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"aspnetForm",

,PostURL,||"aspnetForm",

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,SktThisError417,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,NextReturnP,

SktThisError417,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,SkpZeroLog,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

SkpZeroLog,Goto,NextHisAcct,


//===============================================================
//		New OFX Layout for MyMutualBank
//===============================================================
//MyMutualBankNew

,Assign,hIndex|0,

,Assign,trans|0,

NextAccountTxn,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Add,hIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|hIndex,

,GetURL,"https://secure.myvirtualbranch.com/MyMutualBank/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx",

,FindString,aname|test,
,If-FALSE-Goto,NextAccountTxn,

,MoveToTag,"option"|"REV",

,GetDataFromTag,value||"value",

,CreateForm,"MutualBank"|"https://secure.myvirtualbranch.com/MyMutualBank/cc4879c5-4f46-4750-bbd9-33c3a143a9d8.aspx",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"MutualBank",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"MutualBank",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlAccount"|value|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$rblStockDateRanges"|"-2"|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$FromDate$TB"|##STARTDATE##|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ToDate$TB"|##ENDDATE##|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$ddlFormat"|"2"|"MutualBank",
,SetPostURLData,"M$layout$content$PCDZ$MSB9IUY$ctl00$btnDownload"|"Download"|"MutualBank",

,SetPostURLData,"__EVENTTARGET"|""|"MutualBank",
,SetPostURLData,"__EVENTARGUMENT"|""|"MutualBank",
,SetPostURLData,"__VIEWSTATE"|""|"MutualBank",

,PostURL,||"MutualBank",

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,GOFOROFX,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,temp_date|##STARTDATE##,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|##ENDDATE##,

,Assign,NoTrxnLog|"NO Transactions ",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|temp_date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" CustomerID :- ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,Goto,NextAccountTxn,

GOFOROFX,Add,trans|1,

,GetStatementFromOFX,hIndex|trans|##STARTDATE##|##ENDDATE##,

,Compare,trans|0,
,If-FALSE-Goto,SkpZeroLLog,

,Assign,temp_date|##STARTDATE##,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|##ENDDATE##,

,Assign,ZeroTrxnLog|"Zero Transaction ",
,AppendVars,ZeroTrxnLog|##REQUEST##,
,AppendVars,ZeroTrxnLog|" from date:- ",
,AppendVars,ZeroTrxnLog|temp_date,
,AppendVars,ZeroTrxnLog|" of FIID ",
,AppendVars,ZeroTrxnLog|institutionId,
,AppendVars,ZeroTrxnLog|"CustomerID :- ",
,AppendVars,ZeroTrxnLog|customerId,
,Log,ALERT|ZeroTrxnLog|,

SkpZeroLLog,Goto,NextAccountTxn,


//===============================================================
//		P D F  - S E C T I O N
//===============================================================

STATEMENT_DOWNLOAD,Assign,stmtIndex|0,

stmtLoop,Compare,stmtIndex|account,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,GetReturnData, ##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|stmtIndex,

,ConvertDateToText,##STMTDATE##|month|"MM",
,ConvertDateToText,##STMTDATE##|year|"yyyy",

,Compare,institutionId|"4399",
,If-FALSE-Goto,skipNorthWeststmt,

,Compare,AccTypeID|"200",
,If-TRUE-Goto,NorthwestCreditCardLayout,

skipNorthWeststmt,Compare,institutionId|"10771",
,If-TRUE-Goto,FR_FCU_PDF,

,Compare,institutionId|"12489",
,If-TRUE-Goto,FR_FCU_PDF,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,falconbanklayout,

,Compare,##TOWER_WEBSITE##|"https://online.bfsfcu.org/SignIn.aspx?p_r=1",
,If-TRUE-Goto,bfsfcuPDF,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,bossierfcu,

,Compare,##TOWER_WEBSITE##|"https://ib.sdccu.com/SDCCU/SignIn.aspx",     // FI ID: 100368 
,If-TRUE-Goto,SDCCUBank,

,Compare,##TOWER_WEBSITE##|"https://banking.hughesfcu.org/SignIn.aspx",
,If-TRUE-Goto,HughesFCU,

,Compare,##TOWER_WEBSITE##|"https://weokie.e-creditunion.org/SignIn.aspx",
,If-TRUE-Goto,e-creditunionlayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://ebranch.sunstatefcu.org/SignIn.aspx",
,If-TRUE-Goto,sunstatefcuLayout,

,Compare,##TOWER_WEBSITE##|"https://ebranch.radiantcu.org/SignIn.aspx",		// FI ID: 4231
,If-TRUE-Goto,sunstatefcuLayout,

,Compare,##TOWER_WEBSITE##|"https://online.sunflowerbank.com/SignIn.aspx",         // FI ID: 4566
,If-TRUE-Goto,sunstatefcuLayout,

,Compare,##TOWER_WEBSITE##|"https://independentbank.onlinebank.com/SignIn.aspx",  // FI ID: 7726
,If-TRUE-Goto,wecuBank,

,Compare,##TOWER_WEBSITE##|"https://trueskycu.onlinebank.com/SignIn.aspx",  //FI 7112
,If-TRUE-Goto,trueskycuLayout,

,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,sunstatefcuLayout,

,Compare,##TOWER_WEBSITE##|"https://www.anbtx.com",
,If-TRUE-Goto,AmericanStat,

,Compare,##TOWER_WEBSITE##|"https://anbtx.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewAmericanStat,

,ParseString,srore|"secure.myvirtualbranch.com/fairfieldfederal##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,GetMyMechanicsLayout, 

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,SouthWestAirlinesFCUstmt, 

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,SouthWestAirlinesFCUstmt, 

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-TRUE-Goto,westfieldlayout,

,Compare,institutionId|"7495",   
,If-TRUE-Goto,coastPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,westfieldlayout,

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2169/login.aspx",
,If-TRUE-Goto,LangleyFCUnion,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,SSOrequired,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Nextcheck111,
SSOrequired,GetURLv2,"/eStatementSSO.aspx"|,
,Goto,wecuBank,



Nextcheck111,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2190/login.aspx",
,If-TRUE-Goto,CoastalFCU,

,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,nwfcuPDF,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,ColonialFederal0750PDF,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,ColonialFederal0750PDF,

,Compare,##TOWER_WEBSITE##|"https://parknational.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,ParkNationalStatement,

,Compare,##TOWER_WEBSITE##|"https://ebanking.nwfcu.org/2126/SignIn.aspx",
,If-TRUE-Goto,nwfcuPDF,                                    

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2165/SignIn.aspx",
,If-TRUE-Goto,MapsBank, 

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,AFCU,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-TRUE-Goto,NewPDFLayout

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Laurelroadbank/SignIn.aspx",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",		// FI ID: 11688 
,If-TRUE-Goto,bossierfcu,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://online.apgfcu.com",
,If-TRUE-Goto,NewPDFLayout,

,Compare,##TOWER_WEBSITE##|"https://neighborsfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewPDFFloridaLayout,

,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewPDFFloridaLayout,
  
,Compare,##TOWER_WEBSITE##|"https://cpfcu.onlinebank.com/signin.aspx",
,If-TRUE-Goto,SouthWestAirlinesCU,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-TRUE-Goto,NewPDFcommunityfirstcu,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/jcsbank/signin.aspx",
,If-TRUE-Goto,jcsbankPDF, 

,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewMembersccu,

,Compare,##TOWER_WEBSITE##|"https://www.myswacu.org/SignIn.aspx",
,If-TRUE-Goto,SouthWestAirlinesCU, 
  
,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-TRUE-Goto,SouthWestAirlinesCU, 

,Compare,##TOWER_WEBSITE##|"https://arborfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,arborfcu, 

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-TRUE-Goto,CountyBank1,

,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,firstcommandbank,  

,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-TRUE-Goto,NewPDFFloridaLayout, 
 
,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,CountyBank, 

,Compare,##TOWER_WEBSITE##|"https://flushingbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,CountyBank,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,wecuBank,

,Compare,##TOWER_WEBSITE##|"https://secure.mapscu.com/SignIn.aspx",
,If-TRUE-Goto,MapscuBank,

,Compare,##TOWER_WEBSITE##|"https://onlinexpress.gesa.com/Banking/SignIn.aspx",
,If-TRUE-Goto,GesaBank, 

,Compare,##TOWER_WEBSITE##|"https://bankingonline.lfcu.org/signin.aspx",
,If-TRUE-Goto,GesaBank, 

,Compare,##TOWER_WEBSITE##|"https://bossierfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,bossierfcu, 

,Compare,##TOWER_WEBSITE##|"https://oceanbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,OceanBank,
  
,Compare,##TOWER_WEBSITE##|"https://collinsccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,collinsccuBank,

,Compare,##TOWER_WEBSITE##|"https://myoccu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,OregonBank, 

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.affinityplus.org/SignIn.aspx",
,If-TRUE-Goto,affinityplus,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,falconbanklayout,

,Compare,##TOWER_WEBSITE##|"https://fsb.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,NewPDFFloridaLayout,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,falconbanklayout,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-TRUE-Goto,falconbanklayout,

,FindSignature,">eDocuments<",
,If-TRUE-Goto,myvirtualbranch,

CoastalFCU,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-TRUE-Goto,GoForAREV,
  
,FindString,">e-Docs<"|test,
,If-FALSE-Goto,stmtLoop,

GoForAREV,MoveToTag,"a"|"REV",

,GetDataFromTag,sURL||"href",

,GetURLv2,sURL|,

,Compare,##TOWER_WEBSITE##|"https://secure.montecito.bank/SignIn.aspx",
,If-TRUE-Goto,Montecitobanklayout,

,Compare,##TOWER_WEBSITE##|"https://onlinebanking.northwest.bank/SignIn.aspx",
,If-TRUE-Goto,northwestbankstmtLayout,
  
,Compare,##TOWER_WEBSITE##|"https://mygenbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,mygenbanklayout,  
  
,FindString,"View my e-Docs"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV",

,GetDataFromTag,stmtURL||"href",

,GetURL,stmtURL|,

,ExtractFromRawPage,cuid|"cuid["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,member_num|"member_num["] value[=]["]##KEEP##["]"|test, //"

,FindString,"e-statement.com"|test,

,CreateForm,"Form1"|"https://mdg.e-statement.com/microdynamics/Estatement",
,SetPostURLData,"type"|"statement"|"Form1",
,SetPostURLData,"date"|"all"|"Form1",
,SetPostURLData,"cuid"|cuid|"Form1",
,SetPostURLData,"member_num"|member_num|"Form1",
,SetPostURLData,"sortby"|"date"|"Form1",
,SetPostURLData,"sort"|"DESC"|"Form1",
,PostURL,||"Form1",

,FindString,">Statements<"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,">Date<"|test,
,If-FALSE-Goto,stmtLoop,

nextStmt,MoveToTag,"tr"|test,
,If-FALSE-Goto,getRecent,

,MoveToTag,"td"|test,
,MoveToTag,"td"|test,
,MoveToTag,"a"|test,
,If-FALSE-Goto,getRecent,
,GetDataFromTag,PDFURL|check|"href",
,RemoveHTMLTags,check,

,ParseString,srore|"Credit Card##KEEP##"|check,
,If-TRUE-Goto,nextStmt,

,MoveToTag,"td"|test,
,If-FALSE-Goto,getRecent,
,GetDataFromTag,|statementDate|,
,RemoveHTMLTags,statementDate,

,ConvertToValidDate,statementDate|test,
,If-FALSE-Goto,getRecent,

,ConvertDateToText,statementDate|stmtMonth|"MM",

,ConvertDateToText,statementDate|statementYear|"yyyy",

,Compare,statementYear|year,
,If-FALSE-Goto,nextStmt,

,Compare,stmtMonth|month,
,If-FALSE-Goto,nextStmt,

scrapeData,GetURL,PDFURL|,

,GetURLb,accountStatement|PDFURL,

,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//===============================================================

getRecent,MoveToTopOfPage,,

,FindString,">Statements<"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,">Date<"|test,
,If-FALSE-Goto,stmtLoop,

nextStmt1,MoveToTag,"tr"|test,
,If-FALSE-Goto,stmtLoop,
,MoveToTag,"td",
,MoveToTag,"td",
,MoveToTag,"a",
,GetDataFromTag,PDFURL|check|"href",
,RemoveHTMLTags,check,

,ParseString,srore|"Credit Card##KEEP##"|check,
,If-TRUE-Goto,nextStmt1,

,MoveToTag,"td",
,GetDataFromTag,|statementDate|,
,RemoveHTMLTags,statementDate,

,ConvertToValidDate,statementDate|test,

,Goto,scrapeData,


//*****************************************************
//Langley Federal Credit Union Statement Download

LangleyFCUnion,NOP,

,GetReturnData, ##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account|

,MoveToTopOfPage,,

,Assign,FIindex|0,


,GetURL,"https://langleyfcu.onlinebank.com/eStatementsCommand.aspx"|,

,GetURLr,"https://langleyfcu.onlinebank.com/eStatementsSSO.aspx"||"https://applications.digitalmailer.com/IMS/CommunicationCenter/Login.aspx?C=2360&Data=8A99F69B56C6D3F2390DB8B94C0A7ABE6D08C9232DD48C52E164E4234E8D4B787056F57B2D99FD7AE5279685F7C8A3D907CF3B7E14281BBF4D003B676C4E93A3A4F29FB825C4253E", 

,GetURL,##URL##|,

//,FindString,">View<br/>Statements<"|test,
//,If-FALSE-Goto,stmtLoop

//,GetURL,"/2169/eStatements-1.aspx"|,

,FindSignature,"ELECTRONIC STATEMENT DISCLOSURE AGREEMENT",
,If-TRUE-Goto,Error961,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipGETURLLangley,

,GetURL,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Responsive/Pages/statements.aspx?menuID=2411"|,

,Goto,GOsetHedr,

SkipGETURLLangley,GetURL,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Responsive/Pages/statements.aspx?menuID=2410"|,

GOsetHedr,SetHeader,"Content-Type"|"application/json; charset=utf-8",

,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Statements.asmx/GetMemberAccounts"|""

,GetDataAfterString,userID|"UserID":"|"", //"
,GetDataAfterString,AccountNumber|"AccountNumber":""|"",

,SetHeader,"Content-Type"|"application/json; charset=utf-8",

,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Configuration.asmx/GetMenu"|"",

,Assign,jboj|"{userID:",
,AppendVars,jboj|userID,
,AppendVars,jboj|"##COMMA##",

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipTypeLangley,

,AppendVars,jboj|"period:6}",

,Goto,GOsetHeader,

SkipTypeLangley,AppendVars,jboj|"period:24}",

GOsetHeader,SetHeader,"Content-Type"|"application/json; charset=utf-8",

,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Statements.asmx/GetUserStatements"|jboj,

,FindSignature,"{"d":null}",
,If-TRUE-Goto,Error960,

nxtstmt,GetDataAfterString,jobID|"JobID":"|""|test, //"
,If-FALSE-Goto,stmtLoop,

,GetDataAfterString,statementID|"StatementID":"|"", //"

,GetDataAfterString,Idx|"Idx":"|"", //"

,Add,FIindex|1,

,Compare,STMT_IDX|FIindex,
,If-FALSE-Goto,nxtstmt,

,Assign,PDF_URL|"https://applications.digitalmailer.com/IMS/CommunicationCenter/HTTPHandlers/RenderPDF.ashx?Idx=",
,AppendVars,PDF_URL|Idx,
,AppendVars,PDF_URL|"&jobID=",
,AppendVars,PDF_URL|jobID,
,AppendVars,PDF_URL|"&userID=",
,AppendVars,PDF_URL|userID,

,GetURLb,accountStatement|PDF_URL
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//************************************************************************//

//@CenterState Bank Statement Download

CenterStateBank,NOP,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",

,GetURL,"/OnlineBanking/eStatementViewer.aspx",

,FindSignature,"No statement found",
,If-TRUE-Goto,Error108,

,FindString,"Account:"|test,
,If-FALSE-Goto,stmtLoop,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|number|stmtIndex,

,Right$,tempNo|number|4,

,FindString,tempNo|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"option"|"REV",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,AccountID||"value",

,RollDate,##STMTDATE##|tempDate|MONTH|-12|test,
,ConvertDateToText,tempDate|BeginningStatementDate|"MM/dd/yyyy",
,ConvertDateToText,##STMTDATE##|EndStatementDate|"MM/dd/yyyy",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",

,SetPostURLData,"AccountID"|AccountID,
,SetPostURLData,"BeginningStatementDate"|BeginningStatementDate,
,SetPostURLData,"EndStatementDate"|EndStatementDate,

,PostURL,"/OnlineBanking/eStmtsList.aspx",

,FindSignature,""statementFileID":"",    //"
,If-FALSE-Goto,Error960,

,Assign,stmt11|0,  

Next_STMT1,GetDataAfterString,statementFileID|""statementFileID":""|".", //"

,Add,stmt11|1,

,Compare,stmt11|STMT_IDX,
,If-FALSE-Goto,Next_STMT1,  

,Assign,PDF_URL|"/OnlineBanking/eStmtPdf.aspx?AccountID=",
,AppendVars,PDF_URL|AccountID,
,AppendVars,PDF_URL|"&StatementFileID=",
,AppendVars,PDF_URL|statementFileID,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",

,GetURLb,accountStatement|PDF_URL
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//*****************************************************
RibFirStambank,NOP,

,GetURL,"/OnlineBanking/eStatements.aspx",

,FindString,"Account:"|test,
,If-FALSE-Goto,stmtLoop,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|number|stmtIndex,

,Right$,tempNo|number|4,

,FindString,tempNo|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"option"|"REV",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,AccountID||"value",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,CreateForm,"pdfform"|"https://www.rib.firstambank.com/OnlineBanking/eStatements.aspx",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MLSSPYD$ctl00$Recent Statements"|"pdfform",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"pdfform",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"pdfform",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"pdfform",
,SetPostURLData,"M$layout$content$PCDZ$MLSSPYD$ctl00$selectedAccount"|AccountID|"pdfform",
,PostURL,"https://www.rib.firstambank.com/OnlineBanking/eStatements.aspx"||"pdfform",

,Assign,Pdfindex|0,

,FindString,">Statement Date<"|test,
,If-FALSE-Goto,stmtLoop,

Next_PDFSTMT,MoveToTag,"input",

,Add,Pdfindex|1,

,Compare,Pdfindex|STMT_IDX,
,If-FALSE-Goto,Next_PDFSTMT,

,GetDataFromTag,value||"name",

,Assign,Parameter1|value,
,AppendVars,Parameter1|".x",

,Assign,Parameter2|value,
,AppendVars,Parameter2|".y",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"

,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MLSSPYD$ctl00$selectedAccount"|AccountID,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,Parameter1|"0",
,SetPostURLData,Parameter2|"0",

,PostURL,"https://www.rib.firstambank.com/OnlineBanking/eStatements.aspx",
,If-FALSE-Goto,stmtLoop,

,ExtractFromRawPage,PDF_URL|"window[.]open[(][']##KEEP##[']"|test,	//"

,GetURLb,accountStatement|PDF_URL
,AttachStatement,accountStatement|".pdf"|Pdfindex,
,Goto,stmtLoop,

//*****************************************************
FlorenceBank,NOP,

,MoveToTopOfPage,,


,FindString,"eDocuments"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV",

,GetDataFromTag,PURL||"href",

,GetURL,PURL,

,FindString,"Account",

,MoveToTag,"a",

,GetDataFromTag,URL1||"href",


,GetURLb,accountStatement|URL1
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,   

//*****************************************************

SouthWestAirlinesFCUstmt,Assign,StmtIndex|0,

NextAccStmt1,Compare,StmtIndex|account,
,If-TRUE-Goto,stmtLoop,

,Add,StmtIndex|1,
,Assign,Pindex|0,

,GetURLv2,"/Home.aspx"|,

,FindString,"eStatements"|test,
,If-TRUE-Goto,stmtLoopURL,

,FindString,">eStatements<"|test,
,If-FALSE-Goto,stmtLoop,

stmtLoopURL,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,PDFURL||"href",
,GetURLv2,PDFURL|,

,FindSignature,"please accept the disclosure to continue to receive electronic statements",
,If-TRUE-Goto,Error961,

,Compare,##TOWER_WEBSITE##|"https://midwestone.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipAccPosting,  

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|number|stmtIndex,

,FindString,"Select an Account"|test,
,If-FALSE-Goto,jump_To_Desc,

,FindString,number|test,
,If-TRUE-Goto,jump_to_Opt,

jump_To_Desc,FindString,">Description<"|test,
,If-FALSE-Goto,Error960,

,Assign,Temp_Flag|"TRUE",

,Assign,accValue|1,
,Goto,jump_ToExtract,

jump_to_Opt,MoveToTag,"option"|"REV"|test,

,GetDataFromTag,accValue||"value",
jump_ToExtract,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,CreateForm,"aspnetForm"|"./eStatements.aspx",

,Compare,Temp_Flag|"TRUE",
,If-FALSE-Goto,skip_below_lstAccounts,

,SetPostURLData,"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$dgStatements"|accValue|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$dgStatements"|"aspnetForm",
,Goto,jump_below_ToContinue,

skip_below_lstAccounts,SetPostURLData,"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$webInputForm$lstAccounts"|accValue|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$webInputForm$lstAccounts"|"aspnetForm",

jump_below_ToContinue,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",


,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",

,PostURL,||"aspnetForm",

,FindString,">Description<"|test,

nextPDFCheck,MoveToTag,"a",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PDF_data||"href",

,GetDataFromTag,|aType|,

,ParseString,srore|"DDA Account Statement##KEEP##"|aType,
,If-TRUE-Goto,nextPDFCheck,

,ParseString,srore|"SAV Account Statement##KEEP##"|aType,
,If-TRUE-Goto,nextPDFCheck,

,FindReplace,"&amp;"|"&"|PDF_data|test,
,ParseString,Postdata1|"[&][#]39[;]##KEEP##[&][#]39[;]"|PDF_data,
,FindReplace,"[$]"|":"|Postdata1|test,

,Add,Pindex|1,

,Compare,Pindex|STMT_IDX,
,If-FALSE-Goto,nextPDFCheck,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,CreateForm,"aspnetForm"|"./eStatements.aspx",

,Compare,Temp_Flag|"TRUE",
,If-FALSE-Goto,skip_below_lstAccounts1,

,SetPostURLData,Postdata1|accValue|"aspnetForm",
,Goto,jump_below_ToContinue1,

skip_below_lstAccounts1,SetPostURLData,"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$webInputForm$lstAccounts"|accValue|"aspnetForm",
jump_below_ToContinue1,SetPostURLData,"__EVENTTARGET"|Postdata1|"aspnetForm",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",
,Goto,goForPDFPosting,

skipAccPosting,FindString,"Statement Date"|test,
,If-FALSE-Goto,NextAccStmt1,

Prev_MonthStmt1,MoveToTag,"td"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|test,
,GetDataFromTag,TargetValue||"href",
,ParseString,EventTarget|"LinkButtonClick[(][']##KEEP##[']"|TargetValue|test,
,If-TRUE-Goto,SkipExtraParsing,                              
,ParseString,EventTarget|"LinkButtonClick[(][&][#]39[;]##KEEP##[&][#]39[;]"|TargetValue|test,               
                                   
SkipExtraParsing,FindReplace,"[$]"|":"|EventTarget|test,

,Add,Pindex|1,
,Compare,Pindex|STMT_IDX,
,If-FALSE-Goto,Prev_MonthStmt1,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,CreateForm,"aspnetForm"|"./eStatements.aspx",
,SetPostURLData,"__EVENTTARGET"|EventTarget|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

goForPDFPosting,PostURLb,accountStatement|||"aspnetForm",
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,NextAccStmt1,

//**************************************************************

//**************************************************************

ParkNationalStatement,NOP,,

,ConvertStringToInt,##STMT_IDX##,

,Assign,PDF_index|0,
,Assign,STMT_index|0,

,Assign,StatementURL|"https://parknational.onlinebank.com/Statements.aspx",

,GetURLv2,StatementURL,

GotoNextPDF,Compare,account|STMT_index,
,If-TRUE-Goto,stmtLoop,

,Add,STMT_index|1,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,   //"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["]  value[=]["]##KEEP##["]"|test, //"

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|acctypeid|STMT_index,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|STMT_index,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|STMT_index,
,Assign,M_layout_content_ScriptManager_TSM|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:388bfbd4-0ace-4097-bb89-303d009ab8b7:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:f1bcc6a7-366a-4c93-bc83-3061e7a40c04:16e4e7cd:365331c3:ed16cbdc:88144a7a",

,FindString,aname|test,
,If-TRUE-Goto,scrapValue,

,FindString,anum|test,
,If-FALSE-Goto,SearchDirectPDF,

scrapValue,MoveToTag,"option"|"REV",
,GetDataFromTag,acctIndex||"value",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MM9M05R$ctl00$ctl00$webInputForm$lstAccounts",
,SetPostURLData,"__EVENTARGUMENT"|"",
,SetPostURLData,"__LASTFOCUS"|"",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID,
,SetPostURLData,"__VIEWSTATE"|"",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION,
,SetPostURLData,"M$layout$content$PCDZ$MJYOTE4$ctl00$ctl00$ddlAccountList"|acctIndex,  
,PostURL,||,

SearchDirectPDF,FindSignature,"There are no statements available for this account at this time.",
,If-TRUE-Goto,Error960,

,FindSignature,"No statements to be displayed",
,If-TRUE-Goto,Error960,

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,   //"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["]  value[=]["]##KEEP##["]"|test, //"

,FindString,">Statement Date<"|test,
,If-FALSE-Goto,stmtLoop,

Goto_Next_Date,Add,PDF_index|1,

,MoveToTag,"tr"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"td"|test,
,GetDataFromTag,|statementDate|,

,MoveToTag,"a"|test,
,GetDataFromTag,stmtURL||"href",

,Compare,PDF_index|##STMT_IDX##,
,If-FALSE-Goto,Goto_Next_Date,

,GetURLb,accountStatement|stmtURL
,AttachStatement,accountStatement|".pdf"|PDF_index,                                   
                                   
,Goto,GotoNextPDF,

//*************************************************************************************************

,FindString,"Welcome to eDocuments"|test,
,If-FALSE-Goto,stmtLoop,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|number|stmtIndex,

,Right$,tempNo|number|4,

,FindString,tempNo|test,
,If-FALSE-Goto,stmtLoop,

,FindString,"View eDocuments"|test,,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV",
,GetDataFromTag,URL1||"href",

,GetURL,URL1,

,FindString,"Document Type Name"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,"View"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"td"|"REV",

,GetDataFromTag,onclickValue||"onclick",

,ParseString,URL2|"NavigatePopup[(][']##KEEP##[']"|onclickValue,
,ParseString,selectedItem|"[']##COMMA##[']##KEEP##[']"|onclickValue,
,ParseString,SRVK2|"SRVK[=]##KEEP##[&]"|URL2,

,CreateForm,"formRedirect"|URL2,

,SetPostURLData,"selectedItem"|selectedItem|"formRedirect",
,SetPostURLData,"dummy"|""|"formRedirect",
,SetPostURLData,"SRVK2"|SRVK2|"formRedirect"

,PostURL,||"formRedirect",

,FindString,"name="IFrameUrl""|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"input"|"REV",
,GetDataFromTag,PDF_URL||"value",

,GetURLb,accountStatement|PDF_URL
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,                                      

//===============================================================
//===============================================================

PeoplesBank,NOP,

,GetURL,"/bankatpeoples/eStatements.aspx",

,FindString,"eStatement and eSign Consent Agreement"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,"View/Sign-up for eStatements",
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV",
,GetDataFromTag,stmtURL||"href",
,FindReplace,"&amp;"|"&"|stmtURL|test,

,Assign,stmtURL1|"/bankatpeoples/",
,AppendVars,stmtURL1|stmtURL,                                   
,Assign,stmtURL11|"https://secure.myvirtualbranch.com", 
,AppendVars,stmtURL11|stmtURL1,
,GetURLr,stmtURL11||##URL##, 

,ExtractFromRawPage,LoginLIBID|"LoginLibID[=]##KEEP##["]"|test, //"

,GetURLr,"https://edocuments.onlineaccountaccess.com/BankatPeoples/menu.asp"||##URL##, 

,GetURLr,"https://edocuments.onlineaccountaccess.com/BankatPeoples/left.html"||##URL##, 

,Assign,LoginLibURL|"https://edocuments.onlineaccountaccess.com/cowww5/menu/profile.asp?LoginLibID=",    
,AppendVars,LoginLibURL|LoginLIBID, 
,GetURLr,LoginLibURL||"https://edocuments.onlineaccountaccess.com/BankatPeoples/",

,FindString,"e-Statements",
,FindString,"Documents",
,FindString,"Statements",
,MoveToTag,"a"|"REV",
,GetDataFromTag,sURL||"href",
,ParseString,srore1|"[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|srore1|test,

,Assign,AppendIndex|"https://edocuments.onlineaccountaccess.com", //"
,AppendVars,AppendIndex|srore1,
,GetURLr,AppendIndex||"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp", 
,Assign,Index|##URL##,  
,ExtractFromRawPage,DoctitleID|"DoctitleID[=]##KEEP##[&]"|test,
,Assign,Index123|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=",
,AppendVars,Index123|DoctitleID,
,AppendVars,Index123|"&TitleSearch=&AppID=",
,ExtractFromRawPage,AppID|"AppID[=]##KEEP##["]"|test, //"
,AppendVars,Index123|AppID,                                     
,GetURLr,Index123||##URL##,

,Assign,Index1234|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,Index1234|AppID,
,AppendVars,Index1234|"&PrimaryKey=",
,ExtractFromRawPage,PrimaryKey|"hitList.add[(]##KEEP##[##COMMA##]"|test,                                       
,AppendVars,Index1234|PrimaryKey,
,GetURLr,Index1234||##URL##,

,Assign,Index12345|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,Index12345|AppID,
,AppendVars,Index12345|"&PrimaryKey=",
,AppendVars,Index12345|PrimaryKey,
,AppendVars,Index12345|"&ViewerID=",
,ExtractFromRawPage,ViewerID|"ViewerID[=]##KEEP##[&]"|test,
,AppendVars,Index12345|ViewerID,
,AppendVars,Index12345|"&NewWindow=",
,GetURLr,Index12345||##URL##,

,FindString,"function initTabs()"|test,
,If-FALSE-Goto,rocklandtrustonlinestmtLoop,
,FindString,"new viewerTab"|test,
,If-FALSE-Goto,rocklandtrustonlinestmtLoop,
,Assign,IncCount|0,
,GetDataAfterString,AppViewerIDValue|""|"[+][(]##COMMA##[/][.][']",
IncCountLoop,ParseString,AppViewerIDValue|"[##COMMA##]##KEEP##"|AppViewerIDValue,
,Add,IncCount|1,
,Compare,IncCount|13,
,If-TRUE-Goto,ExitIncCount,
,Goto,IncCountLoop,
ExitIncCount,Assign,AppViewerID|AppViewerIDValue,
,ParseString,AppViewerID|"##KEEP##[##COMMA##]"|AppViewerID

,Assign,PDFURL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL|AppID,
,AppendVars,PDFURL|"&PrimaryKey=",
,AppendVars,PDFURL|PrimaryKey, 
,AppendVars,PDFURL|"&AppViewerID=",
,AppendVars,PDFURL|AppViewerID,
,AppendVars,PDFURL|"&DocumentID=",
,AppendVars,PDFURL|PrimaryKey,
,GetURLr,PDFURL||##URL##,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,

,Goto,stmtLoop,                                    

//===============================================================
//===============================================================
CountyBank,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,skipiframe,  

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SkipThisCOde,
                                                                    
Get_wecu,MoveToTag,"iframe"|test,
,GetDataFromTag,Stmt_URLPage||"src",
,FindReplace,":443"|""|Stmt_URLPage|test,
,FindReplace,"&amp;"|"&"|Stmt_URLPage|test,
                                                                                                                                     
,GetURL,Stmt_URLPage|,

,ParseString,srore|"/bankingonline.lfcu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skipiframe,

,Assign,STMT_Index|0,

,FindString,"Statements"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,stmt_URL||"href",
,ParseString,stmt_URL|"javascript[:]getAJAX[(][']##KEEP##[']"|stmt_URL,
,GetURL,stmt_URL|,

,ExtractFromRawPage,main_PDF_URL|"href[']##COMMA## [']##KEEP##[']"|test,

nexT_PDF,Add,STMT_Index|1,

,MoveToTag,"option"|test,
,If-FALSE-Goto,Error960,

,Compare,STMT_Index|STMT_IDX,
,If-FALSE-Goto,nexT_PDF,

,GetDataFromTag,recordID||"value",

,AppendVars,main_PDF_URL|recordID,
,GetURLb,accountStatement|main_PDF_URL,
,AttachStatement,accountStatement|".pdf"|STMT_Index,
,Goto,stmtLoop,

skipiframe,FindSignature,"Awaiting Statement",                                                                   
,If-TRUE-Goto,Error960,

,FindSignature,"Online Statement Enrollment - Agreement",                                                                   
,If-TRUE-Goto,Error961,   

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-TRUE-Goto,wecuBank,                        
                             
SkipThisCOde,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Assign,Pdfindex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Compare,##TOWER_WEBSITE##|"https://ulstersavings.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,wecuBank,

,FindString,aname|test,        

,FindString,"View eStatements"|test,
,If-TRUE-Goto,MoveReverseA,

,FindString,"View Statement"|test,
,If-TRUE-Goto,MoveReverseA,


,FindString,"View or Enroll in eStatements"|test,
,If-TRUE-Goto,MoveReverseA,

,FindString,"eDocuments"|test,
,If-TRUE-Goto,MoveReverseA,

//**************************************************************
,Compare,##TOWER_WEBSITE##|"https://arch6.onlinebank.com/2194/AOP/Password.aspx",
,If-FALSE-Goto,MoveNext, 

,FindString,aname|test,
,FindString,"View Statements"|test,
,FindString,"View Statements"|test,
,If-FALSE-Goto,MoveNext,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURLr,sURL||##URL##,
,GetURL,"https://nasb.info/cowww5/menu/internetuser.asp"|,

//,FindString,"Statements"|test,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,
,ParseString,anum|"x##KEEP##"|anum,


,FindString,anum|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,StmtURL||"href",
,ParseString,StmtURL|"openLink[(][']##KEEP##['][)]"|StmtURL,
,FindReplace,"&amp;"|"&"|StmtURL,
,Assign,StmURL|"https://nasb.info",
,AppendVars,StmURL|StmtURL,

,GetURL,StmURL|,

,MoveToTag,"iframe"|test,
,GetDataFromTag,StURL||"src",
,ParseString,srore|"DoctitleID=##KEEP##"|StURL|test,
,If-FALSE-Goto,Error960,

,Assign,SfURL|"https://nasb.info/cowww5/viewers/doclist_",
,AppendVars,SfURL|StURL,
,AppendVars,SfURL|"&AppID=66",

,GetURL,SfURL|,

,FindString,"Date"|test,

NextPDFstmt,Add,Pdfindex|1,
,MoveToTag,"a"|test,
,GetDataFromTag,Dateurl||"href",

,ParseString,PDF_Page|"PrimaryKey[=]##KEEP##[&]"|Dateurl,

,Compare,PDF_Page|"",
,If-TRUE-Goto,stmtLoop,


//,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|Dateurl|stmtIndex,


,Compare,Pdfindex|STMT_IDX,
,If-FALSE-Goto,NextPDFstmt,



//,ExtractFromRawPage,PDF_Page|"PrimaryKey[=]##KEEP##[&]"|test,
,Assign,PDF_Page1|"https://nasb.info/cowww/DocumentServer/ViewDoc?AppID=66&PrimaryKey=",
,Assign,PDF_Page2|"//1824938&AppViewerID=193&DocumentID=",
,AppendVars,PDF_Page1|PDF_Page,
,AppendVars,PDF_Page1|PDF_Page2,
,AppendVars,PDF_Page1|PDF_Page,

,GetURL,PDF_Page1|,
,ExtractFromRawPage,store|"##KEEP##"|test,
,RemoveNonKeyboardCharacters,store,
,ReloadVPage,store,  


//,GetURL,NPageURL|,

//,Assign,Index|NPageURL,
//,Assign,Index3|"&AppViewerID=193&DocumentID=",
//,AppendVars,Index1|Index3,
//,ParseString,index2|"PrimaryKey=##KEEP##&"|NPageURL,
//,AppendVars,Index1|index2,

//,GetURL,Index1|,

,Assign,Prnt_Page|"https://nasb.info/cowww/DocumentServer/ViewDoc?AppID=66&DocumentID=",
,Assign,Prnt_Page1|"&PrimaryKey=",
,Assign,Prnt_Page2|"&AppViewerID=193&DownloadLink=0&PrintMode=all",
,AppendVars,Prnt_Page|PDF_Page,
,AppendVars,Prnt_Page|Prnt_Page1,
,AppendVars,Prnt_Page|PDF_Page,
,AppendVars,Prnt_Page|Prnt_Page2,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,Goto,stmtLoop,

//*********************************************************

MoveNext,FindString,"View eDocuments"|test,
,If-FALSE-Goto,stmtLoop,                                    

,Assign,Current_index|0,
,Assign,Total_Count|0,                
,FindString,"Document Type"|test,
,If-FALSE-Goto,stmtLoop,

nextDateFStmt,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down,

,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down,

,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down,                             

,MoveToTag,"td"|test,
,If-FALSE-Goto,Strt_stmt_down,
,GetDataFromTag,estmtURL||"onclick",

,ParseString,SRVK|"SRVK=##KEEP##&#39;"|estmtURL,
,Compare,SRVK|"",
,If-TRUE-Goto,Strt_stmt_down,   
,ParseString,selectedItem|"documentbase.id.%3d##KEEP##&#39;"|estmtURL,
,ParseString,PostURL|"NavigatePopup[(]&#39;##KEEP##="|estmtURL,
,Add,Total_Count|1,

,SetReturnData,SRVK|SRVK|Total_Count,
,SetReturnData,selectedItem|selectedItem|Total_Count,

,Goto,nextDateFStmt,

Strt_stmt_down,GetReturnData,SRVK|SRVK|STMT_IDX,
,GetReturnData,selectedItem|selectedItem|STMT_IDX,  

,AppendVars,PostURL|"=",
,AppendVars,PostURL|SRVK,
,AppendVars,PostURL|"&Popup=true",
,Assign,selectItem|"menuitem.documentaction=MenuItem.View&data.documentbase.id.=",
,AppendVars,selectItem|selectedItem,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,CreateForm,"DownloadFormBean"|PostURL,
,SetPostURLData,"SRVK2"|SRVK|"DownloadFormBean",
,SetPostURLData,"dummy"|""|"DownloadFormBean",
,SetPostURLData,"selectedItem"|selectItem|"DownloadFormBean",

,PostURL,PostURL||"DownloadFormBean",

,FindSignature,"IFrameUrl",
,If-FALSE-Goto,stmtLoop,                                

,FindString,"EnvelopeViewPage"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,""IFrameUrl""|test,
,If-FALSE-Goto,stmtLoop,
,MoveToTag,"input"|"REV"|test,
,GetDataFromTag,PDFURL||"value",

,GetURL,PDFURL|,

,MoveToTag,"iframe",
,GetDataFromTag,PDFURL1||"src",


,GetURLb,accountStatement|PDFURL1,

,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//*******************************************************************************
firstcommandbank,MoveToTopOfPage,,

,Assign,PIindex|0,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindString,"viewestatements"|test,
,If-FALSE-Goto,stmtLoop,




,GetURLv2,"/viewestatements.aspx"|,

,FindSignature,"start the registration process",
,If-TRUE-Goto,Error961,

//,ExtractFromRawPage,__VIEWSTATE|"__VIEWSTATE["] value=["]##KEEP##["]"|test, //"

//,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value=["]##KEEP##["]"|test,  //"


//,ExtractFromRawPage,cuid|"id[=]["]cuid["] value[=]["]##KEEP##["]"|test, //"
//,ExtractFromRawPage,Account|"id[=]["]Account["] value[=]["]##KEEP##["]"|test,  //"
//,ExtractFromRawPage,uid|"id[=]["]uid["] value[=]["]##KEEP##["]"|test, //"
//,ExtractFromRawPage,ProviderID|"id[=]["]ProviderID["] value[=]["]##KEEP##["]"|test,  //"
//,ExtractFromRawPage,ReturnURL|"id[=]["]ReturnURL["] value[=]["]##KEEP##["]"|test, //"
//,ExtractFromRawPage,PingURL|"id=["]PingURL["] value[=]["]##KEEP##["]"|test,  //"
//,ExtractFromRawPage,GoodID|"id[=]["]GoodID["] value[=]["]##KEEP##["]"|test,  //"


//,MoveToTag,"form",
//,MoveToTag,"form",
//,GetDataFromTag,sURL||"action",
//,FindReplace,"&amp;"|"&"|sURL|test,

//,CreateForm,"Form1"|sURL,

//,SetPostURLData,"cuid"|cuid|"Form1",
//,SetPostURLData,"Account"|Account|"Form1",
//,SetPostURLData,"uid"|uid|"Form1",
//,SetPostURLData,"ProviderID"|ProviderID|"Form1",
//,SetPostURLData,"ReturnURL"|ReturnURL|"Form1",
//,SetPostURLData,"PingURL"|PingURL|"Form1",
//,SetPostURLData,"GoodID"|GoodID|"Form1",
//,PostURL,sURL||"Form1",

,PostURL,||"logon",

,ExtractFromRawPage,sessionid|"sessionid["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,cuid|"cuid["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,di|"["]di["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,ReturnURL|"ReturnURL["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,PingURL|"PingURL["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,homecu|"homecu["] value[=]["]##KEEP##["]"|test,  //"

,MoveToTag,"form",
,GetDataFromTag,sURL||"action",
,FindReplace,"&amp;"|"&"|sURL|test,

,CreateForm,"Form1"|sURL,

,SetPostURLData,"cuid"|cuid|"Form1",
,SetPostURLData,"sessionid"|sessionid|"Form1",
,SetPostURLData,"di"|di|"Form1",
,SetPostURLData,"ReturnURL"|ReturnURL|"Form1",
,SetPostURLData,"PingURL"|PingURL|"Form1",
,SetPostURLData,"homecu"|homecu|"Form1",
,PostURL,sURL||"Form1",



,ExtractFromRawPage,FromSSO|"FromSSO" value="##KEEP##["]"|test,  //"
,ExtractFromRawPage,impersonate|"impersonate" value="##KEEP##["]"|test,  //"

,MoveToTag,"form",
,GetDataFromTag,sURL||"action",
,FindReplace,"&amp;"|"&"|sURL|test,

,CreateForm,"Form1"|sURL,

,SetPostURLData,"cuid"|cuid|"Form1",
,SetPostURLData,"sessionid"|sessionid|"Form1",
,SetPostURLData,"di"|di|"Form1",
,SetPostURLData,"FromSSO"|FromSSO|"Form1",
,SetPostURLData,"ReturnURL"|ReturnURL|"Form1",
,SetPostURLData,"PingURL"|PingURL|"Form1",
,SetPostURLData,"impersonate"|impersonate|"Form1",
,PostURL,sURL||"Form1",

,FindSignature,"you do not have any documents for this type",
,If-TRUE-Goto,Error960,
//************************************************************************//

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipCCA,

,Goto,Error960,

//************************************************************************//
SkipCCA,FindString,">Other Documents<",
,If-FALSE-Goto,stmtLoop,
,FindString,">Other Documents<"|test,
Nextstatement,FindString,">Account Statement<"|test,     

,ParseString,srore|"firstcommandbank.onlinebank##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,skip_commandbank,

,Add,PIindex|1,
,Compare,PIindex|STMT_IDX,
,If-FALSE-Goto,Nextstatement,

skip_commandbank,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,ParseString,FileID|"[&][#]39[;]##KEEP##[&][#]39[;]"|sURL,
,FindString,">Account Statement<"|test,

,ParseString,srore|"firstcommandbank.onlinebank##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skip_firstcommandbank,

,ExtractFromRawPage,__EVENTARGUMENT|"__EVENTARGUMENT["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__VIEWSTATE|"id[=]["]__VIEWSTATE["] value[=]["]##KEEP##["]"|test,
,ExtractFromRawPage,__VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR" value="##KEEP##""|test,//"
,ExtractFromRawPage,__VIEWSTATEENCRYPTED|""__VIEWSTATEENCRYPTED" value="##KEEP##""|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"id[=]["]__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,SetPostURLData,"__EVENTARGUMENT"|__EVENTARGUMENT,
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE,
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__VIEWSTATEENCRYPTED"|__VIEWSTATEENCRYPTED,

skip_firstcommandbank,SetPostURLData,"__EVENTTARGET"|FileID,
,PostURL,||0,

,ParseString,srore|"firstcommandbank.onlinebank##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skip_THIS,

,Compare,PDF_FLAG|"TRUE",
,If-TRUE-Goto,skip_THIS,

,FindString,"smartwrap"|test,
,If-FALSE-Goto,skip_THIS,

,Assign,PDF_FLAG|"TRUE",
,Goto,Nextstatement,

skip_THIS,Add,PIindex|1,
,Compare,PIindex|STMT_IDX,
,If-FALSE-Goto,Nextstatement,

,FindString,">Open in New Window<",
,MoveToTag,"a"|"REV",
,GetDataFromTag,DemoURL||"href",
,FindReplace,"&#39;"|"'"|DemoURL|test,
                           
,Assign,PDFDONLOAD|"https://www.bitstatement.org/bit/",
,AppendVars,PDFDONLOAD|DemoURL,

,GetURLb,accountStatement|PDFDONLOAD,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,
//*************************

CountyBank1,MoveToTopOfPage,,
,Assign,FISTMTindex|0,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,

,FindSignature,"Disclosure and User Agreement",
,If-TRUE-Goto,Error108,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindReplace,"&#39;"|"'"|aname|test,

,FindString,aname|test,   

,FindString,"eDocuments"|test,
,If-TRUE-Goto,MoveReverseA,

,FindString,"View eStatements"|test,
,If-TRUE-Goto,MoveReverseA,

,FindString,"View eDocuments"|test,
,If-FALSE-Goto,stmtLoop,                                    

MoveReverseA,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,
,MoveToTag,"form"|test,
,PostURL,||,
//******************************************

,FindSignature,"Global Viewpoint - Account eStatement Enrollment",
,If-TRUE-Goto,Error961,

,FindSignature,"Global Viewpoint - Registration",
,If-TRUE-Goto,Error961,

,FindSignature,"Global Viewpoint - Terms and Conditions",
,If-TRUE-Goto,Error961,

,FindSignature,"Global Viewpoint - Important Information",
,If-TRUE-Goto,Error960,

,FindSignature,"The account you have selected is not eligible for eStatements",
,If-TRUE-Goto,Error960,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-TRUE-Goto,SKipThisSeattlecu,

,Goto,CONTINUEE,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Upgrade-Insecure-Requests"|"1",
,Assign,SDATE|0,

,FindString,">Document Type<",
CHECKNEXT,FindString,"Statement<",

,Add,SDATE|1,
,MoveToTag,"input"|"REV",
,GetDataFromTag,statURL||"value",

,MoveToTag,"td",
,GetDataFromTag,|date1|,
,RemoveHTMLTags,date1,
,StrRev,date1,

,FindString,">View<",
,MoveToTag,"td"|"REV",
,GetDataFromTag,SRVK||"onclick",
,ParseString,SRVK|"SRVK=##KEEP##&"|SRVK,

,Compare,STMT_IDX|SDATE,
,If-FALSE-Goto,CHECKNEXT,

,Assign,PDF_URl|"https://gv-us.computershare.com/CI5/Content/Document.ashx/False/False/True/True/True/1/",
,AppendVars,PDF_URl|statURL,
,AppendVars,PDF_URl|"/2/MenuItem.View/_/0/_/False/document_",
,AppendVars,PDF_URl|date1,
,AppendVars,PDF_URl|".pdf?SRVK=",
,AppendVars,PDF_URl|SRVK,

,GetURLb,accountStatement|PDF_URl,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,

//********************************************* 
PDF_DOWNLOAD,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Upgrade-Insecure-Requests"|"1",
,Assign,SDATE|0,

,FindString,">Document Type<",
NEXT_PDF,FindString,"Statement<",

,Add,SDATE|1,
,MoveToTag,"input"|"REV",
,GetDataFromTag,statURL||"value",

,MoveToTag,"td",
,GetDataFromTag,|date1|,
,RemoveHTMLTags,date1,

,FindReplace,"&#47;"|""|date1|test,

,Assign,postDate|"0",
,Assign,demopostDate|date1,
,GetLength,len|demopostDate,
,CompareNumbers,len|8|<=,
,If-FALSE-Goto,skipAppend,
,AppendVars,postDate|demopostDate,
skipAppend,Right$,year|postDate|4|test,
,Left$,months|postDate|2|test,
,Left$,temppostDate|postDate|4|test,
,Right$,day|temppostDate|2|test,
,AppendVars,year|months,
,AppendVars,year|day,

,FindString,">View<",
,MoveToTag,"td"|"REV",
,GetDataFromTag,SRVK||"onclick",
,ParseString,SRVK|"SRVK=##KEEP##&"|SRVK,

,Compare,STMT_IDX|SDATE,
,If-FALSE-Goto,NEXT_PDF,

,Assign,PDF_URl|"https://gv-us.computershare.com/LibertyBank/Content/Document.ashx/False/False/False/False/True/1/",
,AppendVars,PDF_URl|statURL,
,AppendVars,PDF_URl|"/4/MenuItem.View/_/0/_/False/document_",
,AppendVars,PDF_URl|year,
,AppendVars,PDF_URl|".pdf?SRVK=",
,AppendVars,PDF_URl|SRVK,

,GetURLb,accountStatement|PDF_URl,
,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,PostURL,||"navForm",

,ExtractFromRawPage,IFrameUrlPDF|"IFrameUrl["] value[=]["]##KEEP##["]"|test,  //"

,GetURL,IFrameUrlPDF|,

,ExtractFromRawPage,IFrameUrlPDF1|"window[.]location [=] [']##KEEP##[']"|test,  //"

,GetURLb,accountStatement|IFrameUrlPDF1,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,

//**************************************************************************************

CONTINUEE,Assign,Current_index|0,
,Assign,Total_Count|0,                
,FindString,"Document Type"|test,
,If-FALSE-Goto,stmtLoop,

nextDateFStmt1,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down1,

,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down1,

,MoveToTag,"tr"|test,
,If-FALSE-Goto,Strt_stmt_down1,                             

,MoveToTag,"td"|test,
,If-FALSE-Goto,Strt_stmt_down1,
,GetDataFromTag,estmtURL||"onclick",

,ParseString,SRVK|"SRVK=##KEEP##&#39;"|estmtURL,
,Compare,SRVK|"",
,If-TRUE-Goto,Strt_stmt_down,   
,ParseString,selectedItem|"documentbase.id.%3d##KEEP##&#39;"|estmtURL,
,ParseString,PostURL|"NavigatePopup[(]&#39;##KEEP##="|estmtURL,
,Add,Total_Count|1,

,SetReturnData,SRVK|SRVK|Total_Count,
,SetReturnData,selectedItem|selectedItem|Total_Count,

,Goto,nextDateFStmt1,

Strt_stmt_down1,Add,FISTMTindex|1,

,GetReturnData,SRVK|SRVK|STMT_IDX,
,GetReturnData,selectedItem|selectedItem|STMT_IDX,

,Compare,STMT_IDX|FISTMTindex,
,If-FALSE-Goto,Strt_stmt_down1,

,AppendVars,PostURL|"=",
,AppendVars,PostURL|SRVK,
,AppendVars,PostURL|"&Popup=true",
,Assign,selectItem|"menuitem.documentaction=MenuItem.View&data.documentbase.id.=",
,AppendVars,selectItem|selectedItem,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,CreateForm,"DownloadFormBean"|PostURL,
,SetPostURLData,"SRVK2"|SRVK|"DownloadFormBean",
,SetPostURLData,"dummy"|""|"DownloadFormBean",
,SetPostURLData,"selectedItem"|selectItem|"DownloadFormBean",

,PostURL,PostURL||"DownloadFormBean",

,FindSignature,"IFrameUrl",
,If-FALSE-Goto,stmtLoop,                                

,FindString,"EnvelopeViewPage"|test,
,If-FALSE-Goto,stmtLoop,


//*************************
MapsBank,MoveToTopOfPage,,

,Assign,stmtcheck|0,
//eStatements
,FindString,">eStatement<"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,
//,GetURL,"https://agfed.onlinebank.com/eStatements.aspx"|,

,FindSignature,"To get started receiving eStatements##COMMA## you must accept the terms and conditions below",
,If-TRUE-Goto,Error108,

,FindSignature,"To complete your enrollment please read Disclosure below",
,If-TRUE-Goto,Error108,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindString,"Statement Date"|test,
,If-FALSE-Goto,stmtLoop,
,Assign,PDFurl|"https://estatements.mapscu.com",


nextPDF,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,tempURL||"href",

,ParseString,srore|"##KEEP##InsertServlet"|tempURL,
,If-FALSE-Goto,SkipTag,

,MoveToTag,"a"|test,

SkipTag,Add,stmtcheck|1,

,Compare,STMT_IDX|stmtcheck,
,If-FALSE-Goto,nextPDF,

,GetDataFromTag,pdfurl||"href",

,ParseString,srore|"##KEEP##InsertServlet"|pdfurl,
,If-FALSE-Goto,normalFlow,

,MoveToTag,"a"|test,



,GetDataFromTag,pdfurl||"href",

normalFlow,AppendVars,PDFurl|pdfurl,


,GetURLb,accountStatement|pdfurl
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,

//************************************************************************************
OregonBank,NOP,,
,MoveToTopOfPage,,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,
,Assign,opIndex|0, 

,Assign,OregonstmtIndex|0,

OregonstmtLoop,Compare,OregonstmtIndex|account,

,If-TRUE-Goto,logout,

,Add,OregonstmtIndex|1, 

,FindSignature,">eStatements<",
,If-FALSE-Goto,OregonstmtLoop,

,GetURL,"/CUNotify_Estatements.aspx",

,GetURL,"/CuNotify3Member/EStatements01/Statements/Statements.asp",

getPDFURL,Add,opIndex|1,

,FindSignature,"EStatement not available at this time.",
,If-TRUE-Goto,Error960,

,FindString,"Regular Statement",
,MoveToTag,"a",
,GetDataFromTag,OregonPDFURL||"href",

,Compare,opIndex|STMT_IDX,
,If-FALSE-Goto,getPDFURL,

,ParseString,OregonPDFURL|"createEStmtWindow[(][']##KEEP##[']"|OregonPDFURL,

,GetURLb,accountStatement|OregonPDFURL,
,AttachStatement,accountStatement|".pdf"|OregonstmtIndex,
,Goto,OregonstmtLoop,  

//************************************************************************************
westfieldlayout,MoveToTopOfPage,,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindString,"Statements/Notices"|test,
,If-TRUE-Goto,Go2Arev,

,FindString,"eStatements"|test,
,If-TRUE-Goto,Go2Arev,

,FindString,">e-Documents<"|test,
,If-TRUE-Goto,Go2Arev,

,FindString,">eDocuments<"|test,
,If-FALSE-Goto,logout,

Go2Arev,MoveToTag,"a"|"REV",
,GetDataFromTag,stmtlink||"href",

,GetURL,stmtlink|,

,Assign,pindex|1,
,Assign,FIPIindex|0,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|pindex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|pindex,

,Compare,##TOWER_WEBSITE##|"https://online.gatecity.bank/SignIn.aspx",
,If-FALSE-Goto,Skp_Gatecity,

,GetURL,"https://gcstatements.gatecitybank.com/home.jsp?stmtType=default"|,

,Goto,KPCU_Layout,


Skp_Gatecity,FindString,aname|test,
,If-TRUE-Goto,skipanumcheck,
,FindString,anum|test,
,If-FALSE-Goto,logout,

skipanumcheck,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/CPCU/Signin.aspx",
,If-TRUE-Goto,MoveExtraA,

,MoveToTag,"a",

,GetDataFromTag,nxtpage||"href",

,GetURL,nxtpage|,


,PostURL,||0,

,FindString,"Account eStatement Enrollment"|test,
,If-TRUE-Goto,Error961,

,FindString,"Thank you for attempting to enroll an account in eStatement delivery"|test,
,If-TRUE-Goto,Error961,

,FindString,"Document Type"|test,
,If-FALSE-Goto,logout,

nxtpdf,MoveToTag,"tr"|test,
,If-FALSE-Goto,logout,
,MoveToTag,"tr"|test,
,If-FALSE-Goto,logout,
,MoveToTag,"tr"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"td"|test,
,If-FALSE-Goto,logout,

,GetDataFromTag,pdflink||"onclick",

,Add,FIPIindex|1,

,Compare,FIPIindex|STMT_IDX,
,If-FALSE-Goto,nxtpdf,

,ParseString,pdf1|"[;]##KEEP##[&]"|pdflink,

,GetDataAfterString,SI|"##COMMA##[&][#]39[;]"|". % ",

,ParseString,srvk2|"SRVK[=]##KEEP##[&]"|pdflink,

,Assign,pdf|"https://gv-us.computershare.com"
,AppendVars,pdf|pdf1,
,AppendVars,pdf|"&Popup=true",


,CreateForm,"myform"|pdf,
,SetPostURLData,"selectedItem"|SI|"myform",
,SetPostURLData,"dummy"|""|"myform",
,SetPostURLData,"SRVK2"|srvk2|"myform",
,PostURL,||"myform",

,FindString,"IFrameUrl"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"input"|"REV",

,GetDataFromTag,down||"value",
,GetURL,down|,

,MoveToTag,"iFrame",
,GetDataFromTag,getpdf||"src",

,GetURLb,accountStatement|getpdf,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,  

//=============================================================

GesaBank,MoveToTopOfPage,,

,Assign,stmt_check|0,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SKIPTYPE,

,FindString,"Credit Cards"|test,
,If-FALSE-Goto,Error960,

//eStatements
SKIPTYPE,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,
//,GetURL,"https://agfed.onlinebank.com/eStatements.aspx"|,


,FindSignature,"Agreement to Receive Disclosures Electronically",
,If-TRUE-Goto,Error961,


,FindSignature,"To get started receiving eStatements##COMMA## you must accept the terms and conditions below",
,If-TRUE-Goto,Error108,

,FindSignature,"To complete your enrollment please read Disclosure below",
,If-TRUE-Goto,Error108,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTag,"form",
,GetDataFromTag,pdfForm||"action",
,FindReplace,"&amp;"|"&"|pdfForm|test,

,FindString,"Select an Account"|test,
,MoveToTag,"select"|"REV"|test,
,GetDataFromTag,__EVENTTARGET||"name",

,FindString,aname|test,
,If-TRUE-Goto,skipanumchk,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

skipanumchk,MoveToTag,"option"|"REV",
,GetDataFromTag,AccountID||"value",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,CreateForm,"pdfform"|pdfForm,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"pdfform",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET|"pdfform",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"pdfform",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"pdfform",
,SetPostURLData,__EVENTTARGET|AccountID|"pdfform",
,PostURL,pdfForm||"pdfform",

,FindSignature,"No statements to be displayed",
,If-TRUE-Goto,Error960,

,FindSignature,"Credit Card eStatement Enrollment",
,If-TRUE-Goto,Error961,

,FindString,"Statement Date"|test,
,If-FALSE-Goto,stmtLoop,
,Assign,PDF_url|"https://onlinexpress.gesa.com",


,MoveToTag,"a"|test,

next_PDF,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,tempURL||"href",

,ParseString,srore|"##KEEP##InsertServlet"|tempURL,
,If-FALSE-Goto,Skip_Tag,

,MoveToTag,"a"|test,

Skip_Tag,Add,stmt_check|1,

,Compare,STMT_IDX|stmt_check,
,If-FALSE-Goto,next_PDF,

,GetDataFromTag,pdf_url||"href",

,ParseString,srore|"##KEEP##InsertServlet"|pdf_url,
,If-FALSE-Goto,normal_Flow,

,MoveToTag,"a"|test,

,GetDataFromTag,pdf_url||"href",

normal_Flow,AppendVars,PDF_url|pdf_url,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipHeder,

,SetHeader,"Content-Type"|"application/pdf",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0	",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Referer"|"https://onlinexpress.gesa.com/Banking/CreditCard/CreditCardeStatements.aspx",
,SetHeader,"Connection"|"keep-alive",


SkipHeder,GetURLb,accountStatement|pdf_url
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,


//************************************************************************************************************


nwfcuPDF,NOP,


,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTopOfPage,,

,FindString,"eDocuments"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",

,GetURL,PURL,
,Compare,##TOWER_WEBSITE##|"https://ebanking.realtorsfcu.org/2126/SignIn.aspx",
,If-FALSE-Goto,skipthissection,

,GetURL,"https://ebanking.realtorsfcu.org/IMSIWeb/stmt/loadAllDocuments"|,

,GetURL,"https://ebanking.realtorsfcu.org/2126/eStatementsIMSSSO.aspx"|,

,Goto,findthatsign,

skipthissection,GetURL,"https://estatements.nwfcu.org/IMSIWeb/stmt/loadAllDocuments"|,

,GetURL,"https://ebanking.nwfcu.org/2126/eStatementsIMSSSO.aspx"|,

findthatsign,FindSignature,"I have read and agree to the disclosure.",
,If-TRUE-Goto,Error961,    
      
,FindSignature,"I accept the terms and conditions",
,If-TRUE-Goto,Error961,   

,FindString,"Account"|test,

nextstmtchk,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",

,ParseString,srore|"##KEEP##viewStatement"|URL1,
,If-FALSE-Goto,nextstmtchk,

,Add,STMT_IDXCHK|1,

,Compare,STMT_IDX|STMT_IDXCHK,
,If-FALSE-Goto,nextstmtchk,

,FindReplace,"&amp;"|"&"|URL1|test,

,GetURLb,accountStatement|URL1
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,
//********************************************** MapscuBank ***************************************************
MapscuBank,GetURLv2,"/eStatementSSO.aspx"|,

,FindSignature,"No statements are currently available for the selected account",
,If-TRUE-Goto,Error960,

,FindSignature,">TERMS AND CONDITIONS<",
,If-TRUE-Goto,Error961,

,Assign,Pdf_Index|0,
,ConvertStringToInt,##STMT_IDX##,

,FindString,">e-Statement<"|test,

,FindString,"ViewedStatus"|test,
,If-FALSE-Goto,stmtLoop,

Next_Date,MoveToTag,"a"|"REV",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PDF_data||"href",

,Add,Pdf_Index|1,

,Compare,##STMT_IDX##|Pdf_Index,
,If-TRUE-Goto,Exit_loop,


,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,"ViewedStatus"|test,
,If-FALSE-Goto,stmtLoop,
,Goto,Next_Date,

Exit_loop,GetURLb,accountStatement|PDF_data
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,
//************************************************************************************************************
trueskycuLayout,NOP,,

,ReturnToPreviousPage,2,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",

,Assign,StmtURL|"https://trueskycu.onlinebank.com",
,AppendVars,StmtURL|sURL,

,GetURLv2,StmtURL|,

,FindSignature,"eSign Confirmation Code",
,If-TRUE-Goto,Error961,

,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,FindSignature,"E-Sign Disclosure and Consent<",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatements require an email address",
,If-TRUE-Goto,Error961,

,FindSignature,"Once you click on the Enroll button##COMMA## you will be enrolled in eDelivery",
,If-TRUE-Goto,Error961,

,MoveToTag,"iframe"|test,
,If-FALSE-Goto,logout,
,GetDataFromTag,SRC||"src",


,GetURLv2,SRC|,

,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,MoveToTopOfPage,,

,ExtractFromRawPage,CSRF_NONCE|"[']org.apache.catalina.filters.CSRF_NONCE[']:[']##KEEP##[']"|test,//"
,ExtractFromRawPage,viewstate|"["]j_id1:javax.faces.ViewState[:]0["] value=["]##KEEP##["]"|test, //"

,ParseString,srore|"[x]##KEEP##"|anum,
,Assign,anum|srore,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,ajaxSrc||"id",

,Assign,commandExec|ajaxSrc,
,AppendVars,commandExec|" @component",

,Assign,PDFPAGE|"https://edocs.hepsiian.com/cv/searchResults.jsf?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",

,Assign,Referer|"https://edocs.hepsiian.com/cv/searchResults.jsf",
,SetHeader,"Referer"|Referer,

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|viewstate|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.execute"|commandExec|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"org.richfaces.ajax.component"|ajaxSrc|"results",
,SetPostURLData,"javax.faces.source"|ajaxSrc|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",
,SetPostURLData,"javax.faces.behavior.event"|"click"|"results",
,SetPostURLData,"org.apache.catalina.filters.CSRF_NONCE"|CSRF_NONCE|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"rfExt"|"null"|"results",

,PostURLr,PDFPAGE||"results"|##URL##,

,Assign,SetReturnIndex|0,
,Assign,GetReturnIndex|0,

,Assign,PDFIDX|##STMT_IDX##,
,ConvertStringToInt,PDFIDX,

,FindString," View History -"|test,

LoopingStatementValue1,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,|StatementMonth|,
,GetDataFromTag,GetDummyValue||"onclick",

,ParseString,srkey|"javascript:getHitPDF[(][']##KEEP##[']"|GetDummyValue, //"
,ParseString,HValue|"##COMMA## '##KEEP##[']"|GetDummyValue, //"

,ConvertToValidDate,StatementMonth|test,


,Add,SetReturnIndex|1,

,SetReturnData,srkey|srkey|SetReturnIndex,
,SetReturnData,HValue|HValue|SetReturnIndex,
,SetReturnData,StatementMonth|StatementMonth|SetReturnIndex,

,CompareNumbers,PDFIDX|SetReturnIndex|>,    
,If-TRUE-Goto,LoopingStatementValue1,

,Compare,GetReturnIndex|SetReturnIndex,
,If-TRUE-Goto,ExitLoopingStatement,
,Add,GetReturnIndex|1,

,Assign,GetReturnIndex|PDFIDX,

,GetReturnData,srkey|srkey|GetReturnIndex,
,GetReturnData,HValue|HValue|GetReturnIndex,
,GetReturnData,StatementMonth|StatementMonth|GetReturnIndex,

ExitLoopingStatement1,NOP,,
,Assign,cachefix|##NOW##,

,Assign,DXWebURL|"https://edocs.hepsiian.com/cv/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",
,AppendVars,DXWebURL|srkey,
,AppendVars,DXWebURL|"&resolution=100&cachefix=",
,AppendVars,DXWebURL|cachefix,
,AppendVars,DXWebURL|"&hit=",
,AppendVars,DXWebURL|HValue,

,GetURLb,accountStatement|DXWebURL,

,AttachStatement,accountStatement|".pdf"|account,
,Goto,stmtLoop, 

//**********************************************  Hughes Federal Credit Union : FI 4096 ***************************************************
HughesFCU,NOP,,

,Assign,pdfIndex|0,
,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURLv2,sURL|,

,ExtractFromRawPage,stmtRedirectionURL|"window.open[(]["]##KEEP##["]"|test, //"

,GetURLv2,stmtRedirectionURL||test,

,FindSignature,">Hughes Federal Credit Union eStatement Agreement<",
,If-TRUE-Goto,Error961,

,MoveToTag,"form",
,GetDataFromTag,formactionURL||"action",

,PostURLr,formactionURL||"PREENROLL"|##URL##, 

,SetPostURLData,"__EVENTTARGET"|"ctl00$Menu1"|"aspnetForm",
,SetPostURLData,"__EVENTARGUMENT"|"Page2\25539"|"aspnetForm",
,PostURLr,formactionURL||"aspnetForm"|##URL##,

,FindSignature,">No Statements Found<",
,If-TRUE-Goto,Error960,      

,MoveToTag,"form",
,GetDataFromTag,postingURL||"action",
,FindReplace,"%2F"|"/"|postingURL,
,FindReplace,"&amp;"|"&"|postingURL,
,FindReplace,"%3D"|"="|postingURL,

,FindString,">Document Date:<"|test,

,MoveToTag,"option",
,GetDataFromTag,ctl00$DocumentDate||"value",

,ExtractFromRawPage,ctl00$KeyID|"ctl00_KeyID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,VIEWSTATE|"__VIEWSTATE["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,//"
,ExtractFromRawPage,VIEWSTATEGENERATOR|"__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnMemberID|"ctl00_hdnMemberID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00_hdnMainMenu|"ctl00_hdnMainMenu["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnDocumentType|"ctl00_hdnDocumentType["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00_hdnSubMainMenu|"ctl00_hdnSubMainMenu["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnDocumentID|"ctl00_hdnDocumentID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00_hdnSubMainMenu|"ctl00_hdnSubMainMenu["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$KeyID|"ctl00_KeyID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnRoleID|"ctl00_hdnRoleID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnPartnerID|"ctl00_hdnPartnerID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnClientID|"ctl00_hdnClientID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$hdnDocumentType|"ctl00_hdnDocumentType["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$ContentPlaceHolder1$hdnKeyID|"ctl00_ContentPlaceHolder1_hdnKeyID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$ContentPlaceHolder1$hdnPartnerID|"ctl00_ContentPlaceHolder1_hdnPartnerID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$ContentPlaceHolder1$hdnSubMenu|"ctl00_ContentPlaceHolder1_hdnSubMenu["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$ContentPlaceHolder1$hdnClientID|"ctl00_ContentPlaceHolder1_hdnClientID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,ctl00$ContentPlaceHolder1$hdnMemberID|"ctl00_ContentPlaceHolder1_hdnMemberID["] value[=]["]##KEEP##["]"|test, //"

,CreateForm,"aspnetForm"|postingURL,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,SetPostURLData,"__EVENTTARGET"|"ctl00$DocumentType"|"aspnetForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|VIEWSTATE|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"aspnetForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|VIEWSTATEGENERATOR|"aspnetForm",
,SetPostURLData,"ctl00$hdnMainMenu"|"View"|"aspnetForm",
,SetPostURLData,"ctl00$hdnMemberID"|ctl00$hdnMemberID|"aspnetForm",
,SetPostURLData,"ctl00$hdnSubMainMenu"|ctl00_hdnSubMainMenu|"aspnetForm",
,SetPostURLData,"ctl00$hdnDocumentType"|ctl00$hdnDocumentType|"aspnetForm",
,SetPostURLData,"ctl00$hdnDocumentID"|ctl00$hdnDocumentID|"aspnetForm",
,SetPostURLData,"ctl00$KeyID"|ctl00$KeyID|"aspnetForm",
,SetPostURLData,"ctl00$hdnRoleID"|ctl00$hdnRoleID|"aspnetForm",
,SetPostURLData,"ctl00$hdnPartnerID"|ctl00$hdnPartnerID|"aspnetForm",
,SetPostURLData,"ctl00$hdnClientID"|ctl00$hdnClientID|"aspnetForm",
,SetPostURLData,"ctl00$DocumentType"|"Member Statement"|"aspnetForm",
,SetPostURLData,"ctl00$DocumentDate"|ctl00$DocumentDate|"aspnetForm",
,SetPostURLData,"ctl00$ContentPlaceHolder1$hdnKeyID"|ctl00$ContentPlaceHolder1$hdnKeyID|"aspnetForm",
,SetPostURLData,"ctl00$DocumentDate"|ctl00$DocumentDate|"aspnetForm",
,SetPostURLData,"ctl00$ContentPlaceHolder1$hdnPartnerID"|ctl00$ContentPlaceHolder1$hdnPartnerID|"aspnetForm",
,SetPostURLData,"ctl00$ContentPlaceHolder1$hdnSubMenu"|ctl00$ContentPlaceHolder1$hdnSubMenu|"aspnetForm",
,SetPostURLData,"ctl00$ContentPlaceHolder1$hdnClientID"|ctl00$ContentPlaceHolder1$hdnClientID|"aspnetForm",
,SetPostURLData,"ctl00$ContentPlaceHolder1$hdnMemberID"|ctl00$ContentPlaceHolder1$hdnMemberID|"aspnetForm",
,PostURLr,postingURL||"aspnetForm"|##URL##,

,Assign,indexUrl|##URL##,

,ParseString,domain|"##KEEP##/eStatementView"|indexUrl|test,

,FindString,"name="ctl00$DocumentDate""|test,	

prevStmtDownload,MoveToTag,"option"|test,
,If-FALSE-Goto,stmtLoop,

,Add,pdfIndex|1,

,Compare,STMT_IDX|pdfIndex,
,If-FALSE-Goto,prevStmtDownload,

,GetDataFromTag,documentDate||"value",

,SetPostURLData,"__EVENTTARGET"|"ctl00$DocumentDate"|"aspnetForm",
,SetPostURLData,"ctl00$DocumentDate"|documentDate|"aspnetForm",
,PostURLr,postingURL||"aspnetForm"|##URL##,

,MoveToTag,"iframe"|test,
,GetDataFromTag,pdfDownloadSource||"src",

,ParseString,fid|"ID[=]##KEEP##[_]"|pdfDownloadSource|test,
,If-TRUE-Goto,SkipExtraParce,                                                 
,ParseString,fid|"FID[%]3d##KEEP##[_]"|pdfDownloadSource|test,
SkipExtraParce,NOP,
,Assign,pdfDownloadURL|domain,
,AppendVars,pdfDownloadURL|"/ViewFile.aspx?FID=",
,AppendVars,pdfDownloadURL|fid,
,AppendVars,pdfDownloadURL|"_",
,AppendVars,pdfDownloadURL|documentDate,
,AppendVars,pdfDownloadURL|".pdf",

,GetURLb,accountStatement|pdfDownloadURL,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,
//************************************************************************************************************

//***************************************** FlorenceBank *****************************************************


FlorenceBank1,MoveToTopOfPage,,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindString,">eDocuments<"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"a"|"REV",
,GetDataFromTag,stmtlink||"href",

,GetURL,stmtlink|,

,Assign,pindex|1,
,Assign,FIPIindex|0,

,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|pindex,

,FindString,aname|test,
,If-FALSE-Goto,logout,


,MoveToTag,"a",

,GetDataFromTag,nxtpage||"href",

,GetURL,nxtpage|,


,PostURL,||0,

,FindString,"Account eStatement Enrollment"|test,
,If-TRUE-Goto,Error961,

,FindSignature,"Global Viewpoint - Registration",
,If-TRUE-Goto,Useraction_108,

,FindString,"Thank you for attempting to enroll an account in eStatement delivery"|test,
,If-TRUE-Goto,Error961,

//*************************************************

,FindString,"Document Type Name"|test,

nextPDFstmt,FindString,">View<"|test,

,MoveToTag,"td"|"REV",

,Add,FIPIindex|1,


,GetDataFromTag,statURL||"onclick",
,FindReplace,"&#39;"|"'"|statURL|test,

,FindString,">View<",

,Compare,STMT_IDX|FIPIindex,
,If-FALSE-Goto,nextPDFstmt,


,ParseString,SI|"##COMMA##[']##KEEP##[']##COMMA##"|statURL,
,FindReplace,"%3d"|"="|SI|test,
,FindReplace,"%26"|"&"|SI|test,

,ParseString,statURL|"[(][']##KEEP##['][##COMMA##]"|statURL,


,ExtractFromRawPage,srvk2|"SRVK2["] value[=]["]##KEEP##["]"|test, //"


,CreateForm,"myform"|statURL,
,SetPostURLData,"selectedItem"|SI|"myform",
,SetPostURLData,"dummy"|""|"myform",
,SetPostURLData,"SRVK2"|srvk2|"myform",
,PostURL,||"myform",

,FindString,"IFrameUrl"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"input"|"REV",

,GetDataFromTag,down||"value",
,GetURL,down|,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,AccTypeID|"400",
,If-FALSE-Goto,SkipThisAssgn,

,Assign,getpdf|down,
,Goto,GoNext,


SkipThisAssgn,MoveToTag,"iFrame"|test,
,GetDataFromTag,getpdf||"src",

GoNext,GetURLb,accountStatement|getpdf,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,  

//***************PDFLayoutforcommunityfirstcu**************************************

NewPDFcommunityfirstcu,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,GetURLv2,"https://my.communityfirstcu.org/svc/e-Docs/Statements.aspx"||test,

,FindString,">Account:<"|test,
,MoveToTag,"SELECT"|test,
,GetDataFromTag,eventTargetName||"name",

,FindString,anum|test,
,If-TRUE-Goto,getValues,

,FindString,"selected="selected""|test,

getValues,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,SelectedAccountValue||"value",

,FindString,">Recent Statements<"|test,

checkNextStatementDwld,MoveToTag,"a"|test,
,GetDataFromTag,eventTargetValue||"href",
,FindReplace,"&#39;"|"'"|eventTargetValue|test,

,ParseString,__EVENTTARGET|"[']##KEEP##[']"|eventTargetValue|test,
,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,//"

,CreateForm,"aspnetForm"|"./Statements.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:59e0a739-153b-40bd-883f-4e212fc43305:ea597d4b:b25378d2"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET|"aspnetForm",
,SetPostURLData,eventTargetName|SelectedAccountValue|"aspnetForm",
,PostURL,||"aspnetForm",

,FindString,">Statement Date<"|test,
,If-FALSE-Goto,Error960,

NextPDF_stmt,FindString,">Account Statement<"|test,
,If-FALSE-Goto,previousYearStmt,

,MoveToTag,"input",

,GetDataFromTag,value||"name",

,Add,STMT_IDXCHK|1,

,Compare,STMT_IDXCHK|STMT_IDX,
,If-FALSE-Goto,NextPDF_stmt,

,Assign,Parameter1|value,
,AppendVars,Parameter1|".x",
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,
,Assign,Parameter2|value,
,AppendVars,Parameter2|".y",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"
,CreateForm,"aspnetForm"|"./Statements.aspx",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:59e0a739-153b-40bd-883f-4e212fc43305:ea597d4b:b25378d2"|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|""|"aspnetForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"aspnetForm",
,SetPostURLData,"__LASTFOCUS"|""|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|""|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",
,SetPostURLData,eventTargetName|SelectedAccountValue|"aspnetForm",
,SetPostURLData,Parameter1|"25"|"aspnetForm",
,SetPostURLData,Parameter2|"25"|"aspnetForm",
,PostURL,||"aspnetForm",

,ExtractFromRawPage,PDF_Url|"window.open[(][']##KEEP##[']"|test,//"
,If-FALSE-Goto,stmtLoop,

,GetURLb,accountStatement|PDF_Url
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,


previousYearStmt,Add,yearCounter|1,

,Compare,yearCounter|3,
,If-TRUE-Goto,Error960,

,ReturnToPreviousPage,,

,FindString,__EVENTTARGET|test,

,Goto,checkNextStatementDwld,


NewLayoutProvidentBank,NOP,
,ConvertStringToInt,##STMT_IDX##,
,GetURL,"https://secure.myvirtualbranch.com/ProvidentBankOnline/eStatements.aspx"|,


,Assign,stmtIndex|0,
,Assign,PDF_INDEX|0,

,Compare,account|stmtIndex,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|stmtIndex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##PIPE##300##KEEP##"|AccTypeID,
,If-FALSE-Goto,logout,

,MoveToTag,"table"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"td",
,MoveToTag,"td",

NEXT_ACC,MoveToTag,"a"|test,
,If-FALSE-Goto,logout,

,GetDataFromTag,|AccountName|,
,RemoveHTMLTags,AccountName,

,Compare,aname|AccountName,
,If-FALSE-Goto,NEXT_ACC,

,FindString,"View eStatements"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,logout,

,GetDataFromTag,STMTURL||"href",
,GetURL,STMTURL|,

,FindSignature,"Delivery Preferences",
,If-TRUE-Goto,Error961,

,PostURL,||0,


,FindSignature,"There are no documents currently available.",
,If-TRUE-Goto,Error960,  

,SetPostURLData,"__EVENTTARGET"|"ListSection$ctl04$ResultsPerPage"|0,
,SetPostURLData,"ListSection$ctl04$ResultsPerPage"|"100"|0,

,PostURL,||0,

,FindSignature,"Please fill in below details and click "Next"",
,If-TRUE-Goto,errorUserAction,

,FindSignature,"Finish&quot; to proceed",
,If-TRUE-Goto,errorUserAction,

,FindString,"Document Type Name"|test,
,If-FALSE-Goto,logout,

NEXTSTMT,MoveToTag,"td"|test,
,If-FALSE-Goto,logout,

,Add,PDF_INDEX|1,

,MoveToTag,"input",
,GetDataFromTag,Value||"value",

,MoveToTag,"td",
,GetDataFromTag,|STMT_DATE|,
,RemoveHTMLTags,STMT_DATE,

,FindReplace,"&#47;"|"-"|STMT_DATE|test,

,ConvertToValidDate,STMT_DATE,
,ConvertDateToText,STMT_DATE|Stmtdate|"yyyyMMdd"


,SetReturnData,STMT_DATE|STMT_DATE|PDF_INDEX,


,Compare,##STMT_IDX##|PDF_INDEX,
,If-FALSE-Goto,NEXTSTMT,

,FindString,">View<"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"td"|"REV",

,GetDataFromTag,PDF_LINK||"onclick",

,ParseString,SRVK|"SRVK=##KEEP##[&]"|PDF_LINK,

,Assign,PDF_URL|"https://gv-us.computershare.com/BAQT/Content/Document.ashx/False/False/True/True/True/1/",
,AppendVars,PDF_URL|Value,
,AppendVars,PDF_URL|"/2/MenuItem.View/_/0/_/False/document_",
,AppendVars,PDF_URL|Stmtdate,
,AppendVars,PDF_URL|".pdf?SRVK=",
,AppendVars,PDF_URL|SRVK,

getURLB,GetURLb,accountStatement|PDF_URL,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,logout,

//*************************************************************************************************
//*************************************** Windsor Federal Savings and Loan Association *********************************************************************


NewPDFLayout,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTopOfPage,,

,FindString,"E-Statements"|test,
,If-TRUE-Goto,stmtLoopA,

,FindString,"eStatements"|test,
,If-TRUE-Goto,stmtLoopA,

,FindString,">Statements & Notices<"|test,
,If-TRUE-Goto,stmtLoopA,

,FindString,">Statements<"|test,
,If-TRUE-Goto,stmtLoopA,

,FindString,"eDocuments"|test,
,If-FALSE-Goto,stmtLoop,

stmtLoopA,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",

,GetURLv2,PURL,

,FindSignature,"Fulton Savings Bank",
,If-TRUE-Goto,FultonbankPDF,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skpExtract,

,ExtractFromRawPage,ssoUrl|"window.open[(]["]##KEEP##["]"|test,
,GetURL,ssoUrl|,

,Goto,wecuBank,

skpExtract,FindSignature,"E-Sign Disclosure and Consent<",
,If-TRUE-Goto,Error961,

,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatements require an email address",
,If-TRUE-Goto,Error961,

,FindSignature,"Once you click on the Enroll button##COMMA## you will be enrolled in eDelivery",
,If-TRUE-Goto,Error961,

//*****************************************************
// Seattle Credit Union Statement Layout START
//*****************************************************

,ParseString,srore|"/online.apgfcu.com##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,Tower_apgfcu,

,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,get_PDFLIST,

,ExtractFromRawPage,TOKEN|"PROD&token[=]##KEEP##["]"|test,  //"

,Assign,PDFURLL|"https://ebank.hepsiian.com/cv/sso?seattlecu-PROD&token=",
,AppendVars,PDFURLL|TOKEN,

,GetURL,PDFURLL|,

,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,MoveToTopOfPage,,

,ExtractFromRawPage,CSRF_NONCE|"[']org.apache.catalina.filters.CSRF_NONCE[']:[']##KEEP##[']"|test,//"
,ExtractFromRawPage,viewstate|"["]j_id1:javax.faces.ViewState[:]0["] value=["]##KEEP##["]"|test, //"

,ParseString,srore|"[x]##KEEP##"|anum,
,Assign,anum|srore,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,ajaxSrc||"id",

,Assign,commandExec|ajaxSrc,
,AppendVars,commandExec|" @component",

,Assign,PDFPAGE|"https://ebank.hepsiian.com/cv/searchResults.jsf?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",

,Assign,Referer|"https://ebank.hepsiian.com/cv/searchResults.jsf",
,SetHeader,"Referer"|Referer,

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|viewstate|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.execute"|commandExec|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"org.richfaces.ajax.component"|ajaxSrc|"results",
,SetPostURLData,"javax.faces.source"|ajaxSrc|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",
,SetPostURLData,"javax.faces.behavior.event"|"click"|"results",
,SetPostURLData,"org.apache.catalina.filters.CSRF_NONCE"|CSRF_NONCE|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"rfExt"|"null"|"results",

,PostURLr,PDFPAGE||"results"|##URL##,

,Assign,SetReturnIndex|0,
,Assign,GetReturnIndex|0,

,Assign,PDFIDX|##STMT_IDX##,
,ConvertStringToInt,PDFIDX,

,FindString," View History -"|test,

LoopingStatementValue,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,|StatementMonth|,
,GetDataFromTag,GetDummyValue||"onclick",

,ParseString,srkey|"javascript:getHitPDF[(][']##KEEP##[']"|GetDummyValue, //"
,ParseString,HValue|"##COMMA## '##KEEP##[']"|GetDummyValue, //"
,If-FALSE-Goto,ExitSetReturnLoop,

,ConvertToValidDate,StatementMonth|test,
,If-FALSE-Goto,ExitSetReturnLoop,

,Add,SetReturnIndex|1,

,SetReturnData,srkey|srkey|SetReturnIndex,
,SetReturnData,HValue|HValue|SetReturnIndex,
,SetReturnData,StatementMonth|StatementMonth|SetReturnIndex,

,CompareNumbers,PDFIDX|SetReturnIndex|>,    
,If-TRUE-Goto,LoopingStatementValue,

,Compare,GetReturnIndex|SetReturnIndex,
,If-TRUE-Goto,ExitLoopingStatement,
,Add,GetReturnIndex|1,

,Assign,GetReturnIndex|PDFIDX,

,GetReturnData,srkey|srkey|GetReturnIndex,
,GetReturnData,HValue|HValue|GetReturnIndex,
,GetReturnData,StatementMonth|StatementMonth|GetReturnIndex,

ExitLoopingStatement,NOP,,
,Assign,cachefix|##NOW##,

,Assign,DXWebURL|"https://ebank.hepsiian.com/cv/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",
,AppendVars,DXWebURL|srkey,
,AppendVars,DXWebURL|"&resolution=100&cachefix=",
,AppendVars,DXWebURL|cachefix,
,AppendVars,DXWebURL|"&hit=",
,AppendVars,DXWebURL|HValue,

,GetURLb,accountStatement|DXWebURL,

,AttachStatement,accountStatement|".pdf"|account,
,Goto,stmtLoop, 

//*****************************************************
// Seattle Credit Union Statement Layout END
//*****************************************************
SKipThisSeattlecu,FindString,">View Statements<"|test,
,If-TRUE-Goto,SkipNextdocCheck,  
,FindString,"> View Statement<"|test,
,If-TRUE-Goto,SkipNextdocCheck, 
,FindString,">View Documents<"|test,
,If-TRUE-Goto,SkipNextdocCheck,  
,FindString,">View eDocuments<"|test,
,If-TRUE-Goto,SkipNextdocCheck,  

,FindString,">View eStatements<"|test,  

,FindString,">Recent Statements<"|test,
,If-TRUE-Goto,Tower_apgfcu, 

SkipNextdocCheck,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,
,GetDataFromTag,URL1||"href",

,FindReplace,"amp;"|""|URL1|test,


,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/MonroeFederal/login.aspx",
,If-FALSE-Goto,SkipFulon,

,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/MonroeFederal/",
,Goto,Go2Apnd,

,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/fultonsavings9438/login.aspx",
,If-FALSE-Goto,SkipFulon,

,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/fultonsavings9438/",
,Goto,Go2Apnd,

SkipFulon,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/BayStateSavingsBank/SignIn.aspx",
,If-FALSE-Goto,SkipBay,

,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/BayStateSavingsBank/",
,Goto,Go2Apnd,

SkipBay,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/EquitableBank/login.aspx",
,If-FALSE-Goto,SkipDateForEquitableBank,

,Assign,ViewStmtURL|"",
,Goto,Go2Apnd,

SkipDateForEquitableBank,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/WCBonline/SignIn.aspx",
,If-FALSE-Goto,skipthisapnd,
,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/WCBonline/",
,Goto,Go2Apnd,

skipthisapnd,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipthisapnding,
,Assign,ViewStmtURL|"",
,Goto,Go2Apnd,

skipthisapnding,Compare,##TOWER_WEBSITE##|"https://secure.myvirtualbranch.com/Laurelroadbank/SignIn.aspx",
,If-FALSE-Goto,skipLaurelroadbank,
,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/LaurelRoadBank/",
,Goto,Go2Apnd,

skipLaurelroadbank,ParseString,srore|"/fultonsavings9438##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skip_Fultonsavings,
,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/fultonsavings9438/",
,Goto,Go2Apnd,

skip_Fultonsavings,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/windsorfederal6319/",
Go2Apnd,AppendVars,ViewStmtURL|URL1,

,GetURL,ViewStmtURL,

,Compare,##TOWER_WEBSITE##|"https://iqcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,SKIPTHISPOSTING,

,PostURLr,||0|##URL##,

,Assign,CC_IDXCHK|0,

,GetReturnData, ##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account|

,FindString,">Will Be Deleted<",
,If-FALSE-Goto,stmtLoop,

NextLooping,MoveToTag,"A"|test,
,If-FALSE-Goto,NextLoop1,

,GetDataFromTag,STMT_URL|STMT_Month|"href",
,FindReplace,"&amp;"|"&"|STMT_URL|test,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,CheckParse,

,ParseString,srore|"Credit Card Statement##KEEP##"|STMT_Month,,
,If-FALSE-Goto,NextLooping,

,Add,CC_IDXCHK|1,

,Compare,STMT_IDX|CC_IDXCHK,
,If-FALSE-Goto,NextLooping,

,Goto,GetStmtUrl,

CheckParse,ParseString,srore|"Show Next 6 Docume##KEEP##"|STMT_URL,
,If-TRUE-Goto,stmtLoop,

,ParseString,srore|"Member Share eStatemen##KEEP##"|STMT_Month,,
,If-FALSE-Goto,NextLooping,


,Add,STMT_IDXCHK|1,

,Compare,STMT_IDX|STMT_IDXCHK,
,If-FALSE-Goto,NextLooping,

GetStmtUrl,GetURL,STMT_URL||,

,FindString,"View Full Screen"|test,
,If-FALSE-Goto,stmtLoop,

,ExtractFromRawPage,view_fullurl|"window.open[(][']##KEEP##[']"|test, //"                                      


,GetURLb,accountStatement|view_fullurl,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,


SKIPTHISPOSTING,ExtractFromRawPage,LoginLibID|"LoginLibID=##KEEP##["]"|test,		//"

,Assign,RedirectURL|"https://edocuments.onlineaccountaccess.com/cowww5/menu/profile.asp?LoginLibID=",
,AppendVars,RedirectURL|LoginLibID,

,GetURL,RedirectURL|,

,GetURL,"https://edocuments.onlineaccountaccess.com/cowww/ui?service=cowww4Generic&href=/cowww5/menu/internetuser.asp"|,

,GetURL,"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp"|,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,

,FindReplace,"x"|""|anum|test,

,FindString,anum|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",

,ParseString,DocID|"DoctitleID[=]##KEEP##[&]"|sURL,
,ParseString,AppID|"AppID[=]##KEEP##[']"|sURL,

,Assign,sURL1|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewdoc_titlejs.asp?DoctitleID=XXXXX&AppID=YY",
,FindReplace,"XXXXX"|DocID|sURL1|test,
,FindReplace,"YY"|AppID|sURL1|test,

,GetURL,sURL1|,

,Assign,sURL2|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=XXXXX&TitleSearch=&AppID=YY",
,FindReplace,"XXXXX"|DocID|sURL2|test,
,FindReplace,"YY"|AppID|sURL2|test,

,GetURL,sURL2|,

chknextstmt,FindString,".add"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataAfterString,PrimaryKey|"[(]"|""|test,			//"
,If-FALSE-Goto,stmtLoop,

,Add,STMT_IDXCHK|1,

,Compare,STMT_IDX|STMT_IDXCHK,
,If-FALSE-Goto,chknextstmt,

,Assign,sURL3|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewdoc.asp?PrimaryKey=XXXXX&AppID=YY",
,FindReplace,"XXXXX"|PrimaryKey|sURL3|test,
,FindReplace,"YY"|AppID|sURL3|test,

,GetURL,sURL3|,

,ExtractFromRawPage,ViewerID|"ViewerID=##KEEP##&amp;"|test,

,Assign,sURL4|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=YY&PrimaryKey=XXXXX&AppViewerID=XYZ&DocumentID=ZZZZZ",
,FindReplace,"XXXXX"|PrimaryKey|sURL4|test,
,FindReplace,"YY"|AppID|sURL4|test,
,FindReplace,"ZZZZZ"|PrimaryKey|sURL4|test,
,FindReplace,"XYZ"|ViewerID|sURL4|test,

,GetURL,sURL4|,

,ExtractFromRawPage,store|"##KEEP##"|test,
,Assign,HTML_PAGE|"<html><head><title>Statement</title></head><body><pre>",
,AppendVars,HTML_PAGE|store,
,AppendVars,HTML_PAGE|"</pre></body></html>",

,ReloadVPage,HTML_PAGE,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,

,Goto,stmtLoop,

//*********************************************************************************************

AFCU,Assign,stmtIndex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

stmtLoop123,Compare,stmtIndex|account,
,If-TRUE-Goto,logout,

,MoveToTopOfPage,,


,Assign,stmtcheck|0,


,Add,stmtIndex|1,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,GetURL,sURL|,

,FindString,"Click here for eStatements",
,If-FALSE-Goto,getrtrndata,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL1||"href",
,GetURL,sURL1|,

,FindSignature,"To complete your enrollment please read Disclosure below",
,If-TRUE-Goto,Error961,

,GetURLr,"https://agfed.onlinebank.com/estatement.aspx"||##URL##, 

,GetURL,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Responsive/Pages/Default.aspx"|,

,SetHeader,"Content-Type"|"application/json;",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0	",
,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Configuration.asmx/GetMenu"|"",


,FindString,"What",

,GetDataAfterString,var|"href="|"=\/:.-?" ",		//"

,FindReplace,"\\""|""|var|test,		//"

,Assign,URL12|"https://applications.digitalmailer.com/IMS/CommunicationCenter/Responsive/Pages/",
,AppendVars,URL12|var,


,SetHeader,"Content-Type"|"application/json;",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0	",
,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Statements.asmx/GetMemberAccounts"|"",

,GetDataAfterString,user|"UserID":"|": ",	//"

,JSON-CreateObject,jObj,
,JSON-PutInObject,"userID"|user|jObj,
,JSON-PutInObject,"period"|"18"|jObj,

,SetHeader,"Content-Type"|"application/json;",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0	",
,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",
,SetHeader,"X-Requested-With"|"XMLHttpRequest",

,JSON-PostData,"https://applications.digitalmailer.com/IMS/CommunicationCenter/Services/Statements.asmx/GetUserStatements"|jObj,
,MoveToTopOfPage,,

nxtstmt12,GetDataAfterString,user|"UserID":"|": ",		//"
,If-FALSE-Goto,logout,
,GetDataAfterString,jobid|"JobID":"|": ",		//"
,GetDataAfterString,statementid|"StatementID":"|": ",	//"
,Add,stmtcheck|1,

,Compare,stmtcheck|STMT_IDX,
,If-FALSE-Goto,nxtstmt12,

,Assign,StmtURL|"https://applications.digitalmailer.com/IMS/CommunicationCenter/HTTPHandlers/RenderPDF.ashx?statementID=",
,AppendVars,StmtURL|statementid,
,AppendVars,StmtURL|"&jobID=",
,AppendVars,StmtURL|jobid,
,AppendVars,StmtURL|"&userID=",
,AppendVars,StmtURL|user,
,AppendVars,StmtURL|"&convertToFlash=false",
//https://applications.digitalmailer.com/IMS/CommunicationCenter/HTTPHandlers/RenderPDF.ashx?statementID=8773947&jobID=101975&userID=209540&convertToFlash=false

,Compare,##TOWER_WEBSITE##|"https://agfed.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skpIdxVal,
,GetDataAfterString,Idx|"Idx":"|": ",	//"

,Assign,StmtURL|"https://applications.digitalmailer.com/IMS/CommunicationCenter/HTTPHandlers/RenderPDF.ashx?Idx=",
,AppendVars,StmtURL|Idx,
,AppendVars,StmtURL|"&jobID=",
,AppendVars,StmtURL|jobid,
,AppendVars,StmtURL|"&userID=",
,AppendVars,StmtURL|user,

skpIdxVal,NOP,

,GetURLb,accountStatement|StmtURL,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop123,
//*******************************************************************************************

PDFlayout,Assign,stmtIndex|0,

NextLoop,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,pIndex|0,

,Compare,pIndex|account,
,If-TRUE-Goto,golog,

,Add,pIndex|1,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|pIndex,

,MoveToTopOfPage,,

,FindString,">eDocuments<"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"a"|"REV",
,GetDataFromTag,stmtlink||"href",

,GetURL,stmtlink|,

,FindSignature,"To enroll in eStatements simply click "View Statements" below##COMMA## review the account disclosure##COMMA## confirm your email address",
,If-TRUE-Goto,Error961, 

,Assign,pindex|1,
,Assign,FIPIindex|0,

,FindString,"View Documents"|test,
,If-FALSE-Goto,SkpThisMvA,

,MoveToTag,"a"|"REV",
,Goto,Go2MvA,

SkpThisMvA,FindString,"View Statements"|test,
,If-TRUE-Goto,GoTomoveArev, 
,FindString,"View Statements"|test,
,If-TRUE-Goto,GoTomoveArev, 

,MoveToTag,"a"|"REV",
Go2MvA,GetDataFromTag,sURL||"href",
,FindReplace,"&amp;"|"&"|sURL|test,

,GetURLr,sURL||##URL##,

,GetURLv2,"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp"|,

//,FindString,"Documents",
//,FindString,"Statements"|test,
//,FindString,">Statements<"|test,

,ParseString,anum1|"x##KEEP##"|anum,

,FindString,anum1|test,
,FindString,anum1|test,

,MoveToTag,"a"|"REV",
,GetDataFromTag,sURL||"href",

,ParseString,sURL|"javascript[:]openLink[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|sURL|test,
,GetURL,sURL|,

,FindString,"DocumentDisplay",
,MoveToTag,"iframe",
,GetDataFromTag,Doc_List||"SRC",
,FindReplace,"&amp;"|"&"|Doc_List|test,
,GetURL,Doc_List|,

,ParseString,AppID|"AppID[=]##KEEP##"|Doc_List,


chknxtstmt,Add,stmtIndex|1,

,GetDataAfterString,PrimaryKey|"add"|".('"|test,  //"
,ParseString,PrimaryKey|"[(]##KEEP##"|PrimaryKey,

,Compare,STMT_IDX|stmtIndex,
,If-FALSE-Goto,chknxtstmt,

,Assign,PDF_URL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,PDF_URL|AppID,
,AppendVars,PDF_URL|"&PrimaryKey=",
,AppendVars,PDF_URL|PrimaryKey,
,AppendVars,PDF_URL|"&AppViewerID=125&DocumentID=",
,AppendVars,PDF_URL|PrimaryKey,
,GetURL,PDF_URL|,

,Goto,stmntattch,

//***********************************City of Boston CU*************************************************************

PDFPost,Assign,PDF_URL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,PDF_URL|AppID,
,AppendVars,PDF_URL|"&PrimaryKey=",
,AppendVars,PDF_URL|PrimaryKey,
,AppendVars,PDF_URL|"&AppViewerID=488&DocumentID=",
,AppendVars,PDF_URL|PrimaryKey,
,GetURL,PDF_URL|,

,Goto,stmntattch,

//***********************************Northwest Community Bank*************************************************************

NorthwestPDF,Assign,PDF_URL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,PDF_URL|AppID,
,AppendVars,PDF_URL|"&PrimaryKey=",
,AppendVars,PDF_URL|PrimaryKey,
,AppendVars,PDF_URL|"&AppViewerID=186&DocumentID=",
,AppendVars,PDF_URL|PrimaryKey,
,GetURL,PDF_URL|,


stmntattch,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,Goto,NextLoop,

//********************************FI ID 6189****************************************************************

CONTINUEEE,Assign,Current_index|0,

,Assign,FISTMTindex|0,
nextDatestring,FindString,"Document Type"|test,
,If-FALSE-Goto,stmtLoop,

nextDateFStmt12,MoveToTag,"tr"|test,

,MoveToTag,"tr"|test,


,MoveToTag,"tr"|test,

,MoveToTag,"td"|test,
,If-FALSE-Goto,stmtLoop,
,GetDataFromTag,estmtURL||"onclick",

,ParseString,SRVK|"SRVK=##KEEP##&#39;"|estmtURL,
,ParseString,selectedItem|"documentbase.id.%3d##KEEP##&#39;"|estmtURL,
,ParseString,PostURL|"NavigatePopup[(]&#39;##KEEP##="|estmtURL,



,Add,FISTMTindex|1,

,Compare,STMT_IDX|FISTMTindex,
,If-TRUE-Goto,Strt_stmt_downnn,

,Compare,SRVK|"",
,If-FALSE-Goto,nextDateFStmt12,

,FindString,">Results",
,MoveToTag,"a",
,MoveToTag,"a",

,GetDataFromTag,estmtURL||"href",
,ParseString,__EVENTTARGET|"&#39[;]##KEEP##&#39[;]##COMMA##"|estmtURL,

,ExtractFromRawPage,FromDate_PU_PN_MonthView|"FromDate_PU_PN_MonthView['] value[=][']##KEEP##[']"|test,

,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate_PU_PN_MonthView"|FromDate_PU_PN_MonthView|0,
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET|0,

,PostURL,||0,

,Goto,nextDatestring,

Strt_stmt_downnn,AppendVars,PostURL|"=",
,AppendVars,PostURL|SRVK,
,AppendVars,PostURL|"&Popup=true",
,Assign,selectItem|"menuitem.documentaction=MenuItem.View&data.documentbase.id.=",
,AppendVars,selectItem|selectedItem,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,CreateForm,"DownloadFormBean"|PostURL,
,SetPostURLData,"SRVK2"|SRVK|"DownloadFormBean",
,SetPostURLData,"dummy"|""|"DownloadFormBean",
,SetPostURLData,"selectedItem"|selectItem|"DownloadFormBean",

,PostURL,PostURL||"DownloadFormBean",


,FindSignature,"IFrameUrl",
,If-FALSE-Goto,stmtLoop,                                


,ExtractFromRawPage,IFrameUrl|"id[=]["]IFrameUrl["] value[=]"##KEEP##""|test,
//,FindReplace,"False/False/False/False/True"|"False/False/True/True/True"|IFrameUrl|test,
,GetURL,IFrameUrl|,
,MoveToTag,"IFRAME",
,GetDataFromTag,estmtURL||"src",
,GetURL,estmtURL|,


,GetURLb,accountStatement|estmtURL
,AttachStatement,accountStatement|".pdf"|account,
,Goto,stmtLoop,

//=============================================================
FultonbankPDF,NOP

,FindString,"Welcome to Fulton Savings Bank's eStatement"|test,
,If-FALSE-Goto,stmtLoop,

,FindString,"View eStatements"|test, 
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,stmtURL||"href"|test,
,FindReplace,"&amp;"|"&"|stmtURL|test,

,Assign,stmtURL1|"/fultonsavings9438/",
,AppendVars,stmtURL1|stmtURL,                                   
,Assign,stmtURL11|"https://secure.myvirtualbranch.com", 
,AppendVars,stmtURL11|stmtURL1,                                       
,GetURLr,stmtURL11||##URL##, 

,ExtractFromRawPage,LoginLIBID|"LoginLibID[=]##KEEP##["]"|test,         //"   

,GetURLr,"https://edocuments.onlineaccountaccess.com/FultonSavings/menu.asp"||##URL##, 

,GetURLr,"https://edocuments.onlineaccountaccess.com/FultonSavings/left.html"||##URL##, 

,Goto,CommonPDFLayout,

//=============================================================


jcsbankPDF,NOP,

,MoveToTopOfPage,,
,FindString,">View eStatements<"|test,                                
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,stmtURL||"href"|test,
,Assign,stmtURL11|"https://secure.myvirtualbranch.com", 
,AppendVars,stmtURL11|stmtURL,                                       
,GetURLr,stmtURL11||##URL##, 

,ParseString,srore|"/secure.myvirtualbranch.com/jcsbank/##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,NextCheck,

,FindString,"View Statements"|test,
,Goto,jump_To_View,

NextCheck,FindString,"Welcome to Jewett City Savings Bank's eStatement"|test,
,If-FALSE-Goto,stmtLoop,

jump_To_View,FindString,"View Statements"|test,
,FindString,"View Statements"|test,                                
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,stmtURL||"href"|test,
,FindReplace,"&amp;"|"&"|stmtURL|test,

,Assign,stmtURL1|"/jcsbank/",
,AppendVars,stmtURL1|stmtURL,                                   
,Assign,stmtURL11|"https://secure.myvirtualbranch.com", 
,AppendVars,stmtURL11|stmtURL1,                                       
,GetURLr,stmtURL11||##URL##, 


,ExtractFromRawPage,LoginLIBID|"LoginLibID[=]##KEEP##["]"|test,         //"   

,GetURLr,"https://edocuments.onlineaccountaccess.com/JCSBank/menu.asp"||##URL##, 

,GetURLr,"https://edocuments.onlineaccountaccess.com/JCSBank/left.html"||##URL##, 

CommonPDFLayout,Assign,LoginLibURL|"https://edocuments.onlineaccountaccess.com/cowww5/menu/profile.asp?LoginLibID=",    
,AppendVars,LoginLibURL|LoginLIBID, 
,GetURLr,LoginLibURL||##URL##,                                      

,GetURLr,"/cowww/ui?service=cowww4Generic&href=/cowww5/menu/internetuser.asp"||##URL##

,FindString,"e-Statements"|test,
,FindString,"Documents"|test,
,FindString,"Statements"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,ParseString,srore1|"[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|srore1|test,

,Assign,AppendIndex|"https://edocuments.onlineaccountaccess.com", //"
,AppendVars,AppendIndex|srore1,
,GetURLr,AppendIndex||"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp", 
,Assign,Index|##URL##,  
,ExtractFromRawPage,DoctitleID|"DoctitleID[=]##KEEP##[&]"|test,
,Assign,Index123|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=",
,AppendVars,Index123|DoctitleID,
,AppendVars,Index123|"&TitleSearch=&AppID=",
,ExtractFromRawPage,AppID|"AppID[=]##KEEP##["]"|test, //"
,AppendVars,Index123|AppID,                                     
,GetURLr,Index123||##URL##,

,Assign,Index1234|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,Index1234|AppID,
,AppendVars,Index1234|"&PrimaryKey=",
,ExtractFromRawPage,PrimaryKey|"hitList.add[(]##KEEP##[##COMMA##]"|test,                                       
,AppendVars,Index1234|PrimaryKey,
,GetURLr,Index1234||##URL##,

,Assign,Index12345|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,Index12345|AppID,
,AppendVars,Index12345|"&PrimaryKey=",
,AppendVars,Index12345|PrimaryKey,
,AppendVars,Index12345|"&ViewerID=",
,ExtractFromRawPage,ViewerID|"ViewerID[=]##KEEP##[&]"|test,
,AppendVars,Index12345|ViewerID,
,AppendVars,Index12345|"&NewWindow=",
,GetURLr,Index12345||##URL##,

,FindString,"function initTabs()"|test,
,If-FALSE-Goto,rocklandtrustonlinestmtLoop,
,FindString,"new viewerTab"|test,
,If-FALSE-Goto,rocklandtrustonlinestmtLoop,
,Assign,IncCount|0,
,GetDataAfterString,AppViewerIDValue|""|"[+][(]##COMMA##[/][.][']",
IncCountLoop12,ParseString,AppViewerIDValue|"[##COMMA##]##KEEP##"|AppViewerIDValue,
,Add,IncCount|1,
,Compare,IncCount|13,
,If-TRUE-Goto,ExitIncCount12,
,Goto,IncCountLoop12,
ExitIncCount12,Assign,AppViewerID|AppViewerIDValue,
,ParseString,AppViewerID|"##KEEP##[##COMMA##]"|AppViewerID

,Assign,PDFURL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL|AppID,
,AppendVars,PDFURL|"&PrimaryKey=",
,AppendVars,PDFURL|PrimaryKey, 
,AppendVars,PDFURL|"&AppViewerID=",
,AppendVars,PDFURL|AppViewerID,
,AppendVars,PDFURL|"&DocumentID=",
,AppendVars,PDFURL|PrimaryKey,
,GetURLr,PDFURL||##URL##,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,Goto,stmtLoop,   

//*****************************************************

ColonialFederal0750PDF,Assign,stmtindex|0,

,ConvertStringToInt,##STMT_IDX##,

,MoveToTopOfPage,,

NextAcctIon,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Add,stmtindex|1,

,FindString,">eStatements<"|test
,If-TRUE-Goto,goforA,

,FindString,"eDocuments"|test

goforA,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,pdflink||"href",

,GetURL,pdflink|,

,Compare,##TOWER_WEBSITE##|"https://cafcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skip_cafcu,


//**********************************************************************************************************
,GetReturnData, ##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account|,

,Assign,PDFurl|##TOWER_WEBSITE##,

,FindReplace,"SignIn"|"eStatementsDesktop"|PDFurl|test,

//,GetURL,"https://cafcu.onlinebank.com/eStatementsDesktop.aspx"|,

,GetURL,PDFurl|,


,Assign,stmtindex|0,

,FindString,"Resize"|test,
,FindString,"Statement"|test,
,If-FALSE-Goto,Error960,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,nextcafcu,

,FindString,"VISA"|test,
,If-FALSE-Goto,Error960,

nextcafcu,MoveToTag,"li"|test,
,If-FALSE-Goto,logout,

,Add,stmtindex|1,

,Compare,stmtindex|STMT_IDX,
,If-FALSE-Goto,nextcafcu,

,GetDataAfterString,statURL|"[(][&]quot[;]"|"[.][?][=][&][/][;]",

,FindReplace,"amp;"|""|statURL|test,
,FindReplace,"&quot;"|""|statURL|test,

,GetURLb,accountStatement|statURL,
,AttachStatement,accountStatement|".pdf"|stmtindex,
,Goto,logout,

//**********************************************************************************************************

Skip_cafcu,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Compare,##TOWER_WEBSITE##|"https://mycfcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skipmycfcu,

,GetURL,"https://mycfcu.onlinebank.com/Accounts/IMSestatements.aspx"|,

,FindSignature,"Enroll in eDocuments",
,If-TRUE-Goto,Error961,

//,GetURL,"https://mycfcu.imsintegration.com/IMSIWeb/web/getContent?recordID=1"|,
,Assign,stmt_index|0,

,FindString," Account Statement(s)"|test
,If-FALSE-Goto,logout,
,MoveToTag,"a"|"REV",
,GetDataFromTag,pdflink||"href",

,ParseString,srore1|"[']##KEEP##[']"|pdflink,

,Assign,mycfcustmt|"https://mycfcu.imsintegration.com",
,AppendVars,mycfcustmt|srore1,

,GetURL,mycfcustmt|,

,FindSignature,"You do not currently have any documents to display",
,If-TRUE-Goto,Error960,

getNxt_Stmt,FindString,"Monthly Statement"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a",
,GetDataFromTag,PDF_URl||"href",

,Add,stmt_index|1,

,Compare,stmt_index|STMT_IDX,
,If-FALSE-Goto,getNxt_Stmt,


,Goto,Directgetstmt


Skipmycfcu,FindString,anum|test,
,If-TRUE-Goto,GoforeDOC,

,FindString,aname|test,

GoforeDOC,FindString,"View eDocuments"|test,

goforA1,MoveToTag,"a"|"REV",
,GetDataFromTag,ViewStmt||"href",  

,GetURL,ViewStmt|,

,MoveToTag,"form",

,GetDataFromTag,formvalue||"action",

,CreateForm,"TokenLoginForm"|formvalue,

,MoveToTag,"input",

,GetDataFromTag,Token||"value",

,SetPostURLData,"Token"|Token|"TokenLoginForm",

,PostURL,||"TokenLoginForm",

,FindSignature,"Important Information",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatement Enrollment",
,If-TRUE-Goto,Error961,

,Assign,SDATE|0,

,FindString,"Document Type",
CHECKNEXT1,FindString,"Deposit Statement",

,Add,SDATE|1,

,MoveToTag,"td"|"REV",
,MoveToTag,"td"|"REV",
,GetDataFromTag,|date1|,
,RemoveHTMLTags,date1,

,FindReplace,"&#47;"|""|date1|test,

,MoveToTag,"input"|"REV",
,GetDataFromTag,statURL||"value",

,FindString,">View<",
,MoveToTag,"td"|"REV",
,GetDataFromTag,SRVK||"onclick",
,ParseString,SRVK|"SRVK=##KEEP##&"|SRVK,

,Compare,##STMT_IDX##|SDATE,
,If-FALSE-Goto,CHECKNEXT1,

,Assign,PDF_URl|"https://gv-us.computershare.com/CI5/Content/Document.ashx/False/False/True/True/True/1/",
,AppendVars,PDF_URl|statURL,
,AppendVars,PDF_URl|"/2/MenuItem.View/_/0/_/False/document_",
,AppendVars,PDF_URl|date1,
,AppendVars,PDF_URl|".pdf?SRVK=",
,AppendVars,PDF_URl|SRVK,


Directgetstmt,GetURLb,accountStatement|PDF_URl,
,AttachStatement,accountStatement|".pdf"|stmtindex,

,Goto,NextAcctIon,
//--------------------------------------------------------------------------------------------

,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,idindex|0,

,MoveToTopOfPage,,

,FindString,">eStatements<"|test,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",

,GetURLv2,PURL,

,FindString,">View eStatements<"|test,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",

,FindReplace,"amp;"|""|URL1|test,

,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/FirstCountyBank/",
,AppendVars,ViewStmtURL|URL1,

,GetURL,ViewStmtURL,


,GetURLr,"https://edocuments.onlineaccountaccess.com/Firstcounty"||##URL##, 
,GetURL,"https://edocuments.onlineaccountaccess.com/Firstcounty/"|,

,MoveToTag,"frame",
,MoveToTag,"frame",
,MoveToTag,"frame",

,GetDataFromTag,statURL||"src",

,Assign,mainstmt|"https://edocuments.onlineaccountaccess.com",
,AppendVars,mainstmt|statURL,
,GetURL,mainstmt,


,GetURL,"https://edocuments.onlineaccountaccess.com/cowww/ui?service=cowww4Generic&href=/cowww5/menu/internetuser.asp"|,
,GetURL,"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp"|,

,FindString,"Statements"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,sURL||"href",
,ParseString,srore1|"[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|srore1|test,

,Assign,AppendIndex|"https://edocuments.onlineaccountaccess.com", //"
,AppendVars,AppendIndex|srore1,
,GetURLr,AppendIndex||"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp", 
,Assign,Index|##URL##,  
,ExtractFromRawPage,DoctitleID|"DoctitleID[=]##KEEP##[&]"|test,
,Assign,Index123|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=",
,AppendVars,Index123|DoctitleID,
,AppendVars,Index123|"&TitleSearch=&AppID=",
,ExtractFromRawPage,AppID|"AppID[=]##KEEP##["]"|test, //"
,AppendVars,Index123|AppID,                                     
,GetURLr,Index123||##URL##,

getnextid,Add,idindex|1,

,GetDataAfterString,var|"add[(]"|"",

,Compare,STMT_IDX|idindex,
,If-FALSE-Goto,getnextid,

,Assign,PrimaryKey|var,

,Assign,PDFURL1|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewdoc.asp?PrimaryKey=",
,AppendVars,PDFURL1|PrimaryKey,
,AppendVars,PDFURL1|"&AppID=",
,AppendVars,PDFURL1|AppID,
,GetURL,PDFURL1|,


,Assign,PDFURL2|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,PDFURL2|AppID,
,AppendVars,PDFURL2|"&PrimaryKey=",
,AppendVars,PDFURL2|PrimaryKey,
,AppendVars,PDFURL2|"&ViewerID=0&NewWindow=",

,GetURL,PDFURL2|,




,Assign,PDFURL3|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL3|AppID,
,AppendVars,PDFURL3|"&PrimaryKey=",
,AppendVars,PDFURL3|PrimaryKey, 
,AppendVars,PDFURL3|"&AppViewerID=",
,AppendVars,PDFURL3|"16",
,AppendVars,PDFURL3|"&DocumentID=",
,AppendVars,PDFURL3|PrimaryKey,
,GetURL,PDFURL3|,

,Assign,PDFURL4|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL4|AppID,
,AppendVars,PDFURL4|"&DocumentID=",
,AppendVars,PDFURL4|PrimaryKey, 
,AppendVars,PDFURL4|"&PrimaryKey=",
,AppendVars,PDFURL4|PrimaryKey, 
,AppendVars,PDFURL4|"&AppViewerID=",
,AppendVars,PDFURL4|"16",
,AppendVars,PDFURL4|"&DownloadLink=0&PrintMode=all",
,GetURL,PDFURL4|,

,AttachStatement,##VPAGE##|".pdf"|idindex,
,Goto,stmtLoop,   

//*********************************************************
falconbanklayout,NOP,,

,GetURL,"/Accounts/eStatements.aspx"||test,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,jump_TO_aplfcu,

,GetURL,"https://texasbaycu.onlinebank.com/CoWWWeStatement.aspx"||test,

,MoveToTag,"frame",
,MoveToTag,"frame",
,GetDataFromTag,LibID_URL||"src",

,GetURL,LibID_URL||test,

,ExtractFromRawPage,redirURL|"redirURL [=] [']##KEEP##[']"|test,
,GetURLr,redirURL||##URL##

,FindSignature,"Consent and Authorization",
,If-TRUE-Goto,error961,

,Assign,StmtIndex|0,
,Assign,nextpdfindex|0,

,ConvertStringToInt,##STMT_IDX##,

,MoveToTopOfPage,,

,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,Add,StmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|StmtIndex,

,Goto,jump_To_StatementPage,

jump_TO_aplfcu,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,SKIP_aplfcu_PDF,

,PostURL,||0,

,MoveToTag,"form"|test,
,GetDataFromTag,tempURL||"action",

,Assign,Referer|tempURL,

,FindString,">eDocuments<"|test,
,MoveToTag,"a"|"REV"|test,

,GetDataFromTag,token||"portalpage-id",

,Assign,getURL|"https://xdimemberportal.xdi.com/redirect/XXXXXXXX",
,FindReplace,"XXXXXXXX"|token|getURL|test,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Referer"|Referer,
,SetHeader,"Upgrade-Insecure-Requests"|"1",

,GetURLj,getURL|,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,AppendVars,getURL|"?userAgent=Mozilla/5.0%20(Windows%20NT%2010.0;%20Win64;%20x64;%20rv:83.0)%20Gecko/20100101%20Firefox/83.0&screenSize=8",

,JSON-GetData,getURL|,

,Goto,SDCCUBank,
,Assign,getURL|"https://xdimemberportal.xdi.com/api/portalTemplate/redirect/XXXXXXXX",
,FindReplace,"XXXXXXXX"|token|getURL|test,

,SetHeader,"Content-Type"|"application/json;charset=utf-8"|"T",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*"|"T",

,JSON-GetData,getURL|,



,ExtractFromRawPage,userName|""userName":"##KEEP##""|test,
,If-FALSE-Goto,Error960,

//*********************************************************

SKIP_aplfcu_PDF,ExtractFromRawPage,window_open|"open[(]["]##KEEP##["]"|test, //"
,If-TRUE-Goto,skipthiExtract,

,ExtractFromRawPage,window_open|"window.open[(][']##KEEP##[']"|test, //"

skipthiExtract,FindReplace,"\\"|""|window_open|test, //"
,EnableJavaScript,true,
,GetURL,window_open||test,


,FindSignature,"No statements to be displayed.",
,If-TRUE-Goto,Error960,
                                                                     
,FindSignature,">Change Statement Preferences<",
,If-TRUE-Goto,Error961,

,FindSignature,"Statement Delivery Preference",
,If-TRUE-Goto,Error961, 

,FindSignature,"Online Statement and Document Delivery Service Agreement Authorization and Consent",
,If-TRUE-Goto,Error961,

,FindSignature,"To provide an updated email address for e-Statements##COMMA## please follow these simple instructions",
,If-TRUE-Goto,Error961,

,FindSignature,"You must accept this agreement in order to view your statements through",
,If-TRUE-Goto,Error961,

,Compare,##TOWER_WEBSITE##|"https://falconbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,wecuBank,

,Compare,##TOWER_WEBSITE##|"https://www.tyndallonlinebanking.org/SignIn.aspx",
,If-FALSE-Goto,affinityplus,

,FindSignature,"Important information concerning your account",
,If-FALSE-Goto,skipthisposting,

,PostURL,||0,
//,PostURL,"https://estmt.businessdatainc.com/Tyndall/ExigentDocumentExit.do"||,

skipthisposting,FindSignature,"BillboardForm" method="post",
,If-FALSE-Goto,nxtsigFind,

,PostURL,||,

,FindSignature,"Important information concerning your account(s) is pending your review",
,If-FALSE-Goto,nxtsigFind,

,PostURL,||,

nxtsigFind,FindSignature,"Enroll in eStatements",
,If-TRUE-Goto,Error961,
  
,FindSignature,"To enroll##COMMA## please review and accept the terms and conditions",
,If-TRUE-Goto,Error961,  
  
,FindSignature,"Your statement will be available on your next cycle.",
,If-TRUE-Goto,Error960,  
,FindSignature,"No statements are currently available for the selected account.",
,If-TRUE-Goto,Error960,
  
,FindSignature,""Accept"",
,If-TRUE-Goto,Error961,  

  
,FindSignature,"Please review the disclosure below",
,If-TRUE-Goto,Error961, 

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,PDF_INDEX|0,
,Assign,stmtindex|0,

,ConvertStringToInt,##STMT_IDX##,

nxt_Act_Stmt,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Add,stmtindex|1,


,FindString,">Month End Statement<"|test,
,If-TRUE-Goto,Nxt_Stmt,

,FindString,"Month End Statement"|test,
,If-FALSE-Goto,nxt_Act_Stmt,

Nxt_Stmt,MoveToTag,"a"|test,
,If-FALSE-Goto,nxt_Act_Stmt,

,GetDataFromTag,StmtURL||"href",
,FindReplace,"&amp;"|"&"|StmtURL|test,

,Add,PDF_INDEX|1,


,Compare,STMT_IDX|PDF_INDEX,
,If-FALSE-Goto,Nxt_Stmt,

,GetURL,StmtURL|,
,FindString,""AccountNumber""|test,

,MoveToTag,"a"|test,

,GetDataFromTag,Download_Link||"href",
,FindReplace,"&amp;"|"&"|Download_Link|test,

,GetURLb,accountStatement|Download_Link,
,AttachStatement,accountStatement|".pdf"|stmtindex,

,Goto,nxtActStmt,                     
///////////////////////////////////////

affinityplus,GetURL,"https://onlinebanking.affinityplus.org/StatementsNotices.aspx"|,

,GetURLr,"https://onlinebanking.affinityplus.org/EstatementSSO.aspx"||##URL##,

,Assign,PDFINDEX|0,
,Assign,stmtindex|0,

,ConvertStringToInt,##STMT_IDX##,

nxtActStmt,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Add,stmtindex|1,

,FindSignature,"You have logged out of Statements &amp; Notices.",
,If-TRUE-Goto,Error960,
  
,FindSignature,""Yes##COMMA## I see the statement"",
,If-TRUE-Goto,Error961,

NextStatementLoop,FindString," Statements from"|test,
,If-FALSE-Goto,nxtActStmt,

GoTOnextTD,MoveToTag,"td"|test,
,If-FALSE-Goto,nxtActStmt,

,GetDataFromTag,nowrap||"nowrap",

,Compare,nowrap|"nowrap",
,If-FALSE-Goto,GoTOnextTD,

,MoveToTag,"a",
,GetDataFromTag,PPDFURL||"href",

,Add,PDFINDEX|1,


,Compare,PDFINDEX|##STMT_IDX##,
,If-FALSE-Goto,GoTOnextTD,

,PostURLb,accountStatement|PPDFURL,
,AttachStatement,accountStatement|".pdf"|stmtindex,
,Goto,nxtActStmt,

//*********************************************************



collinsccuBank,GetURLv2,"/eStatementSSOCollins.aspx"|,

get_PDFLIST,FindSignature,"eSign Confirmation Code",
,If-TRUE-Goto,Error961,

,Assign,stmtindex|0,
,Assign,PDFINDEX|0,

nextAcctStmt3,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Add,stmtindex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

,ExtractFromRawPage,CSRF_NONCE|"org[.]apache[.]catalina[.]filters[.]CSRF_NONCE[=]##KEEP##["]"|test, //"
,Assign,PDFPAGE|"https://ebank.hepsiian.com/cv/searchResults.jsf?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

,GetURLr,PDFPAGE||##URL##, 

,MoveToTopOfPage,,

,ExtractFromRawPage,ViewState|"ViewState["] value[=]["]##KEEP##["]"|test,//"

,FindString,"View Statement"|test,
,If-FALSE-Goto,logout,

,StrRev,anum,
,GetSubstring,anum|anum|0|4,
,StrRev,anum,
,FindString,anum|test,
,If-FALSE-Goto,logout,

,FindString,"View History"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,eventName||"name",

,Assign,execute|eventName,

,AppendVars,execute|" @component",

,ParseString,CSRF_NONCE|"CSRF_NONCE=##KEEP##"|##URL##,

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|ViewState|"results",
,SetPostURLData,"javax.faces.source"|eventName|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"javax.faces.partial.execute"|execute|"results",
,SetPostURLData,"org.richfaces.ajax.component"|eventName|"results",
,SetPostURLData,eventName|eventName|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Connection"|"keep-alive",

,PostURLr,PDFPAGE||"results"|##URL##, 

,ParseString,srore|"seattlecu.onlinebank.com##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,jump_To_PDFHistList,
//,Pause,5,

,Assign,SetReturnIndex|0,
,Assign,GetReturnIndex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindSignature,">Statement Not Available<",
,If-TRUE-Goto,Error960,

,FindString,"enoticesByAccount"|test,
LoopStatementValue,MoveToTag,"a"|test,
,If-FALSE-Goto,ExitSetReturnLoop,
,GetDataFromTag,|StatementMonth|,

,GetDataFromTag,dummyVal||"onclick",
,ParseString,stmtID|"[(][']##KEEP##[']"|dummyVal,
,If-FALSE-Goto,ExitSetReturnLoop,
,ConvertToValidDate,StatementMonth|test,
,If-FALSE-Goto,ExitSetReturnLoop,

,Add,SetReturnIndex|1,
,SetReturnData,stmtID|stmtID|SetReturnIndex,
,SetReturnData,StatementMonth|StatementMonth|SetReturnIndex,
,Goto,LoopStatementValue,

ExitSetReturnLoop,CompareNumbers,STMT_IDX|SetReturnIndex|>,    
,If-TRUE-Goto,stmtLoop,
,Compare,GetReturnIndex|SetReturnIndex,
,If-TRUE-Goto,ExitLoop,
,Add,GetReturnIndex|1,
,Assign,GetReturnIndex|STMT_IDX,
,GetReturnData,stmtID|stmtID|GetReturnIndex,
,GetReturnData,StatementMonth|StatementMonth|GetReturnIndex,
ExitLoop,NOP,,

,ExtractFromRawPage,srkey|"javascript:callStatementPDF2[(]'0'##COMMA## '##KEEP##'"|test,

,Compare,srkey|"",
,If-TRUE-Goto,Error108,

,ExtractFromRawPage,CSRF_NONCE|"org.apache.catalina.filters.CSRF_NONCE=##KEEP##""|test,//"

,Assign,index|"https://ebank.hepsiian.com/cv/popupPdf.jsf?pdfUrl=dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",
,AppendVars,index|srkey,
,AppendVars,index|"&resolution=100&cachefix=1490619715635&hit="
,AppendVars,index|stmtID,
,AppendVars,index|"&org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,index|CSRF_NONCE,
,AppendVars,index|"&org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,index|CSRF_NONCE,

,GetURL,index|,

,Assign,dxweb|"https://ebank.hepsiian.com/cv/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",
,AppendVars,dxweb|srkey,
,AppendVars,dxweb|"&resolution=100&cachefix=1490619715635&hit=",
,AppendVars,dxweb|stmtID,
,AppendVars,dxweb|"&org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,dxweb|CSRF_NONCE,

,GetURLb,accountStatement|dxweb,

,AttachStatement,accountStatement|".pdf"|account,
,Goto,nextAcctStmt3,

//////////////////*********************  myvirtualbranch *********************\\\\\\\\\\\\\\\\\\\\\\

myvirtualbranch,Assign,StmtIndex|0,
,Assign,nextpdfindex|0,

,ConvertStringToInt,##STMT_IDX##,

,MoveToTopOfPage,,

NextAcctmyvirtual,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,Add,StmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|StmtIndex,

,FindString,">eDocuments<"|test

,MoveToTag,"a"|"REV",
,GetDataFromTag,pdflink||"href",

,GetURL,pdflink|,

,FindString,"View Statements"|test
,If-TRUE-Goto,jump_Tab_A,

,FindString,"View Documents"|test,
,If-FALSE-Goto,stmtLoop,

jump_Tab_A,MoveToTag,"a",
,GetDataFromTag,pdflink||"href",

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

,MoveToTag,"frame"|test,
,MoveToTag,"frame"|test,
,MoveToTag,"frame"|test,

,GetDataFromTag,pdflink||"src",
,GetURL,pdflink|,

,ExtractFromRawPage,redirURL|"redirURL [=] [']##KEEP##[']"|test,
,GetURL,redirURL|,

jump_To_StatementPage,FindSignature,"eDocument User Agreement",
,If-TRUE-Goto,Error961,

,Right$,anum|anum|4,
,FindString,anum|test,
,If-TRUE-Goto,gotoReverseTag,

,MoveToTag,"a"|test,
,Goto,getHref,

gotoReverseTag,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,Error960,

getHref,GetDataFromTag,pdflink||"href",

,ParseString,pdflink|"openLink[(][']##KEEP##[']"|pdflink,

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

,FindString,"name="DocumentDisplay""|test

,MoveToTag,"IFRAME"|test,

,GetDataFromTag,pdflink||"src",

,ParseString,AppID|"AppID[=]##KEEP##"|pdflink,

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

MultStmtLoop,GetDataAfterString,PrimaryKey|"hitList[.]add[(]"|"",

,Add,nextpdfindex|1,

,Compare,nextpdfindex|STMT_IDX,
,If-FALSE-Goto,MultStmtLoop,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,skip_Below_Lines,

,Assign,StmtUrl|"/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,StmtUrl|AppID,
,AppendVars,StmtUrl|"&PrimaryKey=",
,Goto,Jump_to_Append,

skip_Below_Lines,Assign,StmtUrl|"/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,StmtUrl|AppID,
,AppendVars,StmtUrl|"&PrimaryKey=",
Jump_to_Append,AppendVars,StmtUrl|PrimaryKey,

,GetURL,StmtUrl|,

,MoveToTag,"IFRAME"|test,

,GetDataFromTag,StmtUrl||"src",
,FindReplace,"&amp;"|"&"|StmtUrl|test,

,GetURL,StmtUrl|,

,Compare,##TOWER_WEBSITE##|"https://texasbaycu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,skip_Below_Lines123,

,Assign,StmtUrl|"https://earchive2.ddsservicebureau.com/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,StmtUrl|AppID,
,AppendVars,StmtUrl|"&PrimaryKey=",
,AppendVars,StmtUrl|PrimaryKey,
,AppendVars,StmtUrl|"&AppViewerID=877&DocumentID=",
,AppendVars,StmtUrl|PrimaryKey,
,Goto,jump_TO_GetURL,

skip_Below_Lines123,FindString,"/cowww/DocumentServer/ViewDoc"|test,
,If-FALSE-Goto,Error960,

,ExtractFromRawPage,AppViewerID|"0##COMMA##0##COMMA##0##COMMA##['][']##COMMA##0##COMMA##0##COMMA##0##COMMA##0##COMMA####KEEP####COMMA##"|test,

,Assign,StmtUrl|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,StmtUrl|AppID,
,AppendVars,StmtUrl|"&PrimaryKey=",
,AppendVars,StmtUrl|PrimaryKey,
,AppendVars,StmtUrl|"&AppViewerID=",
,AppendVars,StmtUrl|AppViewerID,
,AppendVars,StmtUrl|"&DocumentID=",
,AppendVars,StmtUrl|PrimaryKey,

jump_TO_GetURL,GetURLv2,StmtUrl|,

,AttachStatement,##VPAGE##|".pdf"|StmtIndex,
,Goto,NextAcctmyvirtual,

//--------------------------------------------------------------------------------------------------
arborfcu,Assign,StmtIndex|0,
,Assign,nextpdfindex|0,

NextAccStmt2,Compare,StmtIndex|account,
,If-TRUE-Goto,stmtLoop,

,Add,StmtIndex|1,
,Assign,Pindex|0,

,GetURLv2,"/Home.aspx"|,

,FindString,"eStatements"|test,
,If-TRUE-Goto,stmtLoopURL1,

,FindString,">eStatements<"|test,
,If-FALSE-Goto,stmtLoop,

stmtLoopURL1,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,PDFURL||"href",
,GetURL,PDFURL|,

,FindSignature,"please accept the disclosure to continue to receive electronic statements",
,If-TRUE-Goto,Error961,

,FindString,"View Statements"|test
 
,MoveToTag,"a",
,GetDataFromTag,pdflink||"href", 

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

,MoveToTag,"frame"|test,
,MoveToTag,"frame"|test,


,GetDataFromTag,pdflink||"src",
,GetURL,pdflink|,

,ExtractFromRawPage,redirURL|"redirURL [=] [']##KEEP##[']"|test,
,GetURL,redirURL|,

,FindSignature,"ELECTRONIC DELIVERY OF CREDIT UNION STATEMENT AGREEMENT",
,If-TRUE-Goto,Error961,

,FindString,"Statements - PDF"|test,  
,If-FALSE-Goto,Error960,

//,Right$,anum|anum|4,
//,FindString,anum|test,
//,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV",
,GetDataFromTag,pdflink||"href",

,ParseString,pdflink|"openLink[(][']##KEEP##[']"|pdflink,

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

,FindString,"name="DocumentDisplay""|test

,MoveToTag,"IFRAME"|test,

,GetDataFromTag,pdflink||"src",

,ParseString,AppID|"AppID[=]##KEEP##"|pdflink,

,FindReplace,"&amp;"|"&"|pdflink|test,

,GetURL,pdflink|,

MultStmtLoop1,GetDataAfterString,PrimaryKey|"hitList[.]add[(]"|"",

,Add,nextpdfindex|1,

,Compare,nextpdfindex|STMT_IDX,
,If-FALSE-Goto,MultStmtLoop1,

,Assign,StmtUrl|"/cowww5/viewers/ViewDoc.asp?AppID=57&PrimaryKey=",
,AppendVars,StmtUrl|PrimaryKey,

,GetURL,StmtUrl|,

,MoveToTag,"IFRAME"|test,

,GetDataFromTag,StmtUrl||"src",
,FindReplace,"&amp;"|"&"|StmtUrl|test,

,GetURL,StmtUrl|,

,Assign,StmtUrl|"https://earchive6.ddsservicebureau.com/cowww/DocumentServer/ViewDoc?AppID=57&PrimaryKey=",
,AppendVars,StmtUrl|PrimaryKey,
,AppendVars,StmtUrl|"&AppViewerID=54&DocumentID=",
,AppendVars,StmtUrl|PrimaryKey,

,GetURLb,accountStatement|StmtUrl,

,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,NextAccStmt2,

//--------------------------------------------------------------------------------------------------
//        FIID 5899
//-------------------------------------------------------------------------------------------------
NewAmericanStat,NOP,,

,Compare,account|0,
,If-TRUE-Goto,logout,

,Assign,stmtIndex|0,

,Assign,PIindex|0,

,ConvertStringToInt,##STMT_IDX##,

nextAmericanStat,Compare,account|stmtIndex,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|stmtIndex,

,Assign,StmtUrl|"https://anbtx.onlinebank.com/Profile/Statements.aspx",

,GetURL,StmtUrl|,


,FindSignature,"Statements & Documents",
,If-FALSE-Goto,logout,

,MoveToTopOfPage,,

,FindString,anum|test,
,If-TRUE-Goto,SkipAccName,

,FindString,aname|test,
,If-FALSE-Goto,Error960,

SkipAccName,MoveToTag,"option"|"REV",

,GetDataFromTag,accountvalue||"value",

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"

,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"



,FindReplace,"%3b"|";"|M_layout_content_ScriptManager_TSM|test,

,FindReplace,"%2c"|"##COMMA##"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"%3d"|"="|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"%3a"|":"|M_layout_content_ScriptManager_TSM|test,

,CreateForm,"Form1"|"https://anbtx.onlinebank.com/Profile/Statements.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MMFU7X6$ctl00$ddlAccountList"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MMFU7X6$ctl00$ddlAccountList"|accountvalue|"Form1",

,PostURL,||"Form1",

,FindSignature,"No statements to be displayed.",
,If-TRUE-Goto,Error960,

,FindString,">Notice Type<"|test,
NextPDF11,MoveToTag,"a"|test,
,If-FALSE-Goto,nextAmericanStat,

,GetDataFromTag,PDFURL||"href",
,ParseString,srore|"##KEEP##DocumentID"|PDFURL,
,If-FALSE-Goto,Error960,

,MoveToTag,"td"|test,
,GetDataFromTag,|TempChk|,

,Compare,TempChk|"Notice",
,If-TRUE-Goto,NextPDF11,

,ParseString,srore|"Analysis##KEEP##"|TempChk,
,If-TRUE-Goto,NextPDF11,

,RemoveHTMLTags,PDFURL,

,Add,PIindex|1,

,Compare,##STMT_IDX##|PIindex,
,If-FALSE-Goto,NextPDF11,

,GetURLb,accountStatement|PDFURL,

,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,nextAmericanStat,
//------------------------------------------------------------------------------------------------------------------------------
//  		Statement Layout for FI ID 15216 
//------------------------------------------------------------------------------------------------------------------------------

AmericanStat,Compare,account|0,
,If-TRUE-Goto,logout,

,Assign,stmtIndex|0,

,Assign,PIindex|0,

,ConvertStringToInt,##STMT_IDX##,

nextAcctStmt,Compare,account|stmtIndex,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,



,FindSignature,">Statements & Documents<",
,If-FALSE-Goto,logout,


,MoveToTopOfPage,,


,FindString,">Statements & Documents<",

,MoveToTag,"A"|"REV",

,GetDataFromTag,EstatementURL||"href",

,RemoveHTMLTags,EstatementURL,

,Assign,E_statementURL|"https://anbtx.onlinebank.com",
,AppendVars,E_statementURL|EstatementURL,


,GetURLv2,E_statementURL|,


,FindString,">View Statements & Documents<",
,Goto,GoTOTAGA,


SkipBelowCode,FindString,"Statements & Notices",

GoTOTAGA,MoveToTag,"A"|"REV",

,GetDataFromTag,EstatementURL2||"href",

,RemoveHTMLTags,EstatementURL2,


,Assign,E_statementURL2|"https://anbtx.onlinebank.com",
,AppendVars,E_statementURL2|EstatementURL2,


,GetURLv2,E_statementURL2|,

,FindString,anum|test,
,If-TRUE-Goto,jump_To_OptionTAG,

,FindString,aname|test,
,If-FALSE-Goto,Error960,

jump_To_OptionTAG,MoveToTag,"option"|"REV",

,GetDataFromTag,accountvalue||"value",

,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"

,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"



,FindReplace,"%3b"|";"|M_layout_content_ScriptManager_TSM|test,

,FindReplace,"%2c"|"##COMMA##"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"%3d"|"="|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"%3a"|":"|M_layout_content_ScriptManager_TSM|test,


,CreateForm,"Form1"|"https://anbtx.onlinebank.com/ViewStatements.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MMFU7X6$ctl00$ddlAccountList"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MMFU7X6$ctl00$ddlAccountList"|accountvalue|"Form1",

,PostURL,||"Form1",

,FindSignature,"No statements to be displayed.",
,If-TRUE-Goto,Error960,

,FindString,">Notice Type<"|test,
NextPDF1,MoveToTag,"a"|test,
,If-FALSE-Goto,nextAcctStmt,

,GetDataFromTag,PDFURL||"href",
,ParseString,srore|"##KEEP##DocumentID"|PDFURL,
,If-FALSE-Goto,Error960,

,MoveToTag,"td"|test,
,MoveToTag,"td"|test,
,MoveToTag,"td"|test,
,GetDataFromTag,|TempChk|,

,Compare,TempChk|"Notice",
,If-TRUE-Goto,NextPDF1,

,ParseString,srore|"Analysis##KEEP##"|TempChk,
,If-TRUE-Goto,NextPDF1,

,RemoveHTMLTags,PDFURL,

,Add,PIindex|1,

,Compare,##STMT_IDX##|PIindex,
,If-FALSE-Goto,NextPDF1,

,GetURLb,accountStatement|PDFURL,

,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,nextAcctStmt,

//*************************//sunstatefcu//****************************

sunstatefcuLayout,Assign,StmtIndex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,


,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,formType||"href",

,ParseString,PDFURL|"##KEEP##/SignIn.aspx"|##TOWER_WEBSITE##,

,Assign,PDFURL1|PDFURL,
,AppendVars,PDFURL1|formType,

,GetURL,PDFURL1|,
//**************************************************************************************
,Compare,##TOWER_WEBSITE##|"https://beaconcu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,beaconcuskipLayout,

,ExtractFromRawPage,redirectURL|"window.open[(]["]##KEEP##["]"|test|,
,GetURLv2,redirectURL|,

,FindSignature,"Communication Center Error",
,If-TRUE-Goto,Error960,

,FindSignature,"to Read Disclosure and Enroll in",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatement Enrollment Form",
,If-TRUE-Goto,Error961,

,PostURL,||0,

,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",
,SetHeader,"Content-Type"|"application/json; charset=utf-8",

,JSON-PostData,"https://eservices.digitalmailer.com/ccc/Services/Statements.asmx/GetMemberAccounts"|"",

,ExtractFromRawPage,userID|"UserID":##KEEP####COMMA##"|test,    //"

,Assign,index|"{userID:XXXXXXXX}",
,FindReplace,"XXXXXXXX"|userID|index|test,

,SetHeader,"Accept"|"application/json##COMMA## text/javascript##COMMA## */*; q=0.01",
,SetHeader,"Content-Type"|"application/json; charset=utf-8",

,JSON-PostData,"https://eservices.digitalmailer.com/ccc/Services/Statements.asmx/GetStatements"|index,

nxtGetStatement7,FindString,"UserID"|test,
,If-FALSE-Goto,sunstatefcuLayout,

,Add,StmtIndex|1,

,Compare,StmtIndex|STMT_IDX,
,If-FALSE-Goto,nxtGetStatement7,

,GetDataAfterString,UserID|"":"|"",//"
,If-FALSE-Goto,nxtGetStatement7,

,GetDataAfterString,JobID|"JobID":"|"",//"
,If-FALSE-Goto,nxtGetStatement7,

,GetDataAfterString,StatementID|"StatementID":"|"",//"
,If-FALSE-Goto,nxtGetStatement7,

,GetDataAfterString,Idx|"Idx":"|"",//"
,If-FALSE-Goto,nxtGetStatement7,

,Assign,index|"{Idx:XXXX##COMMA##jobID:YYYYYY##COMMA##userID:ZZZZZZ}",

,FindReplace,"XXXX"|Idx|index|test,
,FindReplace,"YYYYYY"|JobID|index|test,
,FindReplace,"ZZZZZZ"|UserID|index|test,

,SetHeader,"Content-Type"|"application/json",
,JSON-PostData,"https://eservices.digitalmailer.com/ccc/Services/Statements.asmx/GetStatementDetails"|index,

,Assign,index|##URL##,

,Assign,StmtURL|"https://eservices.digitalmailer.com/ccc/HTTPHandlers/RenderPDF.ashx?Idx=AAA&jobID=BBB&userID=CCCC",
,FindReplace,"AAA"|Idx|StmtURL|test,
,FindReplace,"BBB"|JobID|StmtURL|test,
,FindReplace,"CCCC"|UserID|StmtURL|test,

,GetURLv2,StmtURL|,
,Goto,binaryDump,
//**************************************************************************************
beaconcuskipLayout,FindSignature,"By clicking the Accept button below",
,If-TRUE-Goto,Error961,
                                                     
,FindString,"Launch eStatements"|test,
,If-FALSE-Goto,SkipThisLaunch,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,LaunchURL||"href",

,GetURLv2,LaunchURL|,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipThisLaunch,

,FindString,">Date<"|test,
,If-FALSE-Goto,Error960,

SkipThisLaunch,FindString,">Date<"|test,
,If-FALSE-Goto,Error960,

NxtPDF,MoveToTag,"td"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|test,
,GetDataFromTag,formType||"href",

,Add,StmtIndex|1,

,Compare,StmtIndex|STMT_IDX,
,If-FALSE-Goto,NxtPDF,

,Assign,StmtURL|"https://www3.mystatement.org",
,AppendVars,StmtURL|formType,

,FindReplace,"&amp;"|"&"|StmtURL|test,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml",

binaryDump,GetURLb,accountStatement|StmtURL,
,AttachStatement,accountStatement|".pdf"|StmtIndex,
,Goto,stmtLoop,

//************************************************************************************

CornerstoneBank,Assign,stmtIndex|0,

StmtLoopCornerstoneBank,Compare,stmtIndex|account,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtIndex,

,MoveToTopOfPage,,

,FindString,">eStatements<"|test,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",

,GetURLv2,PURL,

,FindString,">View eStatements<"|test,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",

,FindReplace,"amp;"|""|URL1|test,

,Assign,ViewStmtURL|"https://secure.myvirtualbranch.com/CornerstoneBank/",
,AppendVars,ViewStmtURL|URL1,

,GetURL,ViewStmtURL,

,ExtractFromRawPage,LoginLIBID|"LoginLibID[=]##KEEP##["]"|test, //"  

,GetURLr,"https://edocuments.onlineaccountaccess.com/cornerstonebank/menu.asp"||##URL##, 

,Assign,LoginLibURL|"https://edocuments.onlineaccountaccess.com/cowww5/menu/profile.asp?LoginLibID=",    
,AppendVars,LoginLibURL|LoginLIBID, 

,GetURLr,LoginLibURL||##URL##, 

,GetURLr,"https://edocuments.onlineaccountaccess.com/cornerstonebank/menu.asp"||##URL##, 

,GetURLr,"/cowww/ui?service=cowww4Generic&href=/cowww5/menu/internetuser.asp"||##URL##

,FindString,"Documents"|test,
,FindString,"Statements"|test,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV",
,GetDataFromTag,sURL||"href",
,ParseString,srore1|"[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|srore1|test,

,Assign,AppendIndex|"https://edocuments.onlineaccountaccess.com", //"
,AppendVars,AppendIndex|srore1,
,GetURLr,AppendIndex||"https://edocuments.onlineaccountaccess.com/cowww5/menu/internetuser.asp", 

,Assign,Index|##URL##,  
,ExtractFromRawPage,DoctitleID|"DoctitleID[=]##KEEP##[&]"|test,
,Assign,Index123|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=",
,AppendVars,Index123|DoctitleID,
,AppendVars,Index123|"&TitleSearch=&AppID=",
,ExtractFromRawPage,AppID|"AppID[=]##KEEP##["]"|test, //"
,AppendVars,Index123|AppID,                                     
,GetURLr,Index123||##URL##,

,Assign,PIIndex|0,

pdfstmtLoop2,GetDataAfterString,PrimaryKey|"hitList.add[(]"|""|test,  
,If-FALSE-Goto,StmtLoopCornerstoneBank, 

,Add,PIIndex|1,

,Compare,PIIndex|STMT_IDX,
,If-FALSE-Goto,pdfstmtLoop2,  

,Assign,Index1234|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,Index1234|AppID,
,AppendVars,Index1234|"&PrimaryKey=",                                   
,AppendVars,Index1234|PrimaryKey,
,GetURLr,Index1234||##URL##,

,Assign,Index12345|"https://edocuments.onlineaccountaccess.com/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,Index12345|AppID,
,AppendVars,Index12345|"&PrimaryKey=",
,AppendVars,Index12345|PrimaryKey,
,AppendVars,Index12345|"&ViewerID=",
,ExtractFromRawPage,ViewerID|"ViewerID[=]##KEEP##[&]"|test,
,AppendVars,Index12345|ViewerID,
,AppendVars,Index12345|"&NewWindow=",
,GetURLr,Index12345||##URL##,


,FindString,"function initTabs()"|test,

,FindString,"new viewerTab"|test,

,Assign,IncCount|0,

,GetDataAfterString,AppViewerIDValue|""|"[+][(]##COMMA##[/][.][']",

IncCountLoop125,ParseString,AppViewerIDValue|"[##COMMA##]##KEEP##"|AppViewerIDValue,
,Add,IncCount|1,

,Compare,IncCount|13,
,If-TRUE-Goto,ExitIncCount125,

,Goto,IncCountLoop125,

ExitIncCount125,Assign,AppViewerID|AppViewerIDValue,
,ParseString,AppViewerID|"##KEEP##[##COMMA##]"|AppViewerID

,Assign,PDFURL|"https://edocuments.onlineaccountaccess.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL|AppID,
,AppendVars,PDFURL|"&PrimaryKey=",
,AppendVars,PDFURL|PrimaryKey, 
,AppendVars,PDFURL|"&AppViewerID=",
,AppendVars,PDFURL|AppViewerID,
,AppendVars,PDFURL|"&DocumentID=",
,AppendVars,PDFURL|PrimaryKey,
,GetURLr,PDFURL||##URL##,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,

,Goto,StmtLoopCornerstoneBank,

//**********************************************************************************************************
//************************************************ KPCU **********************************************************
KPCU_Layout,NOP,,
,Assign,stmtindex|0,

,ConvertStringToInt,##STMT_IDX##,

Next_Account,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Assign,PDF_Index|0,

,Add,stmtindex|1,

,MoveToTopOfPage,,

,FindSignature,">Enrollment",
,If-TRUE-Goto,Error961,  

,FindSignature,"Electronic Document Agreement",
,If-TRUE-Goto,Error961,  

,FindString,"View Account:"|test,
,If-TRUE-Goto,Get_number,
  
,FindString,">Account Number:<"|test,
,If-FALSE-Goto,SkipThisPosting,

Get_number,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

,ParseString,TempAccNum|"x##KEEP##"|anum|test,

,FindString,TempAccNum|test,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,SkipThisPosting,
  
,GetDataFromTag,value||"value",

,SetPostURLData,"ith"|value,
,PostURL,||,

SkipThisPosting,FindSignature,"No statements are currently available for the selected account.",
,If-TRUE-Goto,Error960,
  
,FindSignature,"Electronic Communications Disclosure and Consent",
,If-TRUE-Goto,Error961,

,FindSignature,">Enrollment",
,If-TRUE-Goto,Error961,

,FindSignature,"Electronic Document Agreement",
,If-TRUE-Goto,Error961,

,FindSignature,"There are no statements available at this time",
,If-TRUE-Goto,Error960,

,FindString,"Statement Date"|test,
,If-TRUE-Goto,Next_Statement,

,FindString,"Date"|test,

Next_Statement,MoveToTag,"a"|test,
,If-FALSE-Goto,Next_Account,

,GetDataFromTag,PDF_URl||"href",
,FindReplace,"&amp;"|"&"|PDF_URl|test,

,ParseString,type|"type=##KEEP##&"|PDF_URl|test,

,Add,PDF_Index|1,

,Compare,PDF_Index|##STMT_IDX##,
,If-FALSE-Goto,Next_Statement,

,GetURLb,accountStatement|PDF_URl,
,AttachStatement,accountStatement|".pdf"|stmtindex,

,Goto,Next_Account,  

//************************************************ OceanBank **********************************************************

OceanBank,GetURLv2,"/eStatements.aspx"|,

,Assign,stmtindex|0,
,Add,stmtindex|1,

,GetURLv2,"https://oceanbank.onlinebank.com/eStatementsLandingPage.aspx"|,

,Compare,institutionId|"3185",
,If-FALSE-Goto,SkipBusinessStatement,

,FindSignature,"Personal eStatements",
,If-FALSE-Goto,SkipPersonalEstatement,

,Assign,PersonalSTmtF|"TRUE",

,GetURLv2,"https://oceanbank.onlinebank.com/ViewAlleStatements.aspx"|,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

,FindSignature,anum,
,If-TRUE-Goto,SkipExistingURL,

,Assign,PersonalSTmtF|"FALSE",
,Goto,GoForBusiness,
SkipPersonalEstatement,FindSignature,"Business eStatements",
,If-FALSE-Goto,SkipBusinessStatement,

GoForBusiness,Assign,BusinessSTmtF|"TRUE",

,GetURLv2,"https://oceanbank.onlinebank.com/BusinesseStatements.aspx"|,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Referer"|"https://oceanbank.onlinebank.com/VieweAllStatementsBusiness.aspx",
,Goto,SkipExistingURL,

SkipBusinessStatement,GetURLv2,"https://oceanbank.onlinebank.com/ViewAlleStatements.aspx"|,
SkipExistingURL,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,PDfvalue||"value",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"
//,CreateForm,"aspnetForm"|"./VieweAllStatementsBusiness.aspx",

,Compare,institutionId|"3185",
,If-FALSE-Goto,SkipBusiness_Statement,

,Compare,PersonalSTmtF|"TRUE",
,If-FALSE-Goto,SkipPersonal_Statement,

,CreateForm,"aspnetForm"|"./ViewAlleStatements.aspx",
,SetPostURLData,"M$layout$content$PCDZ$MLZOB77$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:669ca791-a838-4419-82bc-9fa647338708:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MLZOB77$ctl00$ctl00$ctl00$lstAccounts"|"aspnetForm",
,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Accept-Language"|"en-US##COMMA##en;q=0.5",
,SetHeader,"Accept-Encoding"|"gzip##COMMA## deflate##COMMA## br",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Referer"|"https://oceanbank.onlinebank.com/ViewAlleStatements.aspx",
,Goto,Skip_ExistingParams,

SkipPersonal_Statement,Compare,BusinessSTmtF|"FALSE",
,If-TRUE-Goto,SkipBusiness_Statement,

,CreateForm,"aspnetForm"|"./VieweAllStatementsBusiness.aspx",
,SetPostURLData,"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",
,Goto,Skip_ExistingURL,

SkipBusiness_Statement,CreateForm,"aspnetForm"|"./VieweAllStatements.aspx",
Skip_ExistingURL,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:669ca791-a838-4419-82bc-9fa647338708:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",

,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|"aspnetForm",
Skip_ExistingParams,SetPostURLData,"__EVENTARGUMENT"|""|"aspnetForm",,
,SetPostURLData,"__LASTFOCUS"|""|"aspnetForm",,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

,Compare,PersonalSTmtF|"TRUE",
,If-TRUE-Goto,SkipBusiness_Post,

,Compare,BusinessSTmtF|"TRUE",
,If-TRUE-Goto,SkipBusiness_Post,

,SetPostURLData,"M$layout$content$PCDZ$MLZOB77$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",

SkipBusiness_Post,PostURL,||"aspnetForm",


//,GetURLv2,"https://oceanbank.onlinebank.com/VieweAllStatementsBusiness.aspx"|,


//,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

//,FindString,anum|test,

//,MoveToTag,"option"|"REV"|test,
//,GetDataFromTag,PDfvalue||"value",

//,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
//,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

//,CreateForm,"aspnetForm"|"./VieweAllStatementsBusiness.aspx",
//,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|"aspnetForm",
//,SetPostURLData,"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",
//,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
//,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
//,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

//,PostURL,||"aspnetForm",

,Assign,Pdf_Index|0,
,Assign,STMTIDX|##STMT_IDX##,
,ConvertStringToInt,STMTIDX,

Nxt_Date1,FindString,">Description<"|test,
,If-FALSE-Goto,Error960,

,Add,Pdf_Index|1,

,Compare,STMTIDX|Pdf_Index,
,If-FALSE-Goto,Nxt_Date1,



,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,PDF_data||"href",

,FindReplace,"&amp;"|"&"|PDF_data|test,
,ParseString,Postdata1|"[&][#]39[;]##KEEP##[&][#]39[;]"|PDF_data,
,FindReplace,"[$]"|":"|Postdata1|test,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,Compare,BusinessSTmtF|"FALSE",
,If-TRUE-Goto,SkipBusiness_header,

,SetHeader,"Referer"|"https://oceanbank.onlinebank.com/VieweAllStatementsBusiness.aspx",
SkipBusiness_header,SetHeader,"Referer"|"https://oceanbank.onlinebank.com/VieweAllStatements.aspx",
,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,Compare,PersonalSTmtF|"FALSE",
,If-TRUE-Goto,Skip_Personal_STMTURL,

,CreateForm,"aspnetForm"|"./ViewAlleStatements.aspx",
,Goto,Skip_Existing_STMTURL,

Skip_Personal_STMTURL,Compare,BusinessSTmtF|"FALSE",
,If-TRUE-Goto,Skip_Business_STMTURL,

,CreateForm,"aspnetForm"|"./VieweAllStatementsBusiness.aspx",
,Goto,Skip_Existing_STMTURL,
Skip_Business_STMTURL,CreateForm,"aspnetForm"|"./VieweAllStatements.aspx",

Skip_Existing_STMTURL,SetPostURLData,"__EVENTTARGET"|Postdata1|"aspnetForm",
,SetPostURLData,"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

,PostURLb,accountStatement|||"aspnetForm",
,AttachStatement,accountStatement|".pdf"|stmtindex,
,Goto,stmtLoop,

,FindString,">Personal eStatements<"|test,
,GetURLv2,"https://oceanbank.onlinebank.com/PersonaleStatements.aspx"|,

,FindString,"Online Banking Disclosures and Agreements - Ocean Bank"|test,
,If-TRUE-Goto,Error961,

,FindSignature,">TERMS AND CONDITIONS<",
,If-TRUE-Goto,Error961,

,Assign,Pdf_Index|0,
,ConvertStringToInt,##STMT_IDX##,

Next_Date1,FindString,">Description<"|test,

,MoveToTag,"a",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PDF_data||"href",

,FindReplace,"&amp;"|"&"|PDF_data|test,
,ParseString,Postdata1|"[&][#]39[;]##KEEP##[&][#]39[;]"|PDF_data,
,FindReplace,"[$]"|":"|Postdata1|test,

,Add,Pdf_Index|1,

,Compare,##STMT_IDX##|Pdf_Index,
,If-FALSE-Goto,Next_Date1,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Referer"|"https://oceanbank.onlinebank.com/VieweAllStatementsBusiness.aspx",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,CreateForm,"aspnetForm"|"./VieweAllStatementsBusiness.aspx",
,SetPostURLData,"__EVENTTARGET"|Postdata1|"aspnetForm",
,SetPostURLData,"M$layout$content$PCDZ$MXYCQ92$ctl00$ctl00$ctl00$lstAccounts"|PDfvalue|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

,PostURLb,accountStatement|||"aspnetForm",
,AttachStatement,accountStatement|".pdf"|stmtindex,
,Goto,stmtLoop,

//*****************************************************

SouthWestAirlinesCU,Assign,StmtIndex|0,

NextAccStmt,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,Add,StmtIndex|1,
,Assign,Pindex|0,
,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,PDFURL||"href",
,GetURL,PDFURL|,

,ParseString,srore|"/bankingonline.lfcu##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,Get_wecu,

,FindSignature,"please accept the disclosure to continue to receive electronic statements",
,If-TRUE-Goto,Error961,

,FindString,"Statement Date"|test,
,If-FALSE-Goto,NextAccStmt,

Prev_MonthStmt,MoveToTag,"td"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|test,
,GetDataFromTag,TargetValue||"href",
,ParseString,EventTarget|"LinkButtonClick[(][']##KEEP##[']"|TargetValue,
,FindReplace,"[$]"|":"|EventTarget|test,

,Add,Pindex|1,
,Compare,Pindex|STMT_IDX,
,If-FALSE-Goto,Prev_MonthStmt,

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,CreateForm,"aspnetForm"|"./eStatements.aspx",
,SetPostURLData,"__EVENTTARGET"|EventTarget|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:8f95decb-d716-4257-bc42-c772df7173e5:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a"|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

,PostURLb,accountStatement|||"aspnetForm",
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,NextAccStmt,

//*****************************************************

Tower_apgfcu,NOP,

,Assign,StmtIndex|0,

Next_Acc_Stmt,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,MoveToTopOfPage,,

,Add,StmtIndex|1,

,FindString,">Recent Statements<"|test,
,If-FALSE-Goto,Next_Acc_Stmt,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,Base_URL||"href",

,ParseString,__EVENTTARGET|"[&][#]39[;]##KEEP##[&][#]39[;]"|Base_URL,

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"User-Agen"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,SkipThisPst,

,Assign,DocumentTypeName|"Visa Statements",

,Goto,CreatPost,

SkipThisPst,NOP,,

,Assign,DocumentTypeName|"Online Statements",

CreatPost,CreateForm,"aspnetForm"|"./OnlineStatements.aspx",

,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET|"aspnetForm",
,SetPostURLData,"M$layout$content$PCDZ$MAP7F3F$ctl00$ddlDocumentTypeName"|DocumentTypeName|"aspnetForm",
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|TSM_CombinedScripts|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",

,PostURL,||"aspnetForm",


,FindString,">Statement Date<"|test,
,If-FALSE-Goto,Next_Acc_Stmt,

,Assign,PDF_Index|0,

,Add,PDF_Index|1,

Prev_Month_Stmt,MoveToTag,"input"|test,
,GetDataFromTag,Stmt_ID||"name",

,Assign,Stmt_ID1|Stmt_ID,
,AppendVars,Stmt_ID1|".",
,AppendVars,Stmt_ID1|"x",

,Assign,Stmt_ID2|Stmt_ID,
,AppendVars,Stmt_ID2|".",
,AppendVars,Stmt_ID2|"y",

,Compare,PDF_Index|STMT_IDX,
,If-TRUE-Goto,gotodown_Stmt,

,Add,PDF_Index|1,

,Goto,Prev_Month_Stmt,

gotodown_Stmt,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"User-Agen"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"

,ExtractFromRawPage,TSM_CombinedScripts|"_TSM_CombinedScripts_[=]##KEEP##["]"|test,		//"

,FindReplace,"%3b"|";"|TSM_CombinedScripts|test,
,FindReplace,"%2c"|"##COMMA##"|TSM_CombinedScripts|test,
,FindReplace,"[+]"|" "|TSM_CombinedScripts|test,
,FindReplace,"%3d"|"="|TSM_CombinedScripts|test,
,FindReplace,"%3a"|":"|TSM_CombinedScripts|test,

,SetPostURLData,Stmt_ID1|"6"|0,
,SetPostURLData,Stmt_ID2|"5"|0,

,PostURL,||0,

,MoveToTag,"iframe"|test,
,GetDataFromTag,Stmt_URL||"src",

,GetURLb,accountStatement|Stmt_URL,
,AttachStatement,accountStatement|".pdf"|StmtIndex,
,Goto,Next_Acc_Stmt,
//**********************************FI ID 2748************
XeedPDF,Assign,StmtIndex|0,
,EnableJavaScript,true,

NextAcStmt,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,Add,StmtIndex|1,
,Assign,Pindex|0,
,MoveToTopOfPage,,

,FindString,"eStatement"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,PD_URL||"href",
,GetURL,PD_URL||, 

,SetHeader,"Referer"|"https://estmt.businessdatainc.com/Xceed/CookieValidation.jsp",
,GetURL,"https://estmt.businessdatainc.com/Xceed/secure/InitialFrame.jsp"|,
,GetURL,"https://estmt.businessdatainc.com/Xceed/secure/custom/MainFrame.jsp"|,
,GetURL,"https://estmt.businessdatainc.com/Xceed/DocumentPageSetup.do"|,

,FindString,"Regular Monthly Statement"|test,
,If-FALSE-Goto,logout,
,MoveToTag,"a"|test,
,MoveToTag,"a"|test,
,If-FALSE-Goto,logout,
,Assign,pdfUrl|"https://estmt.businessdatainc.com",

,GetDataFromTag,pdfUrls|stmtdate|"href",
,AppendVars,pdfUrl|pdfUrls,

,FindReplace,"&amp;"|"&"|pdfUrl|test,

,GetURLb,accountStatement|pdfUrl,
,AttachStatement,accountStatement|".pdf"|StmtIndex,
,Goto,NextAcStmt,
//****************************************************

NewMembersccu,NOP,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,StmtIndex|0,

NxtAccStmt,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,MoveToTopOfPage,,

,Add,StmtIndex|1,
,Assign,PIndex|0,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|StmtIndex,

,MoveToTopOfPage,,

,FindString,"eStatements"|test,
,If-FALSE-Goto,NxtAccStmt,

,MoveToTag,"a"|"REV",
,GetDataFromTag,StmtURL||"href",

,GetURLv2,StmtURL|,

,FindString,">View Statements<"|test,
,If-FALSE-Goto,NxtAccStmt,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",

,ParseString,URL|"[.][.]##KEEP##"|URL1,

,FindReplace,"amp;"|""|URL|test,

,Assign,ViewStmtURL|"https://membersccu.onlinebank.com",
,AppendVars,ViewStmtURL|URL,

,GetURLr,ViewStmtURL||##URL##, 

,GetURL,"https://improxy.membersccu.org/cowww5/menu/menu.asp"|,
,GetURL,"https://improxy.membersccu.org/cowww/ui?service=cowww4Generic"|,
,GetURL,"https://improxy.membersccu.org/cowww5/menu/internetuser.asp"|,



,Compare,##TOWER_WEBSITE##|"https://membersccu.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,Skip_MonthlySTMT,

,FindString,"Monthly Statements"|test,
,If-TRUE-Goto,Skip_To_GetData,

,Right$,tempaNum|anum|4|test,
,FindString,tempaNum|test,

Skip_To_GetData,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,Error960,
,GetDataFromTag,AccStmt||"href",

,ParseString,AccStmt1|"openLink[(][']##KEEP##['][)]"|AccStmt,


,Assign,AccStmtURL|AccStmt1,

,FindReplace,"&amp;"|"&"|AccStmtURL|test,
,ParseString,AppID|"AppID=##KEEP##"|AccStmt1|test,
,GetURL,AccStmtURL|,


,MoveToTag,"iframe"|test,
,MoveToTag,"iframe"|test,
,MoveToTag,"iframe"|test,
,GetDataFromTag,sURL2||"src",
,FindReplace,"&amp;"|"&"|sURL2|test,
,GetURL,sURL2|,

,FindString,"Date"|test,

NxtIdindex,Add,PIndex|1,

,GetDataAfterString,var|"add[(]"|"",

,Compare,STMT_IDX|PIndex,
,If-FALSE-Goto,NxtIdindex,

,ExtractFromRawPage,AppID|"AppID[=]##KEEP##[&]"|test, //"
,Assign,PrimaryKey|var,
                              
,Assign,PDFURL1|"https://improxy.membersccu.org/cowww5/viewers/viewdoc.asp?PrimaryKey=",
,AppendVars,PDFURL1|PrimaryKey,
,AppendVars,PDFURL1|"&AppID=",
,AppendVars,PDFURL1|AppID,
,GetURL,PDFURL1|,

,Assign,PDFURL2|"https://improxy.membersccu.org/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,PDFURL2|AppID,
,AppendVars,PDFURL2|"&PrimaryKey=",
,AppendVars,PDFURL2|PrimaryKey,
,AppendVars,PDFURL2|"&ViewerID=0&NewWindow=",
,GetURL,PDFURL2|,

,Assign,PDFURL3|"https://improxy.membersccu.org/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL3|AppID,
,AppendVars,PDFURL3|"&PrimaryKey=",
,AppendVars,PDFURL3|PrimaryKey, 
,AppendVars,PDFURL3|"&AppViewerID=175&DocumentID=",
,AppendVars,PDFURL3|PrimaryKey,
,GetURL,PDFURL3|,

,Assign,PDFURL4|"https://improxy.membersccu.org/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL4|AppID,
,AppendVars,PDFURL4|"&DocumentID=",
,AppendVars,PDFURL4|PrimaryKey, 
,AppendVars,PDFURL4|"&PrimaryKey=",
,AppendVars,PDFURL4|PrimaryKey, 
,AppendVars,PDFURL4|"&AppViewerID=175",
,AppendVars,PDFURL4|"&DownloadLink=0&PrintMode=all",
,GetURL,PDFURL4|,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,Goto,NxtAccStmt,
//**************************************************************************************
,Compare,STMT_IDX|PIndex,
,If-FALSE-Goto,NxtPIndex,

,Assign,PrimaryKey|var,

,ExtractFromRawPage,AppID|"AppID[=]##KEEP##[&]"|test,

,Assign,PDFURL1|"https://improxy.membersccu.org/cowww/DocumentServer/ViewDoc?AppID=",
,AppendVars,PDFURL1|AppID,
,AppendVars,PDFURL1|"&PrimaryKey=",
,AppendVars,PDFURL1|PrimaryKey,
,AppendVars,PDFURL1|"&AppViewerID=175&DocumentID=",
,AppendVars,PDFURL1|PrimaryKey,

,GetURL,PDFURL1|,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,
,Goto,NxtAccStmt,
  
//**********************************************


wecuBank,NOP,
,Assign,stmtindex|0,
,Assign,PDFINDEX|0,
  
  
nextAcctStmt33,Compare,stmtindex|account,
,If-TRUE-Goto,logout,

,Add,stmtindex|1,

,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|stmtindex,

,FindSignature,"Electronic Delivery Disclosure and Agreement",
,If-TRUE-Goto,Error961, 

,ParseString,srore|"ulstersavings##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,searchResultsurl,

,MoveToTopOfPage,,

,FindString,">Statements<",
,MoveToTag,"a"|"REV",
,GetDataFromTag,statURL||"href",
,GetURL,statURL|,
  
,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,error961,
,Goto,skipGetURL,

searchResultsurl,Assign,PDFPAGE|"https://ebank.hepsiian.com/cv/searchResults.jsf",

,Compare,##TOWER_WEBSITE##|"https://online.wecu.com/SignIn.aspx",
,If-FALSE-Goto,skipGetURL,

,GetURLr,"/Accounts/eStatements.aspx"||##URL##,

,PostURLr,||0|##URL##,

,FindString,"Confirmation Code"|test,
,If-TRUE-Goto,Error961,

,Goto,skipDefault,

skipGetURL,ParseString,srore|"independentbank##KEEP##"|##TOWER_WEBSITE##,	// FI ID: 7726
,If-FALSE-Goto,independentbankSkip,

,MoveToTopOfPage,,
,Assign,PDFPAGE|"https://edocs.hepsiian.com/cv/searchResults.jsf",

,FindString,">Documents<"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,statURL||"href",
,GetURL,statURL|,

independentbankSkip,ExtractFromRawPage,CSRF_NONCE|"org.apache.catalina.filters.CSRF_NONCE['][:][']##KEEP##['][}]"|test, //"

,AppendVars,PDFPAGE|"?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

skipDefault,ExtractFromRawPage,ViewState|"j_id1:javax.faces.ViewState:1" value[=]["]##KEEP##["]"|test,//"

,FindString,"Consent for Electronic Communication of Online Documents"|test,
,If-TRUE-Goto,Error961,

,FindString,"View Statement"|test,
,If-FALSE-Goto,Error960,

,ParseString,srore|"ulstersavings##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,skipnumsearch,
  
,StrRev,anum,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skpSubStr,
,ParseString,anum|"-##KEEP##"|anum,
,GetSubstring,anum|anum|0|3,
,Goto,Cont,

skpSubStr,GetSubstring,anum|anum|0|3,

Cont,StrRev,anum,
,Assign,GetReturnIndex|0,
,Assign,SetReturnIndex|0,
,FindString,anum|test,
,If-FALSE-Goto,nextAcctStmt33,

skipnumsearch,FindString,"View History"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,eventName||"name",

,Assign,execute|eventName,
,AppendVars,execute|" @component",

,ParseString,CSRF_NONCE|"CSRF_NONCE=##KEEP##"|##URL##,

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|ViewState|"results",
,SetPostURLData,"javax.faces.source"|eventName|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"javax.faces.partial.execute"|execute|"results",
,SetPostURLData,"org.richfaces.ajax.component"|eventName|"results",
,SetPostURLData,eventName|eventName|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Connection"|"keep-alive",

,PostURLr,PDFPAGE||"results"|##URL##, 


         
jump_To_PDFHistList,Assign,SetReturnIndex|0,
,Assign,GetReturnIndex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

//,FindSignature,">Statement Not Available<",
//,If-TRUE-Goto,Error960,
                               
,FindString,">No eNotices found."|test,
,If-TRUE-Goto,Error960,
                         
,FindString," View History -"|test,
        
LoopStatementValueee,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,
,GetDataFromTag,|StatementMonth|,
,GetDataFromTag,dummyVal||"onclick",

,ParseString,srkey|"javascript:getHitPDF[(][']##KEEP##[']"|dummyVal, //"
,ParseString,hitvalue|"##COMMA## '##KEEP##[']"|dummyVal, //"



,If-FALSE-Goto,ExitSetReturnLoop,
,ConvertToValidDate,StatementMonth|test,
,If-FALSE-Goto,ExitSetReturnLoop,

,Add,SetReturnIndex|1,
,SetReturnData,srkey|srkey|SetReturnIndex,
,SetReturnData,hitvalue|hitvalue|SetReturnIndex,
,SetReturnData,StatementMonth|StatementMonth|SetReturnIndex,

,CompareNumbers,STMT_IDX|SetReturnIndex|>,    
,If-TRUE-Goto,LoopStatementValueee,


,Compare,GetReturnIndex|SetReturnIndex,
,If-TRUE-Goto,ExitLooppp,
,Add,GetReturnIndex|1,

,Assign,GetReturnIndex|STMT_IDX,

,GetReturnData,srkey|srkey|GetReturnIndex,
,GetReturnData,hitvalue|hitvalue|GetReturnIndex,
,GetReturnData,StatementMonth|StatementMonth|GetReturnIndex,
ExitLooppp,NOP,,

,Assign,dxweb|"https://ebank.hepsiian.com/cv/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",

,ParseString,srore|"independentbank##KEEP##"|##TOWER_WEBSITE##,	// FI ID: 7726
,If-FALSE-Goto,edocsSkip,
,Assign,dxweb|"https://edocs.hepsiian.com/cv/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",

edocsSkip,AppendVars,dxweb|srkey,
,AppendVars,dxweb|"&resolution=100&cachefix=1542354875274&hit=",
,AppendVars,dxweb|hitvalue,

,GetURLb,accountStatement|dxweb,

,AttachStatement,accountStatement|".pdf"|account,
//,DumpToFile,accountStatement|"C:/Images/statement.pdf",
,Goto,nextAcctStmt33,
////////////////////////////////////////////////////////////////////////////////////////////////  
CSVLayout1,EnableJavaScript,true,


,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",
,If-FALSE-Goto,takeoldURL,

,GetReturnData,sURL1|sURL1|hIndex,
,ParseString,ccaccnum|"/Accounts/##KEEP##"|sURL1,
,Assign,CCURL|"https://my.communityfirstcu.org/PSCUCreditCardSSOProvider.aspx?sa=",
,AppendVars,CCURL|ccaccnum,


,GetURL,CCURL|,

,Goto,rendernow,

takeoldURL,GetReturnData,sURL1|sURL1|account,
,ParseString,ccaccnum|"/Accounts/##KEEP##"|sURL1,
,Assign,CCURL|"https://my.communityfirstcu.org/2269/PSCUCreditCardSSOProvider.aspx?sa=",
,AppendVars,CCURL|ccaccnum,

,GetURL,CCURL|,

rendernow,FindSignature,"Verify Profile Email Address",
,If-TRUE-Goto,Useraction_108,

,FindString,"Account Home"|test,

,MoveToTag,"form"|test,

,Compare,##TOWER_WEBSITE##|"https://my.communityfirstcu.org/LogIn.aspx",    // Credit card trsnactions // Don't Remove Comment
,If-FALSE-Goto,skip_numSearch,

,ParseString,tempNum|"x##KEEP##"|anum,

,FindString,tempNum,|test,

 skip_numSearch,FindString,"View Transactions"|test,
,FindString,"View Transactions"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,AggURL1||"href",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 5.1; rv:25.0) Gecko/20100101 Firefox/25.0",
,SetHeader,"Accept"|"text/xml",
,SetHeader,"Wicket-Ajax"|"true",
,SetHeader,"Wicket-FocusedElementId"|"id10",
,SetHeader,"ADRUM"|"isAjax:true",

,GetURLv2,AggURL1|,

,ExtractFromRawPage,interfacevalue|"wicket[:]interface[=][:]##KEEP##[:]"|test,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 5.1; rv:25.0) Gecko/20100101 Firefox/25.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Referer"|"https://apstp.pscu.com/AP/APCardholder/?wicket:interface=:0::::",

,Assign,ApphxAggURL|"https://apphx.pscu.com/AP/APCardholder/?wicket:interface=:",
,AppendVars,ApphxAggURL|interfacevalue,
,AppendVars,ApphxAggURL|"::::",
,GetURLv2,ApphxAggURL|,

,FindSignature,"Generic Error Page - PSCU",
,If-FALSE-Goto,SkipApstpPost,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 5.1; rv:25.0) Gecko/20100101 Firefox/25.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",

,Assign,ApstpAggURL|"https://apstp.pscu.com/AP/APCardholder/?wicket:interface=:",
,AppendVars,ApstpAggURL|interfacevalue,
,AppendVars,ApstpAggURL|"::::",
,GetURLv2,ApstpAggURL|,

SkipApstpPost,ConvertDateToText,##STARTDATE##|startDate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|endDate|"MM/dd/yyyy",

,FindString,"Select Period"|test,
,MoveToTag,"SELECT"|test,
,GetDataFromTag,daterangeurl||"onchange",
,ParseString,daterangeurl|"wicketAjaxPost[(][']##KEEP##[']##COMMA##"|daterangeurl,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0"|,
,SetHeader,"Accept"|"text/xml"|,
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:selectPeriodDropDown"|"4",
,PostURL,daterangeurl||,

,FindString,">Submit<"|test,
,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,transurl||"onclick",
,ParseString,transurl|"##COMMA## [']##KEEP##[']##COMMA##"|transurl,

,FindReplace,"&amp;"|"&"|transurl|test,

,Assign,Epoch|##NOW##,

,AppendVars,transurl|"&random=0.625",
,AppendVars,transurl|Epoch,
  

,CreateForm,"Form1"|transurl,
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:selectPeriodDropDown"|"4"|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:fromDateDecorator:fromDate"|startDate|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:toDateDecorator:toDate"|endDate|"Form1",
,SetPostURLData,"transactionsContainer:allTabContainer:Components/ViewAllTabTransactions:viewAllTabContainer:iwanttodropdown"|"0"|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:submitBtnLink"|"1"|"Form1",
,PostURL,transurl||"Form1",

,FindSignature,"The selected date range cannot be more than 90 days. Please select a valid date range.",
,If-FALSE-Goto,SkipRollDate_90,

,RollDate,##ENDDATE##|startDate|DAY|-89|test,    //When FI provides only 3 Months Transactions. 
,ConvertDateToText,startDate|startDate|"MM/dd/yyyy",

,CreateForm,"Form1"|transurl,
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:selectPeriodDropDown"|"4"|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:fromDateDecorator:fromDate"|startDate|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:toDateDecorator:toDate"|endDate|"Form1",
,SetPostURLData,"transactionsContainer:allTabContainer:Components/ViewAllTabTransactions:viewAllTabContainer:iwanttodropdown"|"0"|"Form1",
,SetPostURLData,"transactionsContainer:viewTransactionHistoryContainer:rangeSelectionContainer:viewTransactionsHistorySelectionContainer:submitBtnLink"|"1"|"Form1",
,PostURL,transurl||"Form1",

SkipRollDate_90,FindString,"I Want to"|test,
,MoveToTag,"SELECT"|test,
,GetDataFromTag,transurl||"onchange",
,ParseString,transurl|"[(][']##KEEP##[']"|transurl,

,ParseString,interface|"[?]wicket:interface=:##KEEP##[:]"|transurl,

,Assign,Refererurl|"https://apphx.pscu.com/AP/APCardholder/?wicket:interface=:",

,AppendVars,Refererurl|interface,
,AppendVars,Refererurl|"::::",

,Assign,Epoch|##NOW##,

,AppendVars,transurl|"-1&random=0.561",
,AppendVars,transurl|Epoch,
  
,CreateForm,"Form1"|transurl,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML##COMMA## like Gecko) Chrome/70.0.3538.102 Safari/537.36"|,
,SetHeader,"Accept"|"text/xml"|,
,SetHeader,"Referer"|Refererurl,
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
 
,SetPostURLData,"transactionsContainer:allTabContainer:Components/ViewAllTabTransactions:viewAllTabContainer:iwanttodropdown"|"2"|"Form1",
,PostURL,transurl||"Form1",
  
 ,ExtractFromRawPage,posttransurl|".LOCATION.HREF=[']##KEEP##[']"|test,
 
 ,ParseString,interface|"[?]wicket:interface=:##KEEP##[:]"|posttransurl,
 
 ,Assign,Refererurl|"https://apphx.pscu.com/AP/APCardholder/?wicket:interface=:",
 ,AppendVars,Refererurl|interface,
,AppendVars,Refererurl|"::::",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 5.1; rv:25.0) Gecko/20100101 Firefox/25.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,SetHeader,"Referer"|Refererurl,  
  
,GetURLv2,posttransurl|,

,Assign,txnIndex|0,

,CSV-GetReader,reader|##VPAGE##,
,CSV-GetHeaderPosition,DatePosition|"Transaction Date"|reader|test,
,If-FALSE-Goto,NextHisAcct11,
,CSV-GetHeaderPosition,DescPosition|"Description"|reader|test,
,If-FALSE-Goto,NextHisAcct11,
,CSV-GetHeaderPosition,AmtPostion|"Amount"|reader|test,
,If-FALSE-Goto,NextHisAcct11,

nxtTxn,CSV-GetRecord,record|reader|test,
,If-FALSE-Goto,NextHisAcct11,

,CSV-GetValue,txnDate|record|DatePosition,
,RemoveHTMLTags,txnDate,

,Compare,txnDate|"No History",
,If-TRUE-Goto,nxtTxn,

,Compare,txnDate|"No matching activity.",
,If-TRUE-Goto,nxtTxn,

,ConvertToValidDate,txnDate,

,CSV-GetValue,txnDis|record|DescPosition,
,RemoveHTMLTags,txnDis,
,RemoveExtraWhitespaces,txnDis,

,CSV-GetValue,txnAmt|record|AmtPostion,
,RemoveHTMLTags,txnAmt,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,skipNegAmount,


,AppendVars,txnAmt|"-",


skipNegAmount,ConvertToValidDollar,txnAmt,

,Add,txnIndex|1,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|txnDate|hIndex|txnIndex,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|txnDis|hIndex|txnIndex,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|txnAmt|hIndex|txnIndex,

,Goto,nxtTxn,

//***************************************************************************************
//              JSON DISCOVERY LAYOUT
//***************************************************************************************
allsouthlayout,NOP,


,Compare,##SINGLE_SESSION_STATE##|"SINGLE_SESSION_LOGIN",
,If-FALSE-Goto,newachlable,

 
,Compare,SingleSessionEnabledFlag|"TRUE",
,If-TRUE-Goto,newachlable,
 
 ,AddSingleSession,,
 
 newachlable,NOP,


,Assign,redirectedURL|##URL##,

,ParseString,domain|"//##KEEP##/"|redirectedURL|test,




,FindSignature,""logoff.aspx"",
,If-FALSE-Goto,lblSkipLoggOffURL,

,Assign,AutoLogoutURL|"https://TOWERDOMAIN/logoff.aspx"
,Goto,lblReplaceTowerDomain,

lblSkipLoggOffURL,Assign,AutoLogoutURL|"https://TOWERDOMAIN/LoggedOut.aspx",
lblReplaceTowerDomain,FindReplace,"TOWERDOMAIN"|domain|AutoLogoutURL|test,
,AutoLogout,AutoLogoutURL,

,Assign,logoutURL|AutoLogoutURL,



,ExtractFromRawPage,XCSRFToken|"["]X-CSRF-Token["]##COMMA## ["]##KEEP##["]"|test,    //"
 ,FindReplace,"\\"|""|XCSRFToken|test,

,SetHeader,"Accept"|"application/json",

,Assign,apiURL|"https://TOWERDOMAIN/api/"
,FindReplace,"TOWERDOMAIN"|domain|apiURL|test,
,JSON-GetData,apiURL|,

,ExtractFromRawPage,XRequestToken|"Accounts["]##COMMA##["]token["][:]["]##KEEP##""|test,    //"

,SetHeader,"X-Request-Token"|XRequestToken,
,SetHeader,"X-CSRF-Token"|XCSRFToken,
,SetHeader,"Accept"|"application/json",

,Assign,apiSumURL|"https://TOWERDOMAIN/api/Accounts"
,FindReplace,"TOWERDOMAIN"|domain|apiSumURL|test,

,JSON-GetData,apiSumURL|,

//====================================================
//  ACCOUNT SCRAPPING SECTION
//====================================================
nextAccountScrapping,NOP,

,FindSignature,"[]",
,If-TRUE-Goto,error914,

,FindSignature,"accountNumber",
,If-FALSE-Goto,Error908,

,ExtractFromRawPage,RoutingN|"routingNumber":"##KEEP##""|test,        //"         

,ExtractFromRawPage,PageContents|"##KEEP##"|test,             // To make a JSON Array
,Assign,VPAGE|"{"accountsresponse":",
,AppendVars,VPAGE|PageContents,
,AppendVars,VPAGE|"}",

,Assign,account|0,
,Assign,accountIndex|0,
,Assign,ofxAccountId|"",
,Assign,ofxAccountType|"",

,JSON-GetValueFromObject,accountList|"accountsresponse"|VPAGE|test, 
  
,JSON-GetLength,len|accountList,

AcctDiscLoop,CompareNumbers,len|accountIndex|<=,
,If-TRUE-Goto,Newhistory22,

,JSON-GetValueFromArray,anum|"accountNumber"|accountIndex|accountList|test,
  
,FindSignature,"ofxAccountType",
,If-FALSE-Goto,SkipofxAccountId,
  
,JSON-GetValueFromArray,ofxAccountId|"ofxAccountId"|accountIndex|accountList|test,
,JSON-GetValueFromArray,ofxAccountType|"ofxAccountType"|accountIndex|accountList|test,
  
SkipofxAccountId,JSON-GetValueFromArray,Acctype|"type"|accountIndex|accountList|test,
,JSON-GetValueFromArray,abal|"ledgerBalance"|accountIndex|accountList|test,
,JSON-GetValueFromArray,acctDetailURL|"getAt"|accountIndex|accountList|test,
,JSON-GetValueFromArray,aname|"nickname"|accountIndex|accountList|test,


,ParseString,sURL1|"url":"##KEEP##""|acctDetailURL|test,    //"
,FindReplace,"\?"|""|aname|test, 
,ConvertToValidDollar,abal|test,

,ParseString,srore|"[0-9]##KEEP##"|ofxAccountType|test,
,If-TRUE-Goto,skipThisType,

,Compare,ofxAccountType|"",			// IF OFX Account Type is Blank.
,If-TRUE-Goto,skipThisType,

,Assign,Acctype|ofxAccountType,

//***************************************AccType parsing Layout********************************
skipThisType,ParseString,type|"CHECKING##KEEP##"|Acctype,
,If-TRUE-Goto,set100,

,ParseString,type|"Certificate##KEEP##"|Acctype,
,If-TRUE-Goto,set102,

,ParseString,type|"SAVINGS##KEEP##"|Acctype,
,If-TRUE-Goto,set101,

,ParseString,type|"CREDITCARD##KEEP##"|Acctype,
,If-TRUE-Goto,set200,

,ParseString,type|"Mastercard##KEEP##"|aname,
,If-TRUE-Goto,set200,

,ParseString,type|"Visa##KEEP##"|aname,
,If-TRUE-Goto,set200,

,ParseString,type|"Home Equity##KEEP##"|aname,
,If-TRUE-Goto,set201,          

,ParseString,type|"CREDITLINE##KEEP##"|Acctype,
,If-TRUE-Goto,set401,

,ParseString,type|"Loan##KEEP##"|Acctype,
,If-FALSE-Goto,verifyCertificates,
  
,ParseString,type|"Line of Credit##KEEP##"|aname,
,If-TRUE-Goto,set201,
  
,ParseString,type|"LOC##KEEP##"|aname,
,If-TRUE-Goto,set201,
,Goto,set401,

verifyCertificates,ParseString,type|"CD##KEEP##"|Acctype,
,If-TRUE-Goto,set102,
                                                                                    
//////////////////////////////////////////////

,Compare,##REQUEST##|"DISCOVERY",   
,If-FALSE-Goto,set100,

,Assign,AccTypeID|"-1", 
,Log,ALERT|"Setting Default 6th Account Type for firstambank.scr"|Acctype,

,Goto,dataElems,   

set100,Assign,AccTypeID|"100",
,Goto,dataElems,

set101,Assign,AccTypeID|"101",
,Goto,dataElems,

set200,Assign,AccTypeID|"200",
,Goto,dataElems,

set201,Assign,AccTypeID|"201",
,Goto,dataElems,

set400,Assign,AccTypeID|"400",
,Goto,dataElems,

set103,Assign,AccTypeID|"103",
,Goto,dataElems,
  
set102,Assign,AccTypeID|"102",
,Goto,dataElems,

set401,Assign,AccTypeID|"401",

dataElems,NOP,

,JSON-GetValueFromArray,availablebal|"availableBalance"|accountIndex|accountList|test,

,ParseString,srore|"200##PIPE##201##PIPE##400##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,compAcctBal,

,JSON-GetValueFromArray,availablebal|"availableCreditBalance"|accountIndex|accountList|test,

compAcctBal,Compare,abal|"0.0",
,If-TRUE-Goto,getPositiveBalance,

,ParseString,srore|"200##PIPE##201##PIPE##400##PIPE##401##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,getPositiveBalance,

,ParseString,testbal|"[-]##KEEP##"|abal|test,
,If-TRUE-Goto,getPositiveBalance,
                                                                         
,AppendVars,abal|"-",

getPositiveBalance,ConvertToValidDollar,abal|test,

,GetLength,MaskedNumber_length|anum
  
,Compare,MaskedNumber_length|5,
,If-FALSE-Goto,SkipMaskAccLogic1,

,Right$,MaskedAccNumber|anum|5,
,Goto,SkipAlterNumb1,  
  
SkipMaskAccLogic1,Right$,MaskedAccNumber|anum|6,
SkipAlterNumb1,Add,accountIndex|1,

,CheckAccounts,anum||||aname,
,If-TRUE-Goto,addIndex,
  
,ParseString,srore|"[-]##KEEP##"|anum|test,
,If-FALSE-Goto,AcctDiscLoop,
,ParseString,anum|"[-]##KEEP##"|anum|test,
  
,CheckAccounts,anum||||aname,
,If-FALSE-Goto,AcctDiscLoop,

addIndex,Add,account|1,
,SetReturnData,sURL1|sURL1|account,
,SetReturnData,AccURL|AccURL|account,
,SetReturnData,Acctype|Acctype|account,

,Compare,ofxAccountId|"",
,If-TRUE-Goto,skipOfxAccountId,
  
,SetReturnData,ofxAccountId|ofxAccountId|account,
skipOfxAccountId,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|abal|account,
,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,


,Compare,MaskedAccNumber|"",
,If-TRUE-Goto,SkipMaskNumbSet,

,Assign,MaskNumber_discovery|"T",


,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|account,   


SkipMaskNumbSet,ParseString,srore|"100##PIPE##101##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,SetLOC,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|availablebal|account,  
,Goto,checkRequestType,

SetLOC,ParseString,srore|"200##PIPE##201##KEEP##"|AccTypeID|test,
,If-FALSE-Goto,checkRequestType,

,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_LOC:CREDIT_AVAILABLE_AMOUNT##|availablebal|account,  

checkRequestType,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,AcctDiscLoop,
  
,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,

,Goto,AcctDiscLoop,

Error908,Assign,LogMsg|"Error 908 in",
,AppendVars,LogMsg|##REQUEST##,
,AppendVars,LogMsg|" for Customer ID ",
,AppendVars,LogMsg|customerId,
,AppendVars,LogMsg|" and Institution ID ",
,AppendVars,LogMsg|institutionId,
,AppendVars,LogMsg|" and Partner ID ",
,AppendVars,LogMsg|partnerId,
,Log,ALERT|LogMsg
,StoredHTTPResponse,,
,Exit,908|"Unable to fetch the data. Incorrect summary page was created.",

//***************************************************************************************
GetMyMechanicsLayout,NOP,

,RollDate,##ENDDATE##|##STARTDATE##|YEAR|-5|test,         //  by Default only 2 years statements will be downloaded.

,ConvertDateToText,##STARTDATE##|startDateString|"M/d/yyyy",
,ConvertDateToText,##ENDDATE##|endDateString|"M/d/yyyy",

,MoveToTopOfPage,,

,FindString,">eStatements<"|test,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",
,GetURLv2,PURL,

,FindString,anum|test,

,FindString,">View eStatements<"|test,
,If-TRUE-Goto,jump_To_Rev_A,

,FindString,"View eDocuments"|test,
,If-FALSE-Goto,Error960,

jump_To_Rev_A,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",
,FindReplace,"amp;"|""|URL1|test,
,GetURL,URL1,

,FindString,"Please wait..."|test,
,If-FALSE-Goto,skipThisForm,

,PostURL,||0,


,FindSignature,">Account eStatement Enrollment<",
,If-TRUE-Goto,Error961,



skipThisForm,ExtractFromRawPage,SRVK|"SRVK=##KEEP##""|test,//"

,ExtractFromRawPage,__VIEWSTATE|""__VIEWSTATE["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|""__VIEWSTATEGENERATOR["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,ParseString,srore|"secure.myvirtualbranch.com/fairfieldfederal##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skip_fairfieldfederal,

,CreateForm,"stmtPageForm"|"https://gv-us.computershare.com/CI25/Direct/DocumentHistory.aspx",
,Goto,jump_fairfieldfederal,

skip_fairfieldfederal,CreateForm,"stmtPageForm"|"https://gv-us.computershare.com/CI21/Direct/DocumentHistory.aspx",

jump_fairfieldfederal,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate_PU_PN_MYP_PN_SelVal"|""|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate_PU_PN_SelVal"|"2019##PIPE##5##PIPE##10"|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate_PU_PN_MonthView"|"2019##PIPE##5"|"stmtPageForm",
,SetPostURLData,"__EVENTTARGET"|"FilterSection$ctl24$Action.ApplyFilter"|"stmtPageForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"stmtPageForm",
,SetPostURLData,"currentPageNumber"|"1"|"stmtPageForm",
,SetPostURLData,"RadScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"stmtPageForm",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE|"stmtPageForm",
,SetPostURLData,"DES_JSE"|"1"|"stmtPageForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR|"stmtPageForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"stmtPageForm",
,SetPostURLData,"directMenu_CAMenu_ContextData"|""|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate"|startDateString|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$FromDate_PU_Value"|""|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$ToDate"|endDateString|"stmtPageForm",
,SetPostURLData,"FilterSection$ctl33$ctl00$ToDate_PU_Value"|""|"stmtPageForm",
,SetPostURLData,"SRVK1"|SRVK|"stmtPageForm",
,SetPostURLData,"popupWindowNames"|""|"stmtPageForm",
,SetPostURLData,"disableFocusOnFirstElement"|""|"stmtPageForm",
,PostURL,||"stmtPageForm",

,FindSignature,"Search is complete. There are no results to display",
,If-TRUE-Goto,Error960,

,Assign,pdfIndex|0,

,FindString,"Document Type"|test,
previousSTMT,FindString,"Deposit Statement"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"td"|"REV",
,MoveToTag,"td"|"REV",
,GetDataFromTag,|date1|,
,RemoveHTMLTags,date1,

,FindReplace,"&#47;"|"/"|date1|test,

,MoveToTag,"input"|"REV",
,GetDataFromTag,statURL||"value",

,FindString,">View<",
,MoveToTag,"td"|"REV",
,GetDataFromTag,SRVK||"onclick",
,ParseString,SRVK|"SRVK=##KEEP##&"|SRVK,

,Add,pdfIndex|1,

,Compare,STMT_IDX|pdfIndex,
,If-FALSE-Goto,previousSTMT,

,ParseString,srore|"secure.myvirtualbranch.com/fairfieldfederal##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,skip_fairfieldfederal2,

,Assign,PDF_URl|"https://gv-us.computershare.com/CI25/Content/Document.ashx/False/False/True/True/True/1/",
,Goto,jump_fairfieldfederal2,

skip_fairfieldfederal2,Assign,PDF_URl|"https://gv-us.computershare.com/CI21/Content/Document.ashx/False/False/True/True/True/1/",

jump_fairfieldfederal2,AppendVars,PDF_URl|statURL,
,AppendVars,PDF_URl|"/2/MenuItem.View/_/0/_/False/document_",
,AppendVars,PDF_URl|"20190426",
,AppendVars,PDF_URl|".pdf?SRVK=",
,AppendVars,PDF_URl|SRVK,

,GetURLb,accountStatement|PDF_URl,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//*****************************************************************************************************

//// FI ID 9417
e-creditunionlayout,NOP,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Assign,StmtIndex|0,

,Assign,nxtMonthStmtIndex|0,


,Compare,StmtIndex|account,
,If-TRUE-Goto,logout,

,ReturnToPreviousPage,4,


,Add,StmtIndex|1,
,Assign,PIndex|0,

,FindString,"eStatements", 
,MoveToTag,"a"|"REV",


,GetDataFromTag,sURL||"href",


,GetURLv2,sURL|,

,FindString,"Your eStatements will open",

,GetURLv2,"https://weokie.e-creditunion.org/CSIeStatements.aspx"|,


,GetDataAfterString,documentgroupingid|"documentgroupingid:"|""|test,  //"
,GetDataAfterString,subtype|"subtype:"|""|test,  //"


,SetPostURLData,"Method"|"GetDocumentList",
,SetPostURLData,"DocumentGroupingId"|documentgroupingid,
,SetPostURLData,"SubType"|subtype,
,SetPostURLData,"IsCSR"|"0",
,PostURL,"https://www.myriadsystems.com/estatements/htmlhandler.ashx"||,


nextMonthStmt,GetDataAfterString,DocumentId|"DocumentId":"|""|test,  //"


,Add,nxtMonthStmtIndex|1,

,Compare,nxtMonthStmtIndex|STMT_IDX,
,If-FALSE-Goto,nextMonthStmt,

,Assign,PDFurlll|"https://www.myriadsystems.com/estatements/DownloadHandler.ashx?docid=",

,AppendVars,PDFurlll|DocumentId,


,GetURLb,accountStatement|PDFurlll,

,AttachStatement,accountStatement|".pdf"|StmtIndex,
,Goto,stmtLoop,


//****************

SDCCUBank,NOP,,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTopOfPage,,

,Assign,PIndex|0,
,Assign,CCIndex|0,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-TRUE-Goto,SKIPBELOWChck,

,FindString,"eStatements"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|"REV",
,GetDataFromTag,StmtURL||"href",

,GetURLv2,StmtURL|,

,FindString,">eStatements Enrollment<"|test,
,If-TRUE-Goto,Error961, 

,GetURLv2,"https://ib.sdccu.com/SDCCU/XDIeStatements.aspx"|,
                                                                                                
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|account,
SKIPBELOWChck,CreateForm,"Form1"|"https://xdimemberportal.xdi.com/api/ssoToken",

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,Assign,clientId|"34",

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,SKIP_SetClientID,

,Assign,clientId|"1",
,Assign,userName|userid,

SKIP_SetClientID,SetPostURLData,"grant_type"|"password"|"Form1",
,SetPostURLData,"username"|userName|"Form1",
,SetPostURLData,"client_id"|clientId|"Form1",
,PostURL,||"Form1",
,ExtractFromRawPage,access_token|""access_token":"##KEEP##""|test,

,Assign,Authorization|"bearer ",
,AppendVars,Authorization|access_token,

,SetHeader,"Authorization"|Authorization,
,SetHeader,"Content-Type"|"application/json",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",  

,GetURLv2,"https://xdimemberportal.xdi.com/api/accounts/currentUser/true"|,  

,ExtractFromRawPage,fiid|""fiid":"##KEEP##""|test,

,SetHeader,"Content-Type"|"application/json",
,SetHeader,"Authorization"|Authorization,

,Assign,jObj|"{"accountNumber":"XXX"##COMMA##"fiid":"YYY"}",

,FindReplace,"XXX"|userName|jObj|test,
,FindReplace,"YYY"|fiid|jObj|test,

,JSON-PostData,"https://xdimemberportal.xdi.com/api/document/"|jObj,

,Assign,PDFDOWNLOAD|"https://xdimemberportal.xdi.com/api/document/",
,AppendVars,PDFDOWNLOAD|clientId,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,NextEdocCheck,

,FindString,"documents"|test,
,If-FALSE-Goto,Error960,

,Goto,next_stmtindex,

NextEdocCheck,FindString,"eDocument"|test,
,If-FALSE-Goto,Error960,

next_stmtindex,GetDataAfterString,stmtid|""id["][:]"|""|test,
,If-FALSE-Goto,Error960,

,GetDataAfterString,stmtType|"noticeTypeName":""|" "|test,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-TRUE-Goto,GotoAddIndex,

,Compare,AccTypeID|"200",
,If-FALSE-Goto,skipVISA,

,ParseString,srore|"Visa##KEEP##"|stmtType,
,If-FALSE-Goto,next_stmtindex,
,Goto,GotoAddIndex,

skipVISA,ParseString,srore|"Member Statement##KEEP##"|stmtType,
,If-TRUE-Goto,GotoAddIndex,
  
,ParseString,srore|"Account##KEEP##"|stmtType,
,If-FALSE-Goto,next_stmtindex,

GotoAddIndex,Add,PIndex|1,
,Compare,PIndex|STMT_IDX,
,If-FALSE-Goto,next_stmtindex,

,SetHeader,"Content-Type"|"application/json",
,SetHeader,"Authorization"|Authorization,

,Assign,jObj|"{"id":ZZZ##COMMA##"accountNumber":"XXX"##COMMA##"fiid":"YYY"##COMMA##"ieOrApplication":false}",

,FindReplace,"XXX"|userName|jObj|test,
,FindReplace,"YYY"|fiid|jObj|test,
,FindReplace,"ZZZ"|stmtid|jObj|test,

,Assign,indexURL|"https://xdimemberportal.xdi.com/api/document/",
,AppendVars,indexURL|clientId,

,JSON-PostData,indexURL|jObj,

,ExtractFromRawPage,jObj|"##KEEP##"|test,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",

,SetHeader,"Content-Type"|"application/json",
,SetHeader,"Authorization"|Authorization,
,Assign,indexURL|"https://xdimemberportal.xdi.com/api/document/",
,AppendVars,indexURL|clientId,
,AppendVars,indexURL|"/download",

,JSON-PostData,indexURL|jObj,

,Compare,##TOWER_WEBSITE##|"https://aplfcu.onlinebank.com/SignIn.aspx", 
,If-FALSE-Goto,SkipBelowPost,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"Content-Type"|"application/json",
,SetHeader,"Referer"|"https://xdimemberportal.xdi.com/member-portal/portal/document",
,SetHeader,"Authorization"|Authorization,

,Assign,PdfURL|"https://xdimemberportal.xdi.com/api/document/1/downloadLink/",
,AppendVars,PdfURL|stmtid,

,JSON-GetData,PdfURL|,

,ExtractFromRawPage,sDownloadUrl|""##KEEP##["]"|test,//"
,PostURLb,accountStatement|sDownloadUrl,
,Goto,AttachestmtNw,

SkipBelowPost,GetURLb,accountStatement|##VPAGE##,
AttachestmtNw,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

///////////////////////////////////////////////////Statement FI 11685///////////////////////////////////////////////////////

bossierfcu,Assign,stmtIndex2|0,
                                             
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,GetURL,"/Accounts/eStatements.aspx"||test,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-FALSE-Goto,skipbURL,

,GetURLv2,"https://allsouth.onlinebank.com/CustomInfoImageProviderSSO.aspx"|,

,FindSignature,"CONSENT AGREEMENT",
,If-TRUE-Goto,error961,

,FindSignature,"An unexpected system error occurred",
,If-TRUE-Goto,error102,

skipbURL,NOP,,                                                                 
,FindSignature,">Change Statement Preferences<",
,If-TRUE-Goto,error961,

,FindSignature,"Online Statement and Document Delivery Service Agreement Authorization and Consent",
,If-TRUE-Goto,error961,

,Compare,##TOWER_WEBSITE##|"https://allsouth.onlinebank.com/SignIn.aspx",  // FI ID: 7575
,If-TRUE-Goto,allsouthPDFLayout,

,FindString,"Statement Date"|test,
,If-FALSE-Goto,stmtLoop,

,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",		// FI ID: 11688 
,If-TRUE-Goto,nextStmt_2,
 
,FindString,"Description"|test,
,If-FALSE-Goto,stmtLoop,

nextStmt_2,Compare,##TOWER_WEBSITE##|"https://pfcu.onlinebank.com/SignIn.aspx",		// FI ID: 11688 
,If-TRUE-Goto,nextStmt11668,

,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,
nextStmt11668,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,rawURL||"href",
,ParseString,srore|"Statement##KEEP##"|rawURL,
,If-FALSE-Goto,error960,

,ParseString,eventTarget|"[(][']##KEEP##[']"|rawURL|test,
,FindReplace,"[$]"|":"|eventTarget|test,
 
,Add,stmtIndex2|1,
 
,Compare,stmtIndex2|STMT_IDX,
,If-FALSE-Goto,nextStmt_2,


,ExtractFromRawPage,scriptManager|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"%3b"|";"|scriptManager|test,
,FindReplace,"%2c"|"##COMMA##"|scriptManager|test,
,FindReplace,"%3d"|"="|scriptManager|test,
,FindReplace,"%3a"|":"|scriptManager|test,

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,Assign,eStatementURL|"/Accounts/eStatements.aspx"

,CreateForm,"Form1"|eStatementURL,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"Form1",
,SetPostURLData,"__EVENTTARGET"|eventTarget|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",

,PostURLb,accountStatement|||"Form1",
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//********************************************************************************************************* 


//******************************************************************
//            FI Name: AllSouth FCU - PDF LAYOUT
//******************************************************************

allsouthPDFLayout,NOP,,


NextPDFstat,FindString,"Statement Date"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,
,GetDataFromTag,statURL||"onclick",
,ParseString,StatURLL|"window.open[(][']##KEEP##[']"|statURL,
 
,Add,stmtIndex2|1,
 
,Compare,stmtIndex2|STMT_IDX,
,If-FALSE-Goto,NextPDFstat,


,Assign,PDFURL|"https://estatements.allsouth.org",

,AppendVars,PDFURL|StatURLL,


,GetURLb,accountStatement|PDFURL,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,

//******************************************************************
bfsfcuPDF,NOP,,
,MoveToTopOfPage,,

,Assign,PDFIndex|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,FindString,"View Statements"|test,
,If-FALSE-Goto,error960,

,MoveToTag,"a"|"REV"|test,
,GetDataFromTag,stmtform||"href",
,GetURL,stmtform|,

,FindString,"Document Type"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"select"|test,
,GetDataFromTag,eventTarget||"name",

,ExtractFromRawPage,scriptManager|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"%3b"|";"|scriptManager|test,
,FindReplace,"%2c"|"##COMMA##"|scriptManager|test,
,FindReplace,"%3d"|"="|scriptManager|test,
,FindReplace,"%3a"|":"|scriptManager|test,

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,CreateForm,"Form1"|stmtform,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"Form1",
,SetPostURLData,"__EVENTTARGET"|eventTarget|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",

,Compare,AccTypeID|"200",
,If-FALSE-Goto,MonthlyStmt,

,FindString,"Credit Card"|test,
,If-FALSE-Goto,error960,
,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,optionVal||"value",
,SetPostURLData,eventTarget|optionVal|"Form1",
,PostURL,||"Form1",

,FindString,">Account<"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"select"|test,
,GetDataFromTag,eventTargetAc||"name",

,FindString,aname|test,
,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,acOptionVal||"value",

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,CreateForm,"aspForm"|stmtform,
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"aspForm",
,SetPostURLData,"__EVENTTARGET"|eventTargetAc|"aspForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"aspForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"aspForm",
,SetPostURLData,"__VIEWSTATE"|""|"aspForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspForm",
,SetPostURLData,eventTarget|optionVal|"aspForm",
,SetPostURLData,eventTargetAc|acOptionVal|"aspForm",
,PostURL,||"aspForm",

,Goto,selectStatement,

MonthlyStmt,SetPostURLData,eventTarget|"1"|"Form1",
,PostURL,||"Form1",

selectStatement,FindString,"Select Statement Period"|test,
,If-FALSE-Goto,error960,

NextPDF,MoveToTag,"option"|test,

,Add,PDFIndex|1,
,GetDataFromTag,pdflink||"value",
,FindReplace,"&amp;"|"&"|pdflink|test, 

,Compare,PDFIndex|STMT_IDX,
,If-FALSE-Goto,NextPDF,

,GetURLb,accountStatement|pdflink,
,AttachStatement,accountStatement|".pdf"|stmtIndex,
,Goto,stmtLoop,
//************************************************************************END
NewEmailSection,NOP,,

,FindString,"Email Verification"|test,
,MoveToTag,"div"|test,
,GetDataFromTag,|EmailChoice1|,
,ParseString,srore|"@##KEEP##"|EmailChoice1,

,MoveToTag,"input",

,GetDataFromTag,__EVENTTARGET||"name",
,GetDataFromTag,EmailChoice||"value",

,AddAttendedQuestion,Answer1|EmailChoice,
,AddAnswerChoice,"Email"|EmailChoice1|,
,WaitForAnswers,,

,Compare,Answer1|"",
,If-TRUE-Goto,errorMFA,

,Compare,Answer1|"Email",
,If-FALSE-Goto,errorMFA,

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|__EVENTTARGET,
,SetPostURLData,__EVENTTARGET|"1",
,PostURL,||,

,Assign,EmailOTP|"Please enter the confirmation code that was sent to the email on file.",
,AddAttendedQuestion,Answer2|EmailOTP,
,WaitForAnswers,,

,Compare,Answer2|"",
,If-TRUE-Goto,errorMFA,

,FindString,"Confirmation Code"|test,
,MoveToTag,"input"|test,
,GetDataFromTag,TokenCode||"name",

,MoveToTag,"input"|test,
,GetDataFromTag,btnSubmitToken||"name",

,ExtractFromRawPage,__VIEWSTATEID|""__VIEWSTATEID["] value[=]["]##KEEP##["]"|test, //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test, //"

,SetPostURLData,"__EVENTTARGET"|btnSubmitToken,
,SetPostURLData,btnSubmitToken|"1",
,SetPostURLData,TokenCode|Answer2,
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,PostURL,||,

,FindSignature,"For security reasons##COMMA## we were unable to log you in",
,If-TRUE-Goto,errorMFA,

,Compare,customerId|"1015043009",      // 19 Feb 2021  FIID 7112 DSS-64767
,If-FALSE-Goto,skipStr,
,StoredHTTPResponse,,

skipStr,Goto,SkpThsMFA,
//*******************************NEW LAyout for FIID 5343 First Command Bank*******************************************************

newdisclayout,NOP,

,FindString,">Available Balance<",

nextAccount,MoveToTag,"tr"|test,
,If-FALSE-Goto,newhistory,

,MoveToTag,"td"|test,
,If-FALSE-Goto,newhistory,

,MoveToTag,"a"|test,
,If-FALSE-Goto,newhistory,

,GetDataFromTag,hist_URL|aName|"href",

,RemoveInvalidSpecialCharacter,aName,
,RemoveHTMLTags,aName,
,RemoveExtraWhitespaces,aName,

,FindReplace,"&#39;"|"'"|hist_URL|test,
,FindReplace,"&#39;"|"'"|aName|test,

,ParseString,hist_URLl|"LinkButtonClick[(][']##KEEP##[']"|hist_URL|test,

,ParseString,aNum|"##KEEP##"|aName,

,Compare,aNum|"Send On",     
,If-TRUE-Goto,newhistory,

,MoveToTag,"td",
,GetDataFromTag,|acctype|,

,RemoveInvalidSpecialCharacter,acctype,
,RemoveHTMLTags,acctype,
,RemoveExtraWhitespaces,acctype,

,Compare,acctype|"",
,If-FALSE-Goto,GoAsItIs,

,Assign,acctype|aName|test,

GoAsItIs,MoveToTag,"td",
,GetDataFromTag,|aNumber|,


,Compare,##TOWER_WEBSITE##|"https://firstcommandbank.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,Skip_BelowScrap,

,MoveToTag,"td",
,GetDataFromTag,|aNumber|,

Skip_BelowScrap,RemoveInvalidSpecialCharacter,aNumber,
,RemoveHTMLTags,aNumber,
,RemoveExtraWhitespaces,aNumber,

,CheckAccounts,aNumber||||aName,
,If-FALSE-Goto,nextAccount,


,ParseString,srore|"CHECKING##KEEP##"|acctype,
,If-TRUE-Goto,Set_100,

,ParseString,srore|"Line of Credit##KEEP##"|acctype,
,If-TRUE-Goto,Set_201,

,ParseString,srore|"SAVING##KEEP##"|acctype,
,If-TRUE-Goto,Set_101,

,ParseString,srore|"SHARE##KEEP##"|acctype,
,If-TRUE-Goto,Set_101,

,ParseString,srore|"Money Market##KEEP##"|acctype,
,If-TRUE-Goto,Set_103,

,ParseString,srore|"IRA##KEEP##"|acctype,
,If-TRUE-Goto,Set_304,

,ParseString,srore|"loan##KEEP##"|acctype,
,If-TRUE-Goto,Set_401,

,ParseString,srore|"CREDITCARD##KEEP##"|acctype,
,If-TRUE-Goto,Set_200,

,ParseString,srore|"VISA##KEEP##"|acctype,
,If-TRUE-Goto,Set_200,

,ParseString,srore|"CD##KEEP##"|acctype,
,If-TRUE-Goto,Set_102,

,ParseString,srore|"Heloc##KEEP##"|acctype,
,If-TRUE-Goto,Set_201,

,ParseString,srore|"BROKERAGE##KEEP##"|acctype,
,If-TRUE-Goto,Set_300,

,Compare,##REQUEST##|"DISCOVERY",
,If-FALSE-Goto,Set_100,

,Assign,TypeId|"-1",
,Goto,Scrape_Bal,

Set_401,Assign,TypeId|"401",
,Goto,Scrape_Bal,

Set_200,Assign,TypeId|"200",
,Goto,Scrape_Bal,

Set_304,Assign,TypeId|"304",
,Goto,Scrape_Bal,

Set_201,Assign,TypeId|"201",
,Goto,Scrape_Bal,

Set_100,Assign,TypeId|"100",
,Goto,Scrape_Bal,

Set_101,Assign,TypeId|"101",
,Goto,Scrape_Bal,

Set_102,Assign,TypeId|"102",
,Goto,Scrape_Bal,

Set_103,Assign,TypeId|"103",
,Goto,Scrape_Bal,

Set_300,Assign,TypeId|"300",

Scrape_Bal,NOP


,MoveToTag,"td"|test,
,If-FALSE-Goto,nextAccount,

,GetDataFromTag,|cBal|,
,RemoveHTMLTags,cBal,
,RemoveExtraWhitespaces,cBal,

,MoveToTag,"td",
,GetDataFromTag,|aBal|,
,RemoveHTMLTags,aBal,
,RemoveExtraWhitespaces,aBal,

,ConvertToValidDollar,cBal, 

,ParseString,srore|"200##PIPE##201##PIPE##400##PIPE##401##KEEP##"|TypeId|test,
,If-FALSE-Goto,convertBalance,

,ParseString,srore|"[-]##KEEP##"|cBal|test,
,If-TRUE-Goto,convertBalance,

,Compare,cBal|"0.0"
,If-TRUE-Goto,convertBalance,

,AppendVars,cBal|"-",
,ConvertToValidDollar, cBal,

convertBalance,NOP,

,Add,account|1,

,SetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aName|account,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|aNumber|account,
,SetReturnData,##TABLE TP_ACCOUNT:BALANCE_AMOUNT##|cBal|account,
,SetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|TypeId|account,
,SetReturnData,hist_URL|hist_URLl|account,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##KEEP##"|TypeId|test,
,If-FALSE-Goto,SkipAvailableBal1,

,ConvertToValidDollar,aBal|test,
,SetReturnData,##TABLE TP_ACCOUNT_DETAIL_CS:AVAILABLE_BALANCE_AMOUNT##|aBal|account,  

SkipAvailableBal1,Compare,##REQUEST##|"DISCOVERY", 
,If-FALSE-Goto,nextAccount,

,SetReturnData,##TABLE TP_ACCOUNT:DATA_INDICATOR##|"A"|account,
,SetReturnData,##TABLE TP_ACCOUNT:AGGR_POSITION##|account|account,

,Goto,nextAccount,

newhistory,NOP,


,Compare,##REQUEST##|"DISCOVERY",
,If-TRUE-Goto,logout,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD",
,If-TRUE-Goto,STATEMENT_DOWNLOAD,

,Assign,txnIndex|0,
,Assign,hIndex|0,

NextHisAccount,Compare,hIndex|account,
,If-TRUE-Goto,logout,

,Add,hIndex|1,

,GetReturnData,hist_URL|hist_URL|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|TypeId|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aName|hIndex,
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|aNumber|hIndex,

,GetURL,"https://firstcommandbank.onlinebank.com/Accounts/AccountActivity.aspx",

,FindString,"Account History:"|test,

,Right$,tempAcNum|aNumber|4|test,
,FindString,tempAcNum|test,
,If-TRUE-Goto,optionTag2, 

,FindString,aName|test,
,If-TRUE-Goto,optionTag2, 

,Assign,tempAccNameVar|aName,

,FindReplace,"[&]"|"&amp;"|tempAccNameVar|test, 

,FindString,tempAccNameVar|test,

optionTag2,MoveToTag,"option"|"REV"|test,
,GetDataFromTag,acctValue||"value",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,  //"
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM|test,

,ConvertDateToText,##STARTDATE##|sdate|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|edate|"MM/dd/yyyy",



,CreateForm,"Form1"|"./AccountActivity.aspx",                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form1",
,SetPostURLData,"__EVENTTARGET"|""|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE5$ctl00$AccountNickName"|aName|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$selectedAccount"|acctValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calFromDate$TB"|sdate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calToDate$TB"|edate|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$endAmount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$search"|"1"|"Form1",
,PostURL,||"Form1",

,CreateForm,"Form2"|"./AccountActivity.aspx",                                             
,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM|"Form2",
,SetPostURLData,"__EVENTTARGET"|"M:layout:content:PCDZ:M3SN6LC:ctl00:DownloadOptions:ctl00:Download"|"Form2",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form2",
,SetPostURLData,"__VIEWSTATE"|""|"Form2",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"Form2",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE5$ctl00$AccountNickName"|aName|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$selectedAccount"|acctValue|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$ClearedDateChoices"|"-2"|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calFromDate$TB"|sdate|"Form2",		// sdate
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$calToDate$TB"|edate|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$transactionTypes"|"none_selected"|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$description"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$checkNumber"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$amount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$M3SN6LC$ctl00$endAmount"|""|"Form2",
,PostURL,||"Form2",

,FindSignature,""Description"",		//"
,If-TRUE-Goto,skipError417,

,Assign,transactionsDataSource|""CSV"",
,SetReturnData,##TABLE TRANSACTION_SOURCE:##|transactionsDataSource|hIndex|hIndex,
,Log,ALERT|""Aggregation layout 5 : Customer ID : ""|customerId|"" Partner ID :""|partnerId,

,Assign,temp_date|sdate,
,AppendVars,temp_date|" & ",
,AppendVars,temp_date|edate,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|hIndex|,

,Assign,CSV417TrxnLog|"Log for error 417 in CSV ",
,AppendVars,CSV417TrxnLog|##REQUEST##,
,AppendVars,CSV417TrxnLog|" from date:- ",
,AppendVars,CSV417TrxnLog|temp_date,
,AppendVars,CSV417TrxnLog|" of FIID ",
,AppendVars,CSV417TrxnLog|institutionId,
,AppendVars,CSV417TrxnLog|" CustomerID :- ",
,AppendVars,CSV417TrxnLog|customerId,
,Log,ALERT|CSV417TrxnLog|,
,Goto,NextHisAccount,

skipError417,NOP,,

,CSV-GetReader,reader|##VPAGE##|count,
nextCSV,CSV-GetRecord,record|reader|test,        
,If-FALSE-Goto,NextHisAccount,

,CSV-GetHeaderPosition,datePosition|"Date"|reader|test,
,If-FALSE-Goto,NextHisAccount,

,CompareNumbers,datePosition|count|>=,
,If-TRUE-Goto,NextHisAccount,

,CSV-GetHeaderPosition,DescriptionPosition|"Description"|reader,
,If-FALSE-Goto,NextHisAccount,

,CompareNumbers,DescriptionPosition|count|>=,
,If-TRUE-Goto,NextHisAccount,

,CSV-GetHeaderPosition,CheckNumPosition|"Check Number"|reader,
,If-FALSE-Goto,NextHisAccount,

,CompareNumbers,CheckNumPosition|count|>=,
,If-TRUE-Goto,NextHisAccount,

,CSV-GetHeaderPosition,CheckAmountPosition|"Amount"|reader,
,If-FALSE-Goto,NextHisAccount,

,CompareNumbers,CheckAmountPosition|count|>=,
,If-TRUE-Goto,NextHisAccount,

,CSV-GetValue,aDate|record|datePosition|test,
,ConvertToValidDate,aDate|test,

,CSV-GetValue,aDescription|record|DescriptionPosition|test,
,CSV-GetValue,checknumber|record|CheckNumPosition|test,
,AppendVars,aDescription|checknumber,

,CSV-GetValue,txnbal|record|CheckAmountPosition|test,

,ConvertToValidDollar,txnbal,

,Add,txnIndex|1,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|aDate|hIndex|txnIndex,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|aDescription|hIndex|txnIndex,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|txnbal|hIndex|txnIndex,
,Goto,nextCSV,

//**********************************************************************************************************//

lblACH2Layout,NOP,,

Next_ACH,Compare,ACHIndex|account,
,If-TRUE-Goto,lblContinueSingleSession,
,Assign,Rolldate|"True",
,Add,ACHIndex|1,
,Assign,FIAccNumWeb|"F",

,FindSignature,"Disclosure View",
,If-TRUE-Goto,Next_ACH,
 
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|anum|ACHIndex,
,GetReturnData,##TABLE TP_ACCOUNT:TP_ACCOUNT_TYPE_ID##|AccTypeID|ACHIndex,
,GetReturnData,##TABLE TP_ACCOUNT:AGGR_ACCOUNT_NICKNAME##|aname|ACHIndex,

,Compare,MaskNumber_discovery|"T",
,If-FALSE-Goto,SkipThisFI,

,Assign,FIAccNumWeb|"T",


,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|ACHIndex,   

,ParseString,AfterCol|"##KEEP##[-]##PIPE##[:]##PIPE##[A-Z]"|MaskedAccNumber,
,If-FALSE-Goto,CheckSession,

,ParseString,AfterCol_2|"[-]##PIPE##[:]##PIPE##[A-Z]##KEEP##"|MaskedAccNumber,
,If-FALSE-Goto,CheckSession,

,GetLength,count|AfterCol,
,GetLength,count_2|AfterCol_2,


,CompareNumbers,count|4|>=,
,If-FALSE-Goto,ChnagFlag,

,CompareNumbers,count_2|2|>=,
,If-FALSE-Goto,ChnagFlag,

CheckSession,Compare,##SINGLE_SESSION_STATE##|"",
,If-TRUE-Goto,Next_ACH,

,Goto,SkipThisFI,

ChnagFlag,Assign,FIAccNumWeb|"F",


SkipThisFI,Compare,##SINGLE_SESSION_STATE##|"",
,If-TRUE-Goto,skipAccountTypeCheck,

,ParseString,srore|"100##PIPE##101##PIPE##102##PIPE##103##PIPE##401##KEEP##"|AccTypeID,
,If-FALSE-Goto,Next_ACH,

skipAccountTypeCheck,Compare,institutionId|"100368",
,If-TRUE-Goto,TransfersAccountNumberInformationACH,

,Compare,institutionId|"4399",
,If-TRUE-Goto,skpPrevPage,

,Compare,accountIDFlag|"FALSE",
,If-TRUE-Goto,singleSession2,

,GetReturnData,accountID|accountID|ACHIndex,
,GetReturnData,sURL1|sURL1|ACHIndex,

,GetURLv2,sURL1||test,
,If-FALSE-Goto,Next_ACH,

,FindString,"accountID":"|test,	//"
,If-FALSE-Goto,singleSession2,

,FindString,accountID|test,
,If-FALSE-Goto,Next_ACH,

,FindString,""achAccountNumber""|test,
,If-FALSE-Goto,Next_ACH,

,GetDataAfterString,achAccountNumber|":""|" "|test,	//"
,If-FALSE-Goto,Next_ACH,

,ExtractFromRawPage,RoutingNumber|"Routing Number: ##KEEP##&"|test,

,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,ParseString,srore|"[a-z][A-Z]##KEEP##"|RoutingNumber,
,If-FALSE-Goto,SkipRoutingNumber,

,ExtractFromRawPage,RoutingNumber|"Routing Number: ##KEEP##<"|test,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

SkipRoutingNumber,Log,ALERT|"ACH Single Session layout 1",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Goto,lblACH2Layout,

singleSession2,NOP,,

,MoveToTopOfPage,,

,GetDataAfterString,RoutingNumber|"routingNumber":""|" "|test, 		//"
,If-FALSE-Goto,getNum,

,Compare,institutionId|"7112",
,If-FALSE-Goto,IgnoreBelow,

,GetDataAfterString,achAccountNumber|"accountNumber":""|" "|test, 	//"
,If-FALSE-Goto,QFXACH,

,Goto,skipQFXString,

IgnoreBelow,FindString,anum|test,
,If-FALSE-Goto,QFXACH,

,GetDataAfterString,achAccountNumber|"CustomUnMaskedAccountNumber":""|" "|test, 	//"
,If-TRUE-Goto,skipQFXString,

,GetDataAfterString,achAccountNumber|"ofxAccountId":""|" -_"|test, 	//"
,If-FALSE-Goto,Next_ACH2,  
  
,ParseString,srore|"_##KEEP##-"|achAccountNumber,
,If-FALSE-Goto,skipQFXString,

,FindReplace,"_"|""|achAccountNumber|test,
,FindReplace,"-"|""|achAccountNumber|test,
  
skipQFXString,NOP,,
,Log,ALERT|"ACH Single Session layout 2",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Goto,lblACH2Layout,

getNum,NOP,,
,ParseString,srore|"x##KEEP##-"|anum,
,If-TRUE-Goto,QFXACH,

,ParseString,srore|"-##KEEP##"|anum,
,If-FALSE-Goto,Next_ACH2,

,FindReplace,"-"|""|anum|test,
,Assign,achAccountNumber|anum,

,FindString,"Routing Number"|test,
,If-TRUE-Goto,Next_RoutingScrap,

,GetFromLocalTable,RoutingNumber|bank_ID|institutionId|test,
,If-TRUE-Goto,GetACHData,
,Goto,Next_ACH,

Next_RoutingScrap,GetDataAfterString,RoutingNumber|":"|" "|test,
,If-FALSE-Goto,Next_ACH,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

GetACHData,Log,ALERT|"ACH Single Session layout 3",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Goto,lblACH2Layout,

Next_ACH2,NOP,,

,Compare,sURL1Flag|"TRUE",
,If-TRUE-Goto,Next_ACH3,

,ParseString,SURL1|"##KEEP##SignIn.aspx"|##TOWER_WEBSITE##,
,AppendVars,SURL1|"Accounts/AccountActivity.aspx",
,GetURL,SURL1||test,
,If-FALSE-Goto,Next_ACH,

,Compare,institutionId|"13631",
,If-TRUE-Goto,lblWebScarppingACH,

,FindString,"Account Activity:"|test,
,If-FALSE-Goto,getACHlayout,
,FindString,anum|test,
,If-FALSE-Goto,getACHlayout,
,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,getACHlayout,
,GetDataFromTag,acctBalValue||"value",
,ExtractFromRawPage,actValue1|"<SELECT name="##KEEP##" id="|test, //"
,ParseString,actValue|"[$]PCDZ[$]##KEEP##[$]ctl00[$]"|actValue1,
,ExtractFromRawPage,M_layout_content_ScriptManager_TSM1|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"[%]3b"|";"|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]2c[+]"|"##COMMA## "|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]3a"|":"|M_layout_content_ScriptManager_TSM1|test,
,FindReplace,"[%]3d"|"="|M_layout_content_ScriptManager_TSM1|test,
                                       
,ExtractFromRawPage,__VIEWSTATEID1|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__VIEWSTATEID1|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION1|"__EVENTVALIDATION" value="##KEEP##""|test,//"
,CreateForm,"balanceForm"|"https://oceanbank.onlinebank.com/Accounts/AccountActivity.aspx",
,Assign,AccountNickName|"M$layout$content$PCDZ$XXXXXX$ctl00$AccountNickName",
,Assign,selectedAccount|"M$layout$content$PCDZ$XXXXXX$ctl00$selectedAccount",
,Assign,ClearedDateChoices|"M$layout$content$PCDZ$XXXXXX$ctl00$ClearedDateChoices",
,Assign,calFromDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calFromDate$TB",
,Assign,calToDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calToDate$TB",
,Assign,transactionTypes|"M$layout$content$PCDZ$XXXXXX$ctl00$transactionTypes",
,Assign,description|"M$layout$content$PCDZ$XXXXXX$ctl00$description",
,Assign,checkNumber|"M$layout$content$PCDZ$XXXXXX$ctl00$checkNumber",
,Assign,amount|"M$layout$content$PCDZ$XXXXXX$ctl00$amount",
,Assign,endAmount|"M$layout$content$PCDZ$XXXXXX$ctl00$endAmount",
,Assign,search|"M$layout$content$PCDZ$XXXXXX$ctl00$search",


,FindReplace,"XXXXXX"|actValue|AccountNickName|test,
,FindReplace,"XXXXXX"|actValue|selectedAccount|test,
,FindReplace,"XXXXXX"|actValue|ClearedDateChoices|test,
,FindReplace,"XXXXXX"|actValue|calFromDate|test,
,FindReplace,"XXXXXX"|actValue|calToDate|test,
,FindReplace,"XXXXXX"|actValue|transactionTypes|test,
,FindReplace,"XXXXXX"|actValue|description|test,
,FindReplace,"XXXXXX"|actValue|checkNumber|test,
,FindReplace,"XXXXXX"|actValue|amount|test,
,FindReplace,"XXXXXX"|actValue|endAmount|test,
,FindReplace,"XXXXXX"|actValue|search|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|M_layout_content_ScriptManager_TSM1|"balanceForm",
,SetPostURLData,"__EVENTTARGET"|search|"balanceForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"balanceForm",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"balanceForm",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID1|"balanceForm",
,SetPostURLData,"__VIEWSTATE"|""|"balanceForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION1|"balanceForm",	
,SetPostURLData,AccountNickName|aname|"balanceForm",
,SetPostURLData,selectedAccount|acctBalValue|"balanceForm",
,SetPostURLData,ClearedDateChoices|"60"|"balanceForm",
,SetPostURLData,calFromDate|""|"balanceForm",
,SetPostURLData,calToDate|""|"balanceForm",
,SetPostURLData,transactionTypes|"none_selected"|"balanceForm",
,SetPostURLData,description|""|"balanceForm",
,SetPostURLData,checkNumber|""|"balanceForm",
,SetPostURLData,amount|""|"balanceForm",
,SetPostURLData,endAmount|""|"balanceForm",
,SetPostURLData,search|"1"|"balanceForm",
,PostURL,"https://allsouth.onlinebank.com/Accounts/AccountActivity.aspx"||"balanceForm",

,FindString,"Account Number:"|test,
,If-FALSE-Goto,getACHlayout,

,MoveToTag,"td"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,|achAccountNumber|,

,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,FindString,"Routing #"|test,
,If-FALSE-Goto,getACHlayout,

,GetDataAfterString,RoutingNumber|":"|" "|test,
,If-FALSE-Goto,getACHlayout,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,
,ReturnToPreviousPage,2,
,Goto,storeData,

getACHlayout,NOP,,                                       
,FindString,"Account History:"|test,
,If-FALSE-Goto,Next_ACH3,

,ParseString,numClear|"x##KEEP##"|anum,

,FindString,numClear|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,|achAccountNumber|,
,ParseString,achAccountNumber|"##KEEP##-"|achAccountNumber,
,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,Compare,institutionId|"5067",
,If-FALSE-Goto,SkipRoutingnumber,

,ExtractFromRawPage,RoutingNumber|"Routing Number: ##KEEP##</td>"|test,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,Goto,QFXACH,

SkipRoutingnumber,FindString,"Routing Number"|test,
,If-FALSE-Goto,QFXACH,

,Compare,institutionId|"100394",
,If-TRUE-Goto,ScrapRoutingNum,

,Compare,institutionId|"9751",
,If-FALSE-Goto,SkipRoutingNum,

ScrapRoutingNum,GetDataAfterString,RoutingNumber|":"|" "|test,
,Goto,storeData,

SkipRoutingNum,NOP,,

,MoveToTag,"div"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,|RoutingNumber|,
,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,Log,ALERT|"ACH Single Session layout 4",

storeData,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Goto,lblACH2Layout,

Next_ACH3,NOP,,

,Compare,institutionId|"5420",
,If-FALSE-Goto,getNewURL2,

,GetReturnData,sURL|sURL|ACHIndex,
,Assign,sURL1|sURL,  

,Goto,skipGetNewURL2,  
  
getNewURL2,GetReturnData,sURL1|sURL1|ACHIndex,

skipGetNewURL2,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,
,If-FALSE-Goto,Next_ACH4,

,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION" value="##KEEP##""|test,

,FindReplace,"[$]"|":"|sURL1|test,

,CreateForm,"Form2"|"/AccountsSummary.aspx",
,SetPostURLData,"__EVENTTARGET"|sURL1|"Form2",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form2",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form2",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstSourceAccount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstDestinationAccount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstAmountOption"|"0"|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$txtAmount"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption0"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption1"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption2"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption3"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$grpAmountOptions$txtAmountOption4"|""|"Form2",
,SetPostURLData,"M$layout$content$PCDZ$MSFXYQV$ctl00$ctl00$webInputForm$grpEditor$lstContributionYear"|"Current"|"Form2",

,PostURLr,""||"Form2"|"/Accounts/AccountActivity.aspx"|test, 
,If-FALSE-Goto,Next_ACH,

,FindString,">Show full Account number<"|test,
,If-TRUE-Goto,getFullNumber,

,FindString,"> Full Account<"|test,
,If-FALSE-Goto,Next_ACH4,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,QFXACH,

,GetDataFromTag,formType||"onclick",

,Compare,institutionId|"11142",
,If-FALSE-Goto,SkipFullaccountNumber,

,ParseString,AccounID|"[(][']##KEEP##[']"|formType,
,Assign,URL|"https://neighborsfcu.onlinebank.com/api/FullPartialAccount?accountId=",
,AppendVars,URL|AccounID,

,GetURLv2,URL||test,
,If-FALSE-Goto,lblACH2Layout,

,ExtractFromRawPage,achAccountNumber|"[>]##KEEP##[<]"|test,
,ReturnToPreviousPage,1,
,Goto,getachNo,

SkipFullaccountNumber,ParseString,achAccountNumber|"_##KEEP##['][)]"|formType,
,ParseString,achAccountNumber|"_##KEEP##"|achAccountNumber,
,Goto,getRoutingNo,

getFullNumber,MoveToTag,"div"|"REV"|test,
,If-FALSE-Goto,QFXACH,

,GetDataFromTag,|achAccountNumber|,
getachNo,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

getRoutingNo,ExtractFromRawPage,RoutingNumber|"Routing Number: ##KEEP##&"|test,
,If-FALSE-Goto,Next_ACH,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,Log,ALERT|"ACH Single Session layout 5",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,
,ReturnToPreviousPage,,

,Goto,lblACH2Layout,

Next_ACH4,NOP,,

,ReturnToPreviousPage,,

,FindString,anum|test,
,If-FALSE-Goto,QFXACH,

,GetDataAfterString,achAccountNumber|"ofxAccountId":""|" -_"|test, 	//"
,If-FALSE-Goto,Next_ACH5,  
  
,Log,ALERT|"ACH Single Session layout 6",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNum|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Goto,lblACH2Layout,

lblWebScarppingACH,FindString,"Account History:"|test,
,If-FALSE-Goto,Next_ACH5,
,FindString,anum|test,
,If-FALSE-Goto,Next_ACH5,
,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,Next_ACH5,
,GetDataFromTag,acctBalValue||"value",

,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID" value="##KEEP##""|test,//"
,ExtractFromRawPage,EVENTVALIDATION|"EVENTVALIDATION" value="##KEEP##""|test,//"

,CreateForm,"Form1"|"https://secure.myvirtualbranch.com/essexsavingsbank2627/Accounts/AccountActivity.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:d28568d3-e53e-4706-928f-3765912b66ca:ea597d4b:b25378d2"|"Form1",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M2SN6LC$ctl00$search"|"Form1",
,SetPostURLData,"__EVENTARGUMENT"|""|"Form1",
,SetPostURLData,"UsePrinterFriendlyVersion"|"Off"|"Form1",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"Form1",
,SetPostURLData,"__VIEWSTATE"|""|"Form1",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$MKLLCE4$ctl00$AccountNickName"|aname|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$selectedAccount"|acctBalValue|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$ClearedDateChoices"|"30"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calFromDate$TB"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$calToDate$TB"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$transactionTypes"|"none_selected"|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$description"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$checkNumber"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$amount"|""|"Form1",
,SetPostURLData,"M$layout$content$PCDZ$M2SN6LC$ctl00$endAmount"|""|"Form1",
,SetPostURLData,"MM$layout$content$PCDZ$M2SN6LC$ctl00$search"|"1"|"Form1",	

,PostURL,||"Form1",

Next_ACH5,NOP,

,FindString,"accountNumberModel()"|test,
,If-FALSE-Goto,QFXACH,

,GetDataAfterString,achAccountNumber|"fullAccountNumber = ""|" "|test,	//"
,If-FALSE-Goto,Next_ACH,

,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,ExtractFromRawPage,RoutingNumber|"Routing Number:##KEEP##</td>"|test,
,If-FALSE-Goto,Next_ACH,

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,Log,ALERT|"ACH Single Session layout 7",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,
,ReturnToPreviousPage,,

,Goto,lblACH2Layout,

QFXACH,NOP,,

,Compare,sURL1Flag|"TRUE",
,If-FALSE-Goto,skpPrevPage,

,FindString,"Download Transactions"|test,
,If-FALSE-Goto,skpPrevPage,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,OFXURL||"href",
,GetURL,OFXURL||test,
,If-FALSE-Goto,Next_ACH,

,Goto,goSelect,

skpPrevPage,ParseString,OFXURL|"##KEEP##/SignIn.aspx"|##TOWER_WEBSITE##,

,Compare,institutionId|"4399",
,If-FALSE-Goto,AppendAccounts,

,AppendVars,OFXURL|"/WebConnect.aspx",
,Goto,GetURLOFXURL,

AppendAccounts,AppendVars,OFXURL|"/Accounts/WebConnect.aspx",
GetURLOFXURL,GetURL,OFXURL||test,
,If-FALSE-Goto,Next_ACH,

,FindReplace,"&"|"&amp;"|anum|test,
,FindReplace,"'"|"&#39;"|anum|test,

,FindString,anum|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,ACCNTVALUE||"value",
,Compare,institutionId|"5067",
,If-FALSE-Goto,Rolldatelogic,

,Assign,TestACHNumber|ACCNTVALUE,

,StrRev,TestACHNumber,
,ParseString,achAccountNumber|"##KEEP##_"|TestACHNumber,
,StrRev,achAccountNumber,
,Goto,lblachNumber,

Rolldatelogic,RollDate,##ENDDATE##|##STARTDATE##|DAY|-30|test,
,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##ENDDATE##|ENDDATE|"MM/dd/yyyy",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

RolldateApplied,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:509f92a1-e5fd-464f-a450-13846a6c973b:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2011.1.315.35##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:e4ca4719-c559-4761-8501-9be20bbda1fe:16e4e7cd:f7645509:ed16cbdc",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$accountDropDown"|ACCNTVALUE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calStartDate$TB"|STRTDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$calEndDate$TB"|ENDDATE,
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$lstDownloadFormat"|"QFX",
,SetPostURLData,"M$layout$content$PCDZ$M70CWMM$ctl00$webInputForm$btnDownload"|"Download",

,PostURL,OFXURL|||test, 
,If-FALSE-Goto,Next_ACH,

,FindSignature,"OFXHEADER",
,If-TRUE-Goto,GetAchDetail,

,ParseString,srore|"7414##PIPE##4399##KEEP##"|institutionId,
,If-TRUE-Goto,Rolldate60days,

goSelect,FindString,"Select the account"|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"select"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,VALUE||"id",

,ParseString,VALUE1|"M_layout_content_PCDZ_##KEEP##_ctl00_accountDropDown"|VALUE,
,Right$,anum|anum|7|test,

,FindString,anum|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,ACCNTVALUE||"value",

,RollDate,##NOW##|tempdate|DAY|-90|test,

,ConvertDateToText,tempdate|STRTDATE|"MM/dd/yyyy",
,ConvertDateToText,##NOW##|ENDDATE|"MM/dd/yyyy",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,    //"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value[=]["]##KEEP##["]"|test,    //"

,Assign,accountDropDown|"M$layout$content$PCDZ$XXXXXX$ctl00$accountDropDown",
,Assign,rblStockDateRanges|"M$layout$content$PCDZ$XXXXXX$ctl00$rblStockDateRanges",
,Assign,StartDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calStartDate$TB",
,Assign,EndDate|"M$layout$content$PCDZ$XXXXXX$ctl00$calEndDate$TB",
,Assign,quickenWebConnectButton|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.x",
,Assign,quickenWebConnectButton1|"M$layout$content$PCDZ$XXXXXX$ctl00$quickenWebConnectButton.y",

,FindReplace,"XXXXXX"|VALUE1|accountDropDown|test,
,FindReplace,"XXXXXX"|VALUE1|rblStockDateRanges|test,
,FindReplace,"XXXXXX"|VALUE1|StartDate|test,
,FindReplace,"XXXXXX"|VALUE1|EndDate|test,
,FindReplace,"XXXXXX"|VALUE1|quickenWebConnectButton|test,
,FindReplace,"XXXXXX"|VALUE1|quickenWebConnectButton1|test,

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|";;System.Web.Extensions##COMMA## Version=4.0.0.0##COMMA## Culture=neutral##COMMA## PublicKeyToken=31bf3856ad364e35:en:ba042b74-ece8-499a-8da9-ecf37f7b3e32:ea597d4b:b25378d2;Telerik.Web.UI##COMMA## Version=2014.2.618.40##COMMA## Culture=neutral##COMMA## PublicKeyToken=121fae78165ba3d4:en:15590aec-52e9-4282-8ed4-e91eae292c7b:16e4e7cd:f7645509:ed16cbdc:88144a7a",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID,
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION,
,SetPostURLData,accountDropDown|ACCNTVALUE,
,SetPostURLData,rblStockDateRanges|"-2",
,SetPostURLData,StartDate|STRTDATE,
,SetPostURLData,EndDate|ENDDATE,
,SetPostURLData,quickenWebConnectButton|"0",
,SetPostURLData,quickenWebConnectButton1|"0",

,PostURL,OFXURL|||test, 
,If-FALSE-Goto,Next_ACH,


GetAchDetail,NOP,

,FindSignature,"No transactions found for specified date",
,If-FALSE-Goto,getACH,

,ReturnToPreviousPage,2,
,Goto,Next_ACH,

getACH,ExtractFromRawPage,achAccountNumber|"<ACCTID>##KEEP##<"|test,
,ExtractFromRawPage,RoutingNumber|"<BANKID>##KEEP##<"|test,


,ParseString, accnumber|"-##KEEP##-"|achAccountNumber|test,
,If-FALSE-Goto,lblachNumber,

,Assign,achAccountNumber|accnumber,

lblachNumber,RemoveHTMLTags,achAccountNumber,
,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,RoutingNumber,
,RemoveExtraWhitespaces,RoutingNumber,
  
,Log,ALERT|"ACH Single Session layout 8",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,

,Compare,FIAccNumWeb|"F",
,If-FALSE-Goto,lblACH2Layout,


,ParseString,MaskedAccNumber|"_##KEEP##_"|achAccountNumber|test,
,If-TRUE-Goto,Alter_maskNumber,

,Right$,MaskedAccNumber|achAccountNumber|8|test,

Alter_maskNumber,Right$,MaskedAccNumber|MaskedAccNumber|8|test,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_MASKED##|MaskedAccNumber|ACHIndex, 
,Goto,lblACH2Layout,

TransfersAccountNumberInformationACH,NOP,,

,Compare,PageHit1stTime|"True",
,If-FALSE-Goto,SkipPage,

,Assign,TOWERWEBSITEcheck|##TOWER_WEBSITE##,

,ParseString,TOWER|"##KEEP##SignIn.aspx"|TOWERWEBSITEcheck,

,AppendVars,TOWER|"TransfersAccountNumberInformation.aspx",

,GetURLv2,TOWER||test,
,If-FALSE-Goto,Next_ACH,

SkipPage,MoveToTopOfPage,,

,Assign,PageHit1stTime|"False",

,FindString,">Account<"|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"select"|test,
,If-FALSE-Goto,Next_ACH,

,FindString,aname|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"option"|"REV"|test,
,If-FALSE-Goto,Next_ACH,

,GetDataFromTag,achAccountNumber||"value",

,RemoveExtraWhitespaces,achAccountNumber,
,RemoveHTMLTags,achAccountNumber,

,Compare,achAccountNumber|"",
,If-TRUE-Goto,Next_ACH,

,FindString,">Routing Number<"|test,
,If-FALSE-Goto,Next_ACH,

,MoveToTag,"INPUT"|test,
,If-FALSE-Goto,Next_ACH,
,GetDataFromTag,RoutingNumber||"value",

,RemoveExtraWhitespaces,RoutingNumber,
,RemoveHTMLTags,RoutingNumber,

,Log,ALERT|"ACH Single Session layout 9",

,SetReturnData,##TABLE TP_ACCOUNT:BANK_ID##|RoutingNumber|ACHIndex,
,SetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER_REAL##|achAccountNumber|ACHIndex,
,Goto,lblACH2Layout,

Rolldate60days,Compare,Rolldate|"True",
,If-FALSE-Goto,Next_ACH,
,Assign,ENDDATE|STRTDATE,

,RollDate,##NOW##|##STARTDATE##|DAY|-90|test,

,ConvertDateToText,##STARTDATE##|STRTDATE|"MM/dd/yyyy",
,Assign,Rolldate|"False",
,Goto,RolldateApplied,


//*****************************************************
//  NEW STATEMENT LAYOUT FIID:6671
//*****************************************************

NewPDFFloridaLayout,Assign,STMT_IDXCHK|0,
,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,MoveToTopOfPage,,

,ParseString,srore|"2194##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,SetDefaultDomain,

,Assign,DomainURL|"https://edocs.hepsiian.com:443/cv",
,Goto,SkipDefault,

SetDefaultDomain,ParseString,srore|"seattlecu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,SetDefaultDomain1,

,Goto,ebankDomain,

SetDefaultDomain1,ParseString,srore|"neighborsfcu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,SetDefaultDomain2,


ebankDomain,Assign,DomainURL|"https://ebank.hepsiian.com/cv",
,Goto,SkipDefault,

SetDefaultDomain2,Assign,DomainURL|"https://estatements1.hepsiian.com/sigcv",

SkipDefault,FindString,"E-Statements"|test,
,If-TRUE-Goto,ThisstmtLoop,

,FindString,"eStatements"|test,
,If-TRUE-Goto,ThisstmtLoop,

,FindString,">Statements & Notices<"|test,
,If-TRUE-Goto,ThisstmtLoop,

,FindString,">Statements<"|test,
,If-TRUE-Goto,ThisstmtLoop,

,FindString,"eDocuments"|test,
,If-FALSE-Goto,ThisstmtLoop,

ThisstmtLoop,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,PURL||"href",

,GetURLv2,PURL,

,Compare,##TOWER_WEBSITE##|"https://valleystar.onlinebank.com/SignIn.aspx",
,If-FALSE-Goto,skipThisExtract,

,ExtractFromRawPage,ssoUrl|"window.open[(]["]##KEEP##["]"|test,
,GetURL,ssoUrl|,

,Goto,wecuBank,

skipThisExtract,FindSignature,"E-Sign Disclosure and Consent<",
,If-TRUE-Goto,Error961,

,FindSignature,"You are not entitled to use any profile with E-Statements",
,If-TRUE-Goto,Error961,
  
,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatements require an email address",
,If-TRUE-Goto,Error961,

,FindSignature,"Once you click on the Enroll button##COMMA## you will be enrolled in eDelivery",
,If-TRUE-Goto,Error961,

//*****************************************************

,ParseString,srore|"/online.apgfcu.com##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,Tower_apgfcu,

,Compare,##TOWER_WEBSITE##|"https://seattlecu.onlinebank.com/SignIn.aspx",
,If-TRUE-Goto,GoForCSRF,

,Compare,institutionId|"7882",
,If-TRUE-Goto,GoForCSRF,

,ParseString,srore|"fsb##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,CheckNextTowerData,

,Goto,GoforToken,

CheckNextTowerData,ParseString,srore|"neighborsfcu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,GoForOldToken,

GoforToken,ExtractFromRawPage,TOKEN|"PROD&token[=]##KEEP##[']"|test,  //"
,Goto,GoForParse,

GoForOldToken,ExtractFromRawPage,TOKEN|"PROD&token[=]##KEEP##["]"|test,  //"


GoForParse,ParseString,srore|"neighborsfcu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,NextPDFCheck1,

,Assign,PDFURLL|"https://ebank.hepsiian.com/cv/sso?neighborsarchitect-PROD&token=",
,Goto,JumpForAppend,

NextPDFCheck1,ParseString,srore|"sigcv##KEEP##"|DomainURL,
,If-FALSE-Goto,NextPDFCheck,

,Assign,PDFURLL|"https://estatements1.hepsiian.com/sigcv/sso?target=external&firststatebank-PROD&token=",
,Goto,JumpForAppend,

NextPDFCheck,ParseString,srore|"443##KEEP##"|DomainURL,

,Assign,PDFURLL|"https://edocs.hepsiian.com:443/cv/sso?nasb-PROD&token=",
JumpForAppend,AppendVars,PDFURLL|TOKEN,

,GetURL,PDFURLL|,

GoForCSRF,FindSignature,"Online Statement Enrollment - Agreement",
,If-TRUE-Goto,Error961,

,FindSignature,"E-Statements Enrollment",
,If-TRUE-Goto,Error961,

,MoveToTopOfPage,,

,ExtractFromRawPage,CSRF_NONCE|"[']org.apache.catalina.filters.CSRF_NONCE[']:[']##KEEP##[']"|test,//"
,ExtractFromRawPage,viewstate|"["]j_id1:javax.faces.ViewState[:]0["] value=["]##KEEP##["]"|test, //"

//.......................................

,ParseString,srore|"neighborsfcu##KEEP##"|##TOWER_WEBSITE##,
,If-FALSE-Goto,Numscore,

,Assign,PDFPAGE|"https://ebank.hepsiian.com/cv/searchResults.jsf?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

,GetURLr,PDFPAGE||##URL##, 

,ExtractFromRawPage,srkey|"Member Statements - ##KEEP##(\s)",


,ExtractFromRawPage,ViewState|"j_id1:javax.faces.ViewState:0["] value=["]##KEEP##["]"|test, //"

,FindString,"Member Statements"|test,
,If-FALSE-Goto,logout,

,FindString,"View Statement"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"a"|"REV",
,GetDataFromTag,eventName||"name",
,Assign,execute|eventName,
,AppendVars,execute|" @component",
,ParseString,CSRF_NONCE|"CSRF_NONCE=##KEEP##"|##URL##,
,Assign,postURL|"https://ebank.hepsiian.com/cv/searchResults.jsf",

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|ViewState|"results",
,SetPostURLData,"javax.faces.source"|eventName|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"javax.faces.partial.execute"|execute|"results",
,SetPostURLData,"org.richfaces.ajax.component"|eventName|"results",
,SetPostURLData,eventName|eventName|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",
,PostURLr,PDFPAGE||"results"|##URL##, 

,Goto,ScrapeStatement,

//.......................................
Numscore,ParseString,srore|"[x]##KEEP##"|anum,
,Assign,anum|srore,

,FindString,anum|test,
,If-FALSE-Goto,Error960,

Gofortag,MoveToTag,"a"|test,
//,MoveToTag,"a"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,ajaxSrc||"id",

,Assign,commandExec|ajaxSrc,
,AppendVars,commandExec|" @component",

,Assign,PDFPAGE|DomainURL,
,AppendVars,PDFPAGE|"/searchResults.jsf?org.apache.catalina.filters.CSRF_NONCE=",
,AppendVars,PDFPAGE|CSRF_NONCE,

,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##*/*;q=0.8",

,Assign,Referer|DomainURL,
,AppendVars,Referer|"/searchResults.jsf",

,SetHeader,"Referer"|Referer,

,SetPostURLData,"results"|"results"|"results",
,SetPostURLData,"consentResults:0:consent"|"true"|"results",
,SetPostURLData,"javax.faces.ViewState"|viewstate|"results",
,SetPostURLData,"javax.faces.partial.event"|"click"|"results",
,SetPostURLData,"javax.faces.partial.execute"|commandExec|"results",
,SetPostURLData,"javax.faces.partial.render"|"@component"|"results",
,SetPostURLData,"org.richfaces.ajax.component"|ajaxSrc|"results",
,SetPostURLData,"javax.faces.source"|ajaxSrc|"results",
,SetPostURLData,"AJAX:EVENTS_COUNT"|"1"|"results",
,SetPostURLData,"javax.faces.partial.ajax"|"true"|"results",
,SetPostURLData,"javax.faces.behavior.event"|"click"|"results",
,SetPostURLData,"org.apache.catalina.filters.CSRF_NONCE"|CSRF_NONCE|"results",
,SetPostURLData,"startHit"|"1"|"results",
,SetPostURLData,"rfExt"|"null"|"results",

,PostURLr,PDFPAGE||"results"|##URL##,

ScrapeStatement,Assign,SetReturnIndex|0,
,Assign,GetReturnIndex|0,

,Assign,PDFIDX|##STMT_IDX##,
,ConvertStringToInt,PDFIDX,

,FindString," View History -"|test,

LoopingThisoneValue,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,|StatementMonth|,
,GetDataFromTag,GetDummyValue||"onclick",

,ParseString,srkey|"javascript:getHitPDF[(][']##KEEP##[']"|GetDummyValue, //"
,ParseString,HValue|"##COMMA## '##KEEP##[']"|GetDummyValue, //"
,If-FALSE-Goto,ExitSetReturnLoop,

,ConvertToValidDate,StatementMonth|test,
,If-FALSE-Goto,ExitSetReturnLoop,

,Add,SetReturnIndex|1,

,SetReturnData,srkey|srkey|SetReturnIndex,
,SetReturnData,HValue|HValue|SetReturnIndex,
,SetReturnData,StatementMonth|StatementMonth|SetReturnIndex,

,CompareNumbers,PDFIDX|SetReturnIndex|>,    
,If-TRUE-Goto,LoopingThisoneValue,

,Compare,GetReturnIndex|SetReturnIndex,
,If-TRUE-Goto,ExitThisLoopingStatement,
,Add,GetReturnIndex|1,

,Assign,GetReturnIndex|PDFIDX,

,GetReturnData,srkey|srkey|GetReturnIndex,
,GetReturnData,HValue|HValue|GetReturnIndex,
,GetReturnData,StatementMonth|StatementMonth|GetReturnIndex,

ExitThisLoopingStatement,NOP,,
,Assign,cachefix|##NOW##,

,Assign,DXWebURL|DomainURL,
,AppendVars,DXWebURL|"/dxweb.pdf?command=StatementNav&target=window&output=4&srkey=",
,AppendVars,DXWebURL|srkey,
,AppendVars,DXWebURL|"&resolution=100&cachefix=",
,AppendVars,DXWebURL|cachefix,
,AppendVars,DXWebURL|"&hit=",
,AppendVars,DXWebURL|HValue,

,GetURLb,accountStatement|DXWebURL,

,AttachStatement,accountStatement|".pdf"|account,

,Goto,stmtLoop,

//******************************************************************
//         PDF Layout for FI Financial Resources FCU (10771)
//******************************************************************

FR_FCU_PDF,NOP,,



,Assign,PDFIndex|0,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

,Compare,institutionId|"12489",
,If-FALSE-Goto,SkipDynamicURL,

,ParseString,DomainR|".com[/]##KEEP##[/]"|##TOWER_WEBSITE##,

,Assign,newSTMTurl|"https://secure.myvirtualbranch.com/XXXXXXX/eDocuments.aspx",
,FindReplace,"XXXXXXX"|DomainR|newSTMTurl|test,

,GetURL,newSTMTurl|,
,Goto,SkipStaticUrl,

SkipDynamicURL,GetURL,"https://secure.myvirtualbranch.com/FinancialResourcesFCU/eDocuments.aspx"|,

SkipStaticUrl,FindString,anum|test,
,If-FALSE-Goto,Error960,

,FindString,"View eDocuments"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV",
,GetDataFromTag,ViewStmt||"href",  

,GetURL,ViewStmt|,

,MoveToTag,"form",
,GetDataFromTag,formURL||"action",

,MoveToTag,"input",
,GetDataFromTag,Token||"value",

,CreateForm,"TokenLoginForm"|formURL,
,SetPostURLData,"Token"|Token|"TokenLoginForm",

,PostURL,||"TokenLoginForm",


//-------------------------
,FindSignature,"Please enter and submit the PDF Acknowledgement Code to confirm that you have read the Terms and Conditions provided in the above PDF file and hereby consent to receiving eStatements in lieu of paper",
,If-TRUE-Goto,Error961,

,FindSignature,"eStatement Enrollment",
,If-TRUE-Goto,Error961,
//-------------------------

,FindString,"Document Type",

NxtDate,FindString,"Deposit Statement",

,Add,PDFIndex|1,

,MoveToTag,"td"|"REV",
,MoveToTag,"td"|"REV",
,GetDataFromTag,|date1|,
,RemoveHTMLTags,date1,

,FindReplace,"&#47;"|""|date1|test,

,MoveToTag,"input"|"REV",
,GetDataFromTag,statURL||"value",

,FindString,">View<",
,MoveToTag,"td"|"REV",
,GetDataFromTag,SRVK||"onclick",
,ParseString,SRVK|"SRVK=##KEEP##&"|SRVK,

,Compare,STMT_IDX|PDFIndex,
,If-FALSE-Goto,NxtDate,

,Compare,institutionId|"12489",
,If-FALSE-Goto,SkipDynamicpdfURL,

,Assign,PDFURL|"https://gv-us.computershare.com/XXXXXXX/Content/Document.ashx/False/False/True/True/True/1/",
,FindReplace,"XXXXXXX"|DomainR|PDFURL|test,

,Goto,NewpdfurlApnd,

SkipDynamicpdfURL,Assign,PDFURL|"https://gv-us.computershare.com/FinancialResCU/Content/Document.ashx/False/False/True/True/True/1/",
NewpdfurlApnd,AppendVars,PDFURL|statURL,
,AppendVars,PDFURL|"/2/undefined/_/0/_/False/document_",
,AppendVars,PDFURL|date1,
,AppendVars,PDFURL|".pdf?SRVK=",
,AppendVars,PDFURL|SRVK,

,GetURLb,accountStatement|PDFURL,
,AttachStatement,accountStatement|".pdf"|stmtIndex,

,Goto,stmtLoop,

Montecitobanklayout,NOP,
  
,GetReturnData,##TABLE TP_ACCOUNT:ACCOUNT_NUMBER##|number|stmtIndex,

,Right$,tempNo|number|4,
,ConvertStringToInt,##STMT_IDX##,
,Assign,Pdfindex|0,

,FindString,"Select an Account"|test
,If-TRUE-Goto,jump_To_FindString,

,ParseString,srore|"/secure.montecito.bank##KEEP##"|##TOWER_WEBSITE##,
,If-TRUE-Goto,jump_To_Extract,

,Goto,Next_PDFSTMT123,

jump_To_FindString,FindString,tempNo|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"option"|"REV",
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,AccountID||"value",

,ExtractFromRawPage,__VIEWSTATEID|"__VIEWSTATEID["] value=["]##KEEP##["]"|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|"__EVENTVALIDATION["] value=["]##KEEP##["]"|test,//"

,CreateForm,"pdfform"|"/Accounts/eStatements.aspx",
,SetPostURLData,"__EVENTTARGET"|"M$layout$content$PCDZ$MBLEQ3Z$ctl00$ctl00$webInputForm$lstAccounts"|"pdfform",
,SetPostURLData,"__VIEWSTATEID"|__VIEWSTATEID|"pdfform",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"pdfform",
,SetPostURLData,"M$layout$content$PCDZ$MBLEQ3Z$ctl00$ctl00$webInputForm$lstAccounts"|AccountID|"pdfform",
,PostURL,"/Accounts/eStatements.aspx"||"pdfform",

jump_To_Extract,ExtractFromRawPage,VIEWSTATEID|"__VIEWSTATEID["] value[=]["]##KEEP##["]"|test,   //"
,ExtractFromRawPage,EVENTVALIDATION|"__EVENTVALIDATION["]  value[=]["]##KEEP##["]"|test, //"

,ExtractFromRawPage,scriptManager|"_CombinedScripts_[=]##KEEP##["]"|test,       //"
,FindReplace,"%3b"|";"|scriptManager|test,
,FindReplace,"%2c"|"##COMMA##"|scriptManager|test,
,FindReplace,"%3d"|"="|scriptManager|test,
,FindReplace,"%3a"|":"|scriptManager|test,

,FindString,">Statement Date<"|test,
,If-FALSE-Goto,stmtLoop,

Next_PDFSTMT123,NOP,
,MoveToTag,"tr"|test,
,If-FALSE-Goto,stmtLoop,

,MoveToTag,"td"|test,
,GetDataFromTag,|statementDate|,

,MoveToTag,"a"|test,
,GetDataFromTag,STMTURL||"href",
,Add,Pdfindex|1,
,Compare,Pdfindex|##STMT_IDX##,
,If-FALSE-Goto,Next_PDFSTMT123,


,FindReplace,"$"|":"|STMTURL|test,
,ParseString,event|"IDS_LinkButtonClick[(]&#39;##KEEP##&#39;"|STMTURL,
,CreateForm,"aspnetForm"|sURL,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0",
,SetHeader,"Accept"|"text/html##COMMA##application/xhtml+xml##COMMA##application/xml;q=0.9##COMMA##image/webp##COMMA##*/*;q=0.8",
,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",
,SetHeader,"Origin"|"https://secure.montecito.bank",
,SetHeader,"Connection"|"keep-alive",
,SetHeader,"Referer"|"https://secure.montecito.bank/Accounts/eStatements.aspx",

,SetPostURLData,"M_layout_content_ScriptManager_TSM"|scriptManager|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|event|"aspnetForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"aspnetForm",
,SetPostURLData,"__LASTFOCUS"|""|"aspnetForm",
,SetPostURLData,"__VIEWSTATEID"|VIEWSTATEID|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|""|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|EVENTVALIDATION|"aspnetForm",

,PostURLb,newstatementData|||"aspnetForm",

,AttachStatement,newstatementData|".pdf"|Pdfindex,                                   
,DumpToFile,newstatementData|"C:/Images/statement.pdf",                                   
,Goto,stmtLoop,

//*****************************************************************************************************

mygenbanklayout,Assign,stmtIndex|0,

mygenbanklayoutloop,Compare,stmtIndex|account,
,If-TRUE-Goto,logout,

,Add,stmtIndex|1,

,ParseString,anum|"x##KEEP##"|anum,

,FindString,"View Statements"|test,
,If-FALSE-Goto,Error960,

,FindString,"View Statements"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV"|test,
,If-FALSE-Goto,stmtLoop,

,GetDataFromTag,URL1||"href",

,FindReplace,"amp;"|""|URL1|test,

,GetURL,URL1,

,MoveToTag,"frame"|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"frame"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,LoginLibURL||"src",

,GetURLv2,LoginLibURL, 

,ExtractFromRawPage,redirURL|"redirURL [=] [']##KEEP##['][;]"|test,

,Assign,stmtURL|"https://earchive2.ddsservicebureau.com",
,AppendVars,stmtURL|redirURL,

,GetURLv2,stmtURL, 

,FindSignature,"E-Statement Consent and Agreement",
,If-TRUE-Goto,Error961,

,FindString,"Documents"|test,

nextNumLoop,FindString,"Statement"|test,
,If-FALSE-Goto,mygenbanklayoutloop,

,MoveToTag,"td"|test,
,GetDataFromTag,|tempNo|,

,Right$,StmtNum|tempNo|4,

,Compare,anum|StmtNum,
,If-FALSE-Goto,nextNumLoop,


,FindString,anum|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV",
,GetDataFromTag,sURL||"href",
,ParseString,srore1|"[(][']##KEEP##['][)]"|sURL,
,FindReplace,"&amp;"|"&"|srore1|test,

,Assign,AppendIndex|"https://earchive2.ddsservicebureau.com", //"
,AppendVars,AppendIndex|srore1,
,GetURLr,AppendIndex||"https://https://earchive2.ddsservicebureau.com/cowww5/menu/internetuser.asp", 

,Assign,Index|##URL##,  

,ExtractFromRawPage,DoctitleID|"DoctitleID[=]##KEEP##[&]"|test,

,Assign,StmtURL1|"https://earchive2.ddsservicebureau.com/cowww5/viewers/doclist_titlejs.asp?DoctitleID=",
,AppendVars,StmtURL1|DoctitleID,
,AppendVars,StmtURL1|"&TitleSearch=&AppID=",

,ExtractFromRawPage,AppID|"AppID[=]##KEEP##["]"|test, //"
,AppendVars,StmtURL1|AppID,                                     

,GetURLv2,StmtURL1, 

,Assign,PIndex1|0,

nextStmtLoop,GetDataAfterString,PrimaryKey|"hitList.add[(]"|""|test,  
,If-FALSE-Goto,mygenbanklayoutloop, 

,Add,PIndex1|1,

,Compare,PIndex1|STMT_IDX,
,If-FALSE-Goto,nextStmtLoop,  

,Assign,StmtURL2|"https://earchive2.ddsservicebureau.com/cowww5/viewers/ViewDoc.asp?AppID=",
,AppendVars,StmtURL2|AppID,
,AppendVars,StmtURL2|"&PrimaryKey=",                                   
,AppendVars,StmtURL2|PrimaryKey,

,GetURLv2,StmtURL2, 

,Assign,StmtURL3|"https://earchive2.ddsservicebureau.com/cowww5/viewers/viewerlist.asp?AppID=",
,AppendVars,StmtURL3|AppID,
,AppendVars,StmtURL3|"&PrimaryKey=",
,AppendVars,StmtURL3|PrimaryKey,
,AppendVars,StmtURL3|"&ViewerID=",

,ExtractFromRawPage,ViewerID|"ViewerID[=]##KEEP##[&]"|test,
,AppendVars,StmtURL3|ViewerID,
,AppendVars,StmtURL3|"&NewWindow=",

,GetURLv2,StmtURL3, 

,FindString,"function initTabs()"|test,

,FindString,"new viewerTab"|test,

,Assign,PCount|0,

,GetDataAfterString,AppViewerIDValue|""|"[+][(]##COMMA##[/][.][']",

PCountLoop,ParseString,AppViewerIDValue|"[##COMMA##]##KEEP##"|AppViewerIDValue,
,Add,PCount|1,

,Compare,PCount|13,
,If-TRUE-Goto,ExitPCount,

,Goto,PCountLoop,

ExitPCount,Assign,AppViewerID|AppViewerIDValue,
,ParseString,AppViewerID|"##KEEP##[##COMMA##]"|AppViewerID

,Assign,PDFURL|"https://earchive2.ddsservicebureau.com/cowww/DocumentServer/ViewDoc?AppID=",                                        
,AppendVars,PDFURL|AppID,
,AppendVars,PDFURL|"&PrimaryKey=",
,AppendVars,PDFURL|PrimaryKey, 
,AppendVars,PDFURL|"&AppViewerID=",
,AppendVars,PDFURL|AppViewerID,
,AppendVars,PDFURL|"&DocumentID=",
,AppendVars,PDFURL|PrimaryKey,

,GetURLv2,PDFURL|,

,AttachStatement,##VPAGE##|".pdf"|stmtIndex,

,Goto,mygenbanklayoutloop,


//***********************************Northwestbank Statement Layout*****************************

northwestbankstmtLayout,Assign,stamtIndex|0,

northwestbankstmtLoop,Compare,stamtIndex|account,
,If-TRUE-Goto,logout,

,Add,stamtIndex|1,

,Assign,PIndex|0,

,ExtractFromRawPage,store|"[/]iStatements1##KEEP##["]"|test,  //"

,Assign,northwestbankonlineStmntURL|"https://estatementsplus.nwbcorp.com/iStatements1",
,AppendVars,northwestbankonlineStmntURL|store,

,GetURLv2,northwestbankonlineStmntURL|,

,FindString,"PageRequestManager"|test,
,If-FALSE-Goto,logout,

,MoveToTag,"input",
,GetDataFromTag,disclosureURL||"value",

,GetURL,disclosureURL|,

,FindSignature,"Please review and accept the Online Statement Disclosure below",
,If-TRUE-Goto,Error961,

,ParseString,tempnum1|"x##KEEP##"|anum,

,FindString,aname|test,

,FindString,tempnum1|test,
,If-FALSE-Goto,Error960,

,MoveToTag,"a"|"REV",
,GetDataFromTag,formType||"href",

,ParseString,srore|"javascript:__doPostBack[(][']##KEEP##[']"|formType,
,If-FALSE-Goto,Error960,
,MoveToTopOfPage,,

,MoveToTag,"form",

,Assign,ctl00$ScriptManager1|"ctl00$mainPage$pnlUserDetails##PIPE##",
,AppendVars,ctl00$ScriptManager1|srore,

,ExtractFromRawPage,__VIEWSTATE|""__VIEWSTATE" value="##KEEP##""|test,//"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|""__VIEWSTATEGENERATOR" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|""__EVENTVALIDATION" value="##KEEP##""|test,//"

,SetHeader,"Content-Type"|"application/x-www-form-urlencoded",

,SetPostURLData,"ctl00$ScriptManager1"|ctl00$ScriptManager1|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|srore|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE|"aspnetForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",
,SetPostURLData,"co1ShowId"|"ctl00_mainPage_fvUserDetails_co1Show"|"aspnetForm",
,SetPostURLData,"__ASYNCPOST"|"true"|"aspnetForm",
,PostURL,||"aspnetForm",

,FindReplace,"%2f"|"/"|##VPAGE##|test,
,ReloadVPage,,

,ExtractFromRawPage,store|"[/]iStatements1##KEEP##[##PIPE##]"|test,

,Assign,northwestbankonlineStmntURL1|"https://estatementsplus.nwbcorp.com/iStatements1",
,AppendVars,northwestbankonlineStmntURL1|store,

,GetURLr,northwestbankonlineStmntURL1||##URL##,


,FindString,"For the period ending:"|test,
,If-FALSE-Goto,northwestbankstmtLoop,

NextPDFstmn,MoveToTag,"option"|test,
,GetDataFromTag,PDFDate||"value",

,Add,PIndex|1,

,Compare,STMT_IDX|PIndex,
,If-FALSE-Goto,NextPDFstmn,

,ExtractFromRawPage,__VIEWSTATE|""__VIEWSTATE" value="##KEEP##""|test,//"
,ExtractFromRawPage,__VIEWSTATEGENERATOR|""__VIEWSTATEGENERATOR" value="##KEEP##""|test,//"
,ExtractFromRawPage,__EVENTVALIDATION|""__EVENTVALIDATION" value="##KEEP##""|test,//"
,ExtractFromRawPage,lastURL|"action[=]["][.]##KEEP##["]"|test,//"

,ParseString,HalfUrl|"##KEEP##/CustomerSummary"|disclosureURL,

,Assign,FullURL|"https://estatementsplus.nwbcorp.com",
,AppendVars,FullURL|HalfUrl,

,AppendVars,FullURL|lastURL,

,Assign,ManagerData|"ctl00$mainPage$UpdatePanel1##PIPE##",
,AppendVars,ManagerData|"ctl00$mainPage$ddDates",

,SetPostURLData,"ctl00$ScriptManager1"|ManagerData|"aspnetForm",
,SetPostURLData,"__EVENTTARGET"|"ctl00$mainPage$ddDates"|"aspnetForm",
,SetPostURLData,"__EVENTARGUMENT"|""|"aspnetForm",
,SetPostURLData,"__LASTFOCUS"|""|"aspnetForm",
,SetPostURLData,"__VIEWSTATE"|__VIEWSTATE|"aspnetForm",
,SetPostURLData,"__VIEWSTATEGENERATOR"|__VIEWSTATEGENERATOR|"aspnetForm",
,SetPostURLData,"__EVENTVALIDATION"|__EVENTVALIDATION|"aspnetForm",
,SetPostURLData,"ctl00$mainPage$ddDates"|PDFDate|"aspnetForm",
//,SetPostURLData,"__ASYNCPOST"|"true"|"aspnetForm",

,PostURL,FullURL||"aspnetForm",

,FindString,">Download"|test,
,If-FALSE-Goto,northwestbankstmtLoop,

,MoveToTag,"a"|"REV",
,GetDataFromTag,PDFHURL||"href",

,ParseString,Tval|"&t##KEEP##"|PDFHURL,
,If-TRUE-Goto,skipBelowTval,

,ParseString,Tval|"t=##KEEP##"|PDFHURL,

skipBelowTval,ParseString,PDFHalfURL|"##KEEP##/Portal"|FullURL,

,Assign,PDFFURL|PDFHalfURL,
,AppendVars,PDFFURL|"/Actions/StatementDownload.aspx?t=",
,AppendVars,PDFFURL|Tval,

,GetURLb,accountStatement|PDFFURL,
,AttachStatement,accountStatement|".pdf"|stamtIndex,
,DumpToFile,accountStatement|"C:/Images/statement.pdf",
,Goto,northwestbankstmtLoop,


//***************************NorthWest Bank Creditcard Aggregation layout*****************************

NorthwestCreditCardLayout,NOP,,

,Assign,trans|0,

,GetURLv2,"https://onlinebanking.firstdata.com/ecs/northwest-bank"|,

,SetHeader,"appId"|"northwest-bank",

,GetURLv2,"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/accounts/v1/accountsummary"|,

,Compare,##REQUEST##|"STATEMENT_DOWNLOAD",
,If-TRUE-Goto,NewNorthwestcardlayout,

,Assign,jsonObject|"{"pageNumber":1##COMMA##"readCount":1000}",
,Assign,TransURL|"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/transactions/v1/postedtransactions",

//,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",
//,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
//,SetHeader,"Referer"|"https://onlinebanking.firstdata.com/ecs/northwest-bank/account/transaction-history",
,SetHeader,"Content-Type"|"application/json;charset=utf-8",
,SetHeader,"appId"|"northwest-bank",


,JSON-PostData,TransURL|jsonObject,


///////////////////////////Recent transaction Start///////////////////////////////////////////////


,FindSignature,"RECORD NOT FOUND",
,If-TRUE-Goto,skipCurrentTransaction,

,FindSignature,"responseCode":"success",
,If-FALSE-Goto,Error417,

NxtRecentTransaction,GetDataAfterString,transAmount|""transactionAmount":"|"-$."|test,
,If-FALSE-Goto,skipCurrentTransaction,

,ConvertToValidDollar,transAmount|test,
,If-FALSE-Goto,NxtRecentTransaction,

,Compare,transAmount|"0.0",
,If-TRUE-Goto,NxtRecentTransaction,

,GetDataAfterString,transDesc|""description":""|"/- # &*. '"|test,  //"
,If-FALSE-Goto,NxtRecentTransaction,

,RemoveExtraWhitespaces,transDesc,

,GetDataAfterString,transDate|""postDate":""|".- "|test,  //"
,If-FALSE-Goto,NxtRecentTransaction,

,ConvertToValidDate,transDate|test,
,If-FALSE-Goto,NxtRecentTransaction,

,CompareDates,transDate|##ENDDATE##|>,
,If-TRUE-Goto,NxtRecentTransaction,
,CompareDates,transDate|##STARTDATE##|<,
,If-TRUE-Goto,NxtRecentTransaction,

,AppendVars,transAmount|"-",

skip_recent_append,ConvertToValidDollar,transAmount|test,
,If-FALSE-Goto,NxtRecentTransaction,

,Add,trans|1,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|transDate|HISINDEX|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|transDesc|HISINDEX|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|transAmount|HISINDEX|trans,

,Goto,NxtRecentTransaction,

///////////////////////////Recent transaction End///////////////////////////////////////////////


skipCurrentTransaction,NOP,,

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"Referer"|"https://onlinebanking.firstdata.com/ecs/northwest-bank/account/transaction-history",
,SetHeader,"appId"|"northwest-bank",

,GetURLv2,"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/statements/v1/statementcycles"|,

,Assign,Stmtdatecount|0,

stmtCycleLoop,FindString,""statementDate""|test,
,If-FALSE-Goto,gotoScrapeTransactions,

,GetDataAfterString,statementDate|":""|" -"|test, //"

,Add,Stmtdatecount|1,

,SetReturnData,statementDate|statementDate|Stmtdatecount,

,Goto,stmtCycleLoop,

gotoScrapeTransactions,Assign,stmtcyclecount|0,

NextCycleLoop,Compare,stmtcyclecount|Stmtdatecount,
,If-TRUE-Goto,HISTRYACCNT,

,Add,stmtcyclecount|1,

,GetReturnData,statementDate|statementDate|stmtcyclecount,
,Assign,jsonObject|"{"pageNumber":1##COMMA##"readCount":1000##COMMA##"statementDate":"XXXXXX"}",
,FindReplace,"XXXXXX"|statementDate|jsonObject|test,


,Assign,TransURL|"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/transactions/v1/postedtransactions",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"Referer"|"https://onlinebanking.firstdata.com/ecs/northwest-bank/account/transaction-history",
,SetHeader,"Content-Type"|"application/json;charset=utf-8",
,SetHeader,"appId"|"northwest-bank",

,JSON-PostData,TransURL|jsonObject,

NxtTransaction,GetDataAfterString,transAmount|""transactionAmount":"|"-$."|test,
,If-FALSE-Goto,NextCycleLoop,

,ConvertToValidDollar,transAmount|test,
,If-FALSE-Goto,NxtTransaction,

,Compare,transAmount|"0.0",
,If-TRUE-Goto,NxtTransaction,

,GetDataAfterString,transDesc|""description":""|"/- # &*. '"|test,  //"
,If-FALSE-Goto,NxtTransaction,

,RemoveExtraWhitespaces,transDesc,

,GetDataAfterString,transDate|""postDate":""|".- "|test,  //"
,If-FALSE-Goto,NxtTransaction,

,ConvertToValidDate,transDate|test,
,If-FALSE-Goto,NxtTransaction,

,CompareDates,transDate|##ENDDATE##|>,
,If-TRUE-Goto,NxtTransaction,
,CompareDates,transDate|##STARTDATE##|<,
,If-TRUE-Goto,NxtTransaction,

,AppendVars,transAmount|"-",

skip_append,ConvertToValidDollar,transAmount|test,
,If-FALSE-Goto,NxtTransaction,

,Add,trans|1,

,SetReturnData,##TABLE TP_ACCOUNT_TXN:TRANSACTION_DATE##|transDate|HISINDEX|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:DESCRIPTION##|transDesc|HISINDEX|trans,
,SetReturnData,##TABLE TP_ACCOUNT_TXN:VALUE_AMOUNT##|transAmount|HISINDEX|trans,

,Goto,NxtTransaction,


//******************Error 417*********************************

Error417,Compare,partnerId|"3802",
,If-TRUE-Goto,HISTRYACCNT,

////////////////////////////////////////////

,Assign,Temp_Date|##STARTDATE##,
,AppendVars,Temp_Date|"&",
,AppendVars,Temp_Date|##ENDDATE##,
,AppendVars,Temp_Date|" & ",

,Assign,NoTrxnLog|"NO Transactions",
,AppendVars,NoTrxnLog|##REQUEST##,
,AppendVars,NoTrxnLog|" from date:- ",
,AppendVars,NoTrxnLog|Temp_Date,
,AppendVars,NoTrxnLog|" of FIID ",
,AppendVars,NoTrxnLog|institutionId,
,AppendVars,NoTrxnLog|" of Customer ID ",
,AppendVars,NoTrxnLog|customerId,
,Log,ALERT|NoTrxnLog|,

,SetReturnData,##TABLE TP_ACCOUNT:CUSTOM_ERROR##|417|HISINDEX|,

,Goto,HISTRYACCNT,


//**************************************************************************************************

//***************************NorthWest Bank Creditcard Statement layout*****************************

NewNorthwestcardlayout,Assign,PDFINDEX|0,
,Assign,NBcardlayout|0,

,MoveToTopOfPage,,

,Assign,STMT_IDX|##STMT_IDX##,
,ConvertStringToInt,STMT_IDX,

NextAcctPDF,Compare,NBcardlayout|account,
,If-TRUE-Goto,logout,

,Add,NBcardlayout|1,

,GetDataAfterString,principalIdentifier|"principalIdentifier":""|"",
,GetDataAfterString,systemIdentifier|"systemIdentifier":""|"",

,Assign,accountclass|systemIdentifier,
,AppendVars,accountclass|principalIdentifier,


,Assign,jsonObject|"{"accountClass":"XXXXXX"}",
,FindReplace,"XXXXXX"|accountclass|jsonObject|test,


,Assign,StmtURL|"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/statements/v2/statementdates",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"Referer"|"https://onlinebanking.firstdata.com/ecs/northwest-bank/statements",
,SetHeader,"Content-Type"|"application/json;charset=utf-8",
,SetHeader,"appId"|"northwest-bank",

,JSON-PostData,StmtURL|jsonObject,

,FindSignature,"statements",
,If-FALSE-Goto,Error960,

NextStmtLoop,GetDataAfterString,statementDate|"statementDate":""|""|test,
,If-FALSE-Goto,Error960,

,GetDataAfterString,documentId|"documentId":""|"()/",

,Add,PDFINDEX|1,

,Compare,PDFINDEX|STMT_IDX,
,If-FALSE-Goto,NextStmtLoop,

,Assign,jsonObject|"{"accountClass":"XXXXXX"##COMMA##"statementMonth":"YYYYYY"##COMMA##"documentId":"ZZZZZZ"}",
,FindReplace,"XXXXXX"|accountclass|jsonObject|test,
,FindReplace,"YYYYYY"|statementDate|jsonObject|test,
,FindReplace,"ZZZZZZ"|documentId|jsonObject|test,

,Assign,StmtDownloadURL|"https://onlinebanking.firstdata.com/ecs/northwest-bank/services/api/statements/v2/pdfstatement",

,SetHeader,"User-Agent"|"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0",
,SetHeader,"Accept"|"application/json##COMMA## text/plain##COMMA## */*",
,SetHeader,"Referer"|"https://onlinebanking.firstdata.com/ecs/northwest-bank/statements",
,SetHeader,"Content-Type"|"application/json;charset=utf-8",
,SetHeader,"appId"|"northwest-bank",

,JSON-PostData,StmtDownloadURL|jsonObject,

,ExtractFromRawPage,accountStatement|"pdfStatements":"##KEEP##""|test,  //"
,Base64Decoder,accountStatement|accountStatement,
,AttachStatement,accountStatement|".pdf"|NBcardlayout,
,DumpToFile,accountStatement|"C:\Images\statement.pdf",   //

,Goto,NextAcctPDF,

/////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////

coastPDFLayout,Assign,PDFINDEX|0,
,Assign,stmtIndex|0,

,Assign,stmtIdx|##STMT_IDX##,
,ConvertStringToInt,stmtIdx,
  
mercedloop,Compare,stmtIndex|account,
,If-TRUE-Goto,logout,
  
,Add,stmtIndex|1,

,Assign,domain|"https://estmt.businessdatainc.com/Coast360",

,GetURL,"https://coast360fcu.onlinebank.com/eStatements.aspx"|,
,GetURL,"https://coast360fcu.onlinebank.com/BDIEstatement.aspx"|,

Label_InitialFrame,Assign,CookieValidation|domain,
,AppendVars,CookieValidation|"/CookieValidation.jsp",
,GetURL,CookieValidation|,

,Assign,InitialFrame|domain,
,AppendVars,InitialFrame|"/secure/InitialFrame.jsp",
,GetURL,InitialFrame|,

,Assign,InitialFrame_Top|domain,
,AppendVars,InitialFrame_Top|"/secure/custom/InitialFrame_Top.jsp",
,GetURL,InitialFrame_Top|,

,Assign,DisclosureDisplay|domain,
,AppendVars,DisclosureDisplay|"/DisclosureDisplay.do",
,GetURL,DisclosureDisplay|,

,FindSignature,"You can switch from paper to electronic delivery",
,If-TRUE-Goto,Error961,

,Assign,Mainnxtpgurl1|domain,
,AppendVars,Mainnxtpgurl1|"/secure/custom/MainFrame.jsp",
,GetURL,Mainnxtpgurl1|,

,Assign,Mainnxtpgurl2|domain,
,AppendVars,Mainnxtpgurl2|"/secure/custom/MainFrameTop.jsp",
,GetURL,Mainnxtpgurl2|,

,Assign,Mainnxtpgurl3|domain,
,AppendVars,Mainnxtpgurl3|"/DocumentPageSetup.do",
,GetURL,Mainnxtpgurl3|,

,FindString,"Statement as"|test,
,If-TRUE-Goto,prevStmt,

,FindString,"Monthly Statement"|test,
,If-FALSE-Goto,Error960,
prevStmt,MoveToTag,"a"|test,
,If-FALSE-Goto,Error960,

,GetDataFromTag,pdfURL||"href",

,Add,PDFINDEX|1,
  
,Compare,PDFINDEX|stmtIdx,
,If-FALSE-Goto,prevStmt,
  

,Assign,MainPDF|"https://estmt.businessdatainc.com/",
,AppendVars,MainPDF|pdfURL,
,FindReplace,"&amp;"|"&"|MainPDF|test,

,GetURL,MainPDF|,

,FindSignature,"%PDF-",
,If-FALSE-Goto,findnxtstring,
,Assign,PDFlink|##URL##,
,GetURLb,accountStatement|PDFlink,
,Goto,goforattach

findnxtstring,FindString,"SaveAnchor"|test,
,If-FALSE-Goto,mercedloop,

,MoveToTag,"a"|"REV",
,If-FALSE-Goto,mercedloop,

,GetDataFromTag,pdfdwnldref||"href",
,Assign,pdfdwnld|"https://estmt.businessdatainc.com",
,AppendVars,pdfdwnld|pdfdwnldref,
,GetURL,pdfdwnld|,

,GetURLb,accountStatement|pdfdwnld||,
goforattach,AttachStatement,accountStatement|".pdf"|stmtIndex,
//,DumpToFile,accountStatement|"C:/Images/stmt.pdf",
,Goto,mercedloop,